{"version":3,"sources":["webpack://wsGui/webpack/universalModuleDefinition","webpack://wsGui/webpack/bootstrap","webpack://wsGui/./src/assets/1.jpg","webpack://wsGui/./node_modules/tslib/tslib.es6.js","webpack://wsGui/./src/tool/util.ts","webpack://wsGui/./src/core/dom.ts","webpack://wsGui/./src/layer.ts","webpack://wsGui/./src/engine.ts","webpack://wsGui/./src/lib/matrix.ts","webpack://wsGui/./src/lib/transform.ts","webpack://wsGui/./src/core/bounding_rect.ts","webpack://wsGui/./src/core/resource.ts","webpack://wsGui/./src/tool/color.ts","webpack://wsGui/./src/core/style.ts","webpack://wsGui/./src/core/event.ts","webpack://wsGui/./src/tool/paint.ts","webpack://wsGui/./src/node/element.ts","webpack://wsGui/./src/node/container.ts","webpack://wsGui/./src/node/image.ts","webpack://wsGui/./src/core/text.ts","webpack://wsGui/./src/node/text.ts","webpack://wsGui/./src/animation/easing.ts","webpack://wsGui/./src/animation/animation.ts","webpack://wsGui/./src/node/stack.ts","webpack://wsGui/./src/node/scroll.ts","webpack://wsGui/./src/index.ts"],"names":["root","factory","exports","module","define","amd","wsGui","window","i","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","e","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__assign","assign","arguments","length","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","throw","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","return","iterator","v","op","TypeError","pop","push","__values","__read","ar","error","cached","fn","maxSize","cache","Map","arg","_i","join","has","size","delete","keys","set","imgReg","isImg","str","test","makeCheckExist","ignore","split","map","toLowerCase","k","includes","findIndexByBinary","compare","len","low","high","mid","res","Math","floor","ids","num","line2hump","replace","w","toUpperCase","createId","line","Set","id","Date","now","toString","padStart","add","dom_id","getContext","document","createElement","parseSize","base","endsWith","parseFloat","devicePixelRatio","addHandler","element","type","handler","addEventListener","attachEvent","removeHandler","removeEventListener","detachEvent","layer_Layer","Layer","width","height","z","dirty","roots","_time","canvas","h","style","position","left","top","setAttribute","createCanvas","ctx","el","_this","parent","layer","remove","needUpdate","index","zIndex","splice","dispose","findIndex","dom","forEach","removeChild","beforeRender","render","clearRect","_render","afterRender","getTarget","x","traget","resize","wdith","node","draw","_a","engine_Engine","Engine","_root","_layers","_isOut","-webkit-tap-highlight-color","-webkit-user-select","user-select","-webkit-touch-callout","innerHTML","_initEvent","getLayer","_timer","requestAnimationFrame","addLayer","console","warn","offsetWidth","offsetHeight","_addLayerToDom","replaceLayer","old","removeLayer","curLayer","cancelAnimationFrame","_preTarget","_b","from","values","_c","insertBefore","appendChild","event","offsetX","offsetY","getBoundingClientRect","rect","clientX","clientY","touches","target","_getTarget","guiEvent","cancelBubble","_moveHandler","notifyEvent","relatedTarget","layers","sort","a","layers_1","layers_1_1","matrix_Matrix","_super","Matrix","toUnit","toArray","transform","isRight","thisArr","right","invert","det","Number","EPSILON","Transform","copy","source","rotate","rotation","cos","sin","scale","sx","sy","isArray","translate","BoundingRect","extend","other","min","max","minX","minY","maxX","maxY","mArr","MAX_VALUE","contain","intersect","ax0","ax1","ay0","ay1","clone","DEFAULT_SRC","getImg","path","isFirst","data","count","image","img","Image","src","onload","onerror","disposeImg","kCSSColorTable","transparent","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","clampCssByte","round","clampCssFloat","parseCssInt","charAt","parseInt","parseCssFloat","cssHueToRgb","m1","m2","hsla2rgba","hsla","rgba","err","parseColor","colorStr","iv","Reflect","startsWith","substr","indexOf","ep","fname","params","alpha","stringify","arrColor","isTransformKey","style_Style","Style","color","border","borderColor","borderStyle","opacity","clip","origin","_res","attr","entries","build","setLineDash","strokeStyle","lineWidth","background","loadImg","createPattern","setTransform","fillStyle","setAlpha","globalAlpha","clear","equal","every","isModifyTransform","fill","EventFul","_handlers","on","off","handlers","notify","context","ellipse","cx","cy","rx","ry","startAngle","endAngle","anticlockwise","abs","pow","save","scaleX","scaleY","arc","restore","buildPath","borderRadius","radius","beginPath","moveTo","PI","lineTo","closePath","element_Canvas2DElement","Canvas2DElement","isStatic","checkedPoint","isVisible","_needUpdate","_parentWidth","_parentHeight","_ignore","_dirty","_animation","animation","addElement","_cached","beforeUpdate","getBoundingRect","afterUpdate","_isPaint","buildCached","_cachedTransform","drawImage","afterBuild","isEqual","_d","_e","markDirty","update","skip","_getBaseSize","calcSize","updateTransform","beforeBuild","stroke","bottom","parent_1","cachedCtx","_contain","getParentSize","pk","clipParent","getParent","isPointInPath","rootWidth","rootHeight","filter","container_Container","Container","children","configurable","_renderChildren","setChildrenProps","_getMaxRect","maxRect","image_Canvas2DImage","Canvas2DImage","_cellId","_setCell","modyfySrc","sw","_cellWidth","sh","_cellHeight","cw","val","deleteProperty","getWidth","text","font","reduce","measureText","isFontStyle","canModifyTextMap","text_TextBlock","TextBlock","textMap","_textAlign","_verticalAlign","_strokeColor","_strokeWidth","_lineHeight","_letterSpacing","_textWarp","_indent","_font","_modifyText","_setFont","last","textBaseline","_adjustX","_adjustY","strokeText","char","fillText","setTextStyle","_setTextStyle","_parseText","lineHeight","Infinity","ellipsisWidth","lines","options","maxWidth","lines_1","lines_1_1","_setTextMap","textWidth","textData","_addEllipsis","more","easing","linear","quadraticIn","quadraticOut","quadraticInOut","cubicIn","cubicOut","cubicInOut","quarticIn","quarticOut","quarticInOut","quinticIn","quinticOut","quinticInOut","sinusoidalIn","sinusoidalOut","sinusoidalInOut","exponentialIn","exponentialOut","exponentialInOut","circularIn","sqrt","circularOut","circularInOut","elasticIn","asin","elasticOut","elasticInOut","backIn","backOut","backInOut","bounceIn","bounceOut","bounceInOut","animationKey","animation_Canvas2DAnimation","Canvas2DAnimation","time","delay","_endCall","_startTime","_pauseTime","_prevTime","_isStart","_isPause","cellId","errKey","addFrame","frame","reWrite","_parseFrame","thisAttr","addEndCall","removeEndCall","start","stop","_play","pause","_end","progress","_getAttr","zeroFrame","frames","prev_1","type1","type2","rate_1","reg_1","prevValue","RegExp","_warnOnce","stack_Stack","Stack","_isVertical","isVertical","sizeKey","otherSizeKey","positionKey","oldSize","_calcSize","positionOtherKey","scroll_Scroll","Scroll","move","_isDown","_downPoint","_maxMove","_upCall","_downCall","_moveCall","preventDefault","returnValue","diff","__webpack_exports__"],"mappings":"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","file":"ws-gui.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"wsGui\"] = factory();\n\telse\n\t\troot[\"wsGui\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = __webpack_public_path__ + \"assets/c820cfde.1.jpg\";","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { join } from \"path\";\r\n\r\n/// <reference lib=\"es2017.object\" />\r\n\r\n/**\r\n * 创建一个纯函数的缓存版本\r\n */\r\nexport function cached<T>(fn: (...arg: any[]) => T, maxSize?: number): (...arg: any[]) => T {\r\n    const cache:Map<any, any> = new Map();\r\n\r\n    return (...arg: any[]) => {\r\n        const key = arg.join(':');\r\n\r\n        if(!cache.has(key)) {\r\n            if(maxSize && cache.size >= maxSize) {\r\n                cache.delete(cache.keys().next().value);\r\n            }\r\n            cache.set(key, fn.apply(null, arg));\r\n        }\r\n\r\n        return cache.get(key);\r\n    }\r\n}\r\n\r\n/**\r\n * 深复制对象\r\n */\r\nexport function clone(obj: any){\r\n    if(typeof obj === 'object' && obj !== null){\r\n        let res: any;\r\n\r\n        if(obj instanceof Map){\r\n            res = new Map();\r\n            obj.forEach((v, k) => res.set(k, clone(v)));\r\n        } else if(obj instanceof Set) {\r\n            res = new Set();\r\n            obj.forEach(v => res.add(clone(v)));\r\n        } else if(Array.isArray(obj)){\r\n            res = obj.map(clone);\r\n        } else {\r\n            res = {};\r\n            for(let [k, v] of Object.entries(obj)){\r\n                res[k] = clone(v);\r\n            }\r\n        }\r\n\r\n        return res;\r\n    } else {\r\n        return obj;\r\n    }\r\n}\r\n\r\nconst imgReg = /\\.(jpg|png|gif|jpeg)$/i;\r\nexport function isImg(str: any){\r\n    if(typeof str === 'string'){\r\n        return imgReg.test(str);\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * 创建一个检测一个字符串是否在一系列字符串内的函数+\r\n * @param str 用于检测的系列字符串组成的字符串，以空格分隔\r\n * @param ignore 是否忽略大小写\r\n */\r\nexport function makeCheckExist(str: string, ignore?: boolean){\r\n    let keys = str.split(' ');\r\n    if(ignore){\r\n        keys = keys.map(v => v.toLowerCase());\r\n    }\r\n\r\n    return function(k: string){\r\n        if(ignore) {\r\n            k = k.toLowerCase();\r\n        }\r\n\r\n        return keys.includes(k);\r\n    }\r\n}\r\n\r\n/**\r\n * 判断一个数值是否是0, 误差为Number.EPSILON\r\n */\r\nexport function isZero(val: number) {\r\n    return val > -Number.EPSILON && val < Number.EPSILON;\r\n}\r\n\r\n/**\r\n * 获取闭区间[min, max]内的随机整数, 四舍五入\r\n * 若max < min则闭区间为[max, min]\r\n */\r\nexport function randomInt(min: number, max: number){\r\n    if(max === min) return Math.round(max);\r\n\r\n    if(max < min) {\r\n        [min, max] = [max, min];\r\n    }\r\n\r\n    return Math.round(Math.random() * (max - min) + min);\r\n}\r\n\r\n/**\r\n * 二分法查找插入位置\r\n * @param compare 比较函数, 返回值<=0时, 插入位置<=mid, 反之>mid\r\n * @param len 数组长度\r\n */\r\nexport function findIndexByBinary(compare: (mid: number) => number, len: number) {\r\n    let low = 0, high = len - 1, mid = 0;\r\n    while(low <= high){\r\n        mid = Math.floor((high + low) / 2);\r\n        const res = compare(mid);\r\n        if(res < 0){\r\n            high = mid - 1;\r\n        } else if(res > 0){\r\n            low = mid + 1;\r\n        } else {\r\n            return mid;\r\n        }\r\n    }\r\n\r\n    return low;\r\n}\r\n\r\n/**\r\n * 下/中划线转驼峰\r\n */\r\nexport const line2hump = cached((str: string) => {\r\n    return str.replace(/[-_]+(\\w)/g, (_, w: string) => w.toUpperCase());\r\n})\r\n\r\n/**\r\n * 驼峰转下/中划线\r\n */\r\nexport const hump2line = cached((str: string, line: string = '-') => {\r\n    return str.replace(/[A-Z]/g, (w: string) => line + w.toLowerCase());\r\n})\r\n\r\nexport const createId = (() => {\r\n    const ids: Set<string | number> = new Set();\r\n    let num: number = 0;\r\n\r\n    return function(id: string | number) {\r\n        if(ids.has(id)) {\r\n            id = `${Date.now().toString(16)}${num.toString(16).padStart(6, '0')}`\r\n            num++;\r\n        }\r\n        ids.add(id);\r\n\r\n        return id;\r\n    }\r\n})()","import { cached } from \"../tool/util\";\r\n\r\n/**\r\n * dom操作\r\n */\r\n\r\nlet id: number = 0;\r\nfunction createId(){\r\n    return id++;\r\n}\r\n\r\n/**\r\n * 创建canvas\r\n * @param w\r\n * @param h\r\n */\r\nexport function createCanvas(w: number, h: number, id?: string){\r\n    const canvas = document.createElement('canvas');\r\n    Object.assign(canvas.style, {\r\n        position: 'absolute',\r\n        left: 0,\r\n        top: 0,\r\n        width: `${w}px`,\r\n        height: `${h}px`\r\n    })\r\n\r\n    canvas.setAttribute('data-dom-id', id || `canvas-${createId()}`);\r\n    canvas.width = w * devicePixelRatio;\r\n    canvas.height = h * devicePixelRatio;\r\n\r\n    return canvas;\r\n}\r\n\r\nexport const getContext = cached(() => {\r\n    return document.createElement('canvas').getContext('2d');\r\n})\r\n\r\n/**\r\n * 解析css尺寸\r\n * @param size 尺寸设置\r\n * @param base 百分比相对值\r\n */\r\nexport function parseSize(size: number | string, base: number): number {\r\n    if(typeof size === 'string'){\r\n        if(size.endsWith('%')){\r\n            return base * (parseFloat(size) || 0) / 100;\r\n        } else {\r\n            return (parseFloat(size) || 0) * devicePixelRatio;\r\n        }\r\n    }\r\n\r\n    return (size || 0) * devicePixelRatio;\r\n}\r\n\r\n/**\r\n * 获取鼠标相对于canvas的位置\r\n */\r\nexport function getPosition(el: HTMLElement, e: any) {\r\n    if(e.offsetX != null && e.offsetY != null) {\r\n        return {x: e.offsetX, y: e.offsetY};\r\n    }\r\n\r\n    if(el.getBoundingClientRect) {\r\n        const rect = el.getBoundingClientRect();\r\n        let clientX = e.clientX, clientY = e.clientY;\r\n        if(e.touches) {\r\n            if(!e.touches.length) {\r\n                return {x: 0, y: 0};\r\n            }\r\n            clientX = e.touches[0].clientX;\r\n            clientY = e.touches[0].clientY;\r\n        }\r\n\r\n        return {\r\n            x: clientX - rect.left,\r\n            y: clientY - rect.top\r\n        };\r\n    }\r\n\r\n    return {x: 0, y: 0};\r\n}\r\n\r\nexport function addHandler(element: any, type: string, handler: Function) {\r\n    if(element.addEventListener){\r\n        element.addEventListener(type, handler, false);\r\n    }else if(element.attachEvent){\r\n        element.attachEvent('on' + type, handler);\r\n    }else{\r\n        element['on' + type] = handler;\r\n    }\r\n}\r\n\r\nexport function removeHandler(element: any, type: string, handler: Function){\r\n    if(element.removeEventListener){\r\n        element.removeEventListener(type, handler, false);\r\n    }else if(element.detachEvent){\r\n        element.detachEvent('on' + type, handler);\r\n    }else{\r\n        element['on' + type] = null;\r\n    }\r\n}","/**\r\n * canvas层\r\n */\r\nimport { Canvas2DElement } from \"./node/element\";\r\nimport { createCanvas } from \"./core/dom\";\r\nimport { findIndexByBinary } from \"./tool/util\";\r\n\r\nexport class Layer {\r\n    canvas?: HTMLCanvasElement;\r\n    dirty: boolean = true; // 是否需要绘制\r\n\r\n    private roots: Canvas2DElement[] = [];\r\n    private ctx?: CanvasRenderingContext2D;\r\n    private _time: number = 0; // 最近一次绘制开始时间\r\n\r\n    constructor(width: number, height: number, public z: number = 0) {\r\n        this.canvas = createCanvas(width, height, 'layer' + z);\r\n        this.ctx = this.canvas.getContext('2d');\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        const parent = el.parent || el.layer;\r\n        if(parent !== this){\r\n            if(parent) {\r\n                parent.remove(el, false);\r\n            }\r\n\r\n            el.layer = this;\r\n            el.needUpdate = true;\r\n            el.left = el.top = null;\r\n\r\n            const index = findIndexByBinary(\r\n                mid => el.style.zIndex - this.roots[mid].style.zIndex || 1,\r\n                this.roots.length\r\n            );\r\n            this.roots.splice(index, 0, el);\r\n\r\n            this.dirty = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        const i: number = this.roots.findIndex(v => v === el);\r\n        if(i >= 0) {\r\n            el.layer = null;\r\n            this.roots.splice(i, 0);\r\n\r\n            if(dispose) {\r\n                el.dispose();\r\n            }\r\n\r\n            this.dirty = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(dom: HTMLElement){\r\n        this.roots.forEach(v => {\r\n            v.layer = null;\r\n            v.dispose();\r\n        });\r\n        this.roots.length = 0;\r\n\r\n        dom.removeChild(this.canvas);\r\n        this.canvas = this.ctx = null;\r\n    }\r\n\r\n    beforeRender() {}\r\n    render(){\r\n        this.beforeRender();\r\n        if(this.dirty){\r\n            this.dirty = false;\r\n\r\n            this._time = Date.now();\r\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n            this._render(0);\r\n        }\r\n    }\r\n    afterRender() {}\r\n\r\n    getTarget(x: number, y: number){\r\n        for(let i=this.roots.length - 1; i>=0; i--){\r\n            const traget = this.roots[i].getTarget(this.ctx, x, y);\r\n\r\n            if(traget) {\r\n                return traget;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    resize(wdith: number, height: number) {\r\n        this.dirty = true;\r\n        Object.assign(this.canvas.style, {\r\n            width: `${wdith}px`,\r\n            height: `${height}px`\r\n        })\r\n\r\n        this.canvas.width = wdith * devicePixelRatio;\r\n        this.canvas.height = height * devicePixelRatio;\r\n\r\n        this.roots.forEach(v => v.needUpdate = true);\r\n    }\r\n\r\n    private async _render(i: number){\r\n        const node = this.roots[i++];\r\n\r\n        if(node){\r\n            if(Date.now() - this._time > 15){\r\n                this.dirty = true;\r\n                this.afterRender();\r\n            } else {\r\n                await node.draw(this.ctx);\r\n                this._render(i);\r\n            }\r\n        } else {\r\n            this.afterRender();\r\n        }\r\n    }\r\n}","import { Layer } from \"./layer\";\r\nimport { addHandler, getPosition } from \"./core/dom\";\r\nimport { IGuiEvent, EventType } from \"./core/event\";\r\nimport { Canvas2DElement } from \"./node/element\";\r\n\r\nexport class Engine {\r\n    private _layers: Map<number, Layer> = new Map();\r\n    private _timer?: number;\r\n    private _preTarget?: Canvas2DElement;\r\n    private _isOut: boolean = true;\r\n\r\n    constructor(private _root: HTMLElement) {\r\n        Object.assign(_root.style, {\r\n            '-webkit-tap-highlight-color': 'transparent',\r\n            '-webkit-user-select': 'none',\r\n            'user-select': 'none',\r\n            '-webkit-touch-callout': 'none'\r\n        })\r\n        _root.innerHTML = '';\r\n        if(!['relative', 'absolute', 'fixed'].includes(_root.style.position)){\r\n            _root.style.position = 'relative';\r\n        }\r\n\r\n        this._initEvent();\r\n\r\n        addHandler(_root, 'mouseleave', () => this._isOut = true);\r\n        addHandler(_root, 'mouseenter', () => this._isOut = false);\r\n    }\r\n\r\n    getLayer(z: number){\r\n        return this._layers.get(z);\r\n    }\r\n\r\n    render(){\r\n        this._layers.forEach(v => v.render());\r\n\r\n        if(this._root){\r\n            this._timer = requestAnimationFrame(this.render.bind(this));\r\n        }\r\n    }\r\n\r\n    addLayer(layer: Layer | number){\r\n        let z: number = typeof layer === 'number' ? layer : layer.z;\r\n        if(this._layers.has(z)) {\r\n            console.warn(`层级${z}已存在`);\r\n        } else {\r\n            if(typeof layer === 'number'){\r\n                layer = new Layer(this._root.offsetWidth, this._root.offsetHeight, layer);\r\n            }\r\n\r\n            this._addLayerToDom(layer)._layers.set(z, layer);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    replaceLayer(layer: Layer){\r\n        const old = this._layers.get(layer.z);\r\n        if(old){\r\n            old.dispose(this._root);\r\n        }\r\n        this._addLayerToDom(layer)._layers.set(layer.z, layer);\r\n\r\n        return this;\r\n    }\r\n\r\n    removeLayer(layer: Layer | number){\r\n        const z: number = typeof layer === 'number' ? layer : layer.z;\r\n        const curLayer = this._layers.get(z);\r\n        if(curLayer){\r\n            curLayer.dispose(this._root);\r\n            this._layers.delete(z);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(){\r\n        if(this._timer) {\r\n            cancelAnimationFrame(this._timer);\r\n        }\r\n\r\n        this._layers.forEach(this.removeLayer, this);\r\n        this._root = this._preTarget = null;\r\n    }\r\n\r\n    resize() {\r\n        this._layers.forEach(v => v.resize(this._root.offsetWidth, this._root.offsetHeight));\r\n    }\r\n\r\n    private _addLayerToDom(layer: Layer){\r\n        for(const v of Array.from(this._layers.values())){\r\n            if(v.z > layer.z){\r\n                this._root.insertBefore(layer.canvas, v.canvas);\r\n\r\n                return this;\r\n            }\r\n        }\r\n\r\n        this._root.appendChild(layer.canvas);\r\n\r\n        return this;\r\n    }\r\n\r\n    private _initEvent() {\r\n        const eventNames: EventType[] = [\r\n            'dbclick', 'click', 'mousedown', 'mouseup', 'mousemove',\r\n            'touchstart', 'touchmove', 'touchend'\r\n        ];\r\n\r\n        eventNames.forEach((type : EventType) => {\r\n            addHandler(this._root, type, (e: Event) => {\r\n                if(!this._isOut) {\r\n                    e = e || window.event;\r\n                    let {x, y} = getPosition(this._root, <MouseEvent>e);\r\n                    x *= devicePixelRatio;\r\n                    y *= devicePixelRatio;\r\n                    const target = this._getTarget(x, y);\r\n                    const guiEvent:IGuiEvent = {x, y, target, cancelBubble: false};\r\n                    if(type === 'mousemove' || type === 'touchmove') {\r\n                        this._moveHandler(guiEvent, e, type);\r\n                    }\r\n\r\n                    if(target && type !== 'mousemove' && type !== 'touchmove') {\r\n                        target.notifyEvent(type, e, guiEvent);\r\n                    }\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    private _moveHandler(guiEvent: IGuiEvent, e: Event, type: 'mousemove' | 'touchmove') {\r\n        if(this._preTarget === guiEvent.target) {\r\n            guiEvent.target && guiEvent.target.notifyEvent(type, e, guiEvent);\r\n        } else {\r\n            if(this._preTarget) {\r\n                this._preTarget.notifyEvent('mouseout', e, {...guiEvent, relatedTarget: guiEvent.target});\r\n            }\r\n            if(guiEvent.target) {\r\n                guiEvent.target.notifyEvent('mouseover', e, {...guiEvent, relatedTarget: this._preTarget});\r\n            }\r\n        }\r\n\r\n        this._preTarget = guiEvent.target;\r\n    }\r\n\r\n    private _getTarget(x: number, y: number) {\r\n        const layers = Array.from(this._layers.keys()).sort((a, b) => b - a);\r\n        for(const layer of layers) {\r\n            const target = this._layers.get(layer).getTarget(x, y);\r\n\r\n            if(target) {\r\n                return target;\r\n            }\r\n        }\r\n    }\r\n}","/**\r\n * 变换矩阵\r\n */\r\nimport { Transform } from \"./transform\";\r\n\r\n\r\nexport class Matrix extends Transform {\r\n    constructor(\r\n        public a: number = 1, // 水平缩放\r\n        public c: number = 0, // 垂直倾斜\r\n        public e: number = 0, // 水平位移\r\n\r\n        public b: number = 0, // 水平倾斜\r\n        public d: number = 1, // 垂直缩放\r\n        public f: number = 0 // 垂直位移\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * 重置为单位阵\r\n     */\r\n    toUnit(){\r\n        this.a = this.d = 1;\r\n        this.c = this.e = this.b = this.f = 0;\r\n\r\n        return this;\r\n    }\r\n\r\n    toArray(){\r\n        return [\r\n            [this.a, this.c, this.e],\r\n            [this.b, this.d, this.f],\r\n            [0, 0, 1]\r\n        ]\r\n    }\r\n\r\n    transform(m: Matrix | number[][], isRight?: boolean){\r\n        if(m instanceof Matrix){\r\n            m = m.toArray();\r\n        }\r\n        const thisArr = this.toArray();\r\n        let left = m, right = thisArr;\r\n        if(isRight) {\r\n            left = thisArr;\r\n            right = m;\r\n        };\r\n\r\n        this.a = left[0][0] * right[0][0] + left[0][1] * right[1][0];\r\n        this.c = left[0][0] * right[0][1] + left[0][1] * right[1][1];\r\n        this.e = left[0][0] * right[0][2] + left[0][1] * right[1][2] + left[0][2];\r\n\r\n        this.b = left[1][0] * right[0][0] + left[1][1] * right[1][0];\r\n        this.d = left[1][0] * right[0][1] + left[1][1] * right[1][1];\r\n        this.f = left[1][0] * right[0][2] + left[1][1] * right[1][2] + left[1][2];\r\n\r\n        return this;\r\n    }\r\n\r\n    // 矩阵求逆\r\n    invert() {\r\n        // |A| == 0, 矩阵不可逆, 使用js最小精度求近似值\r\n        // 矩阵不可逆的情况对于变换矩阵而言出现几率通常较低\r\n        const det = this.a * this.d - this.b * this.c || Number.EPSILON;\r\n\r\n        return new Matrix(\r\n            this.d / det, -this.c / det, (this.c * this.f - this.d * this.e) / det,\r\n            -this.b / det, this.a / det, (this.b * this.e - this.a * this.f) / det\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n* 矩阵相乘\r\n*/\r\n// export function mul(...m: number[][][]){\r\n//     if(!m.length) {\r\n//         return [];\r\n//     }\r\n//     if(m.length === 1) {\r\n//         return m[0];\r\n//     }\r\n\r\n//     return m.reduce(_mul);\r\n// }\r\n\r\n// function _mul(left: number[][], right: number[][]){\r\n//     let r:number, l: number;\r\n\r\n//     try {\r\n//         r = left.length || 0;\r\n//         l = right[0].length || 0;\r\n//     } catch(e) {\r\n//         return console.error(e), [];\r\n//     }\r\n\r\n//     const m: number[][] = [];\r\n//     for(let i=0; i<r; i++){\r\n//         m[i] = [];\r\n\r\n//         for(let j=0; j<l; j++){\r\n//             if(Array.isArray(left[i])){\r\n//                 m[i][j] = left[i].reduce((a, lv, k) => {\r\n//                     let rv = 0;\r\n\r\n//                     if(right[k] && right[k][j] != null){\r\n//                         rv = right[k][j];\r\n//                     } else {\r\n//                         console.error(`${JSON.stringify(right)} ${k}行${j}列不存在`);\r\n//                     }\r\n\r\n//                     return a + lv * rv;\r\n//                 }, 0)\r\n//             } else {\r\n//                 m[i][j] = 0;\r\n//             }\r\n//         }\r\n//     }\r\n\r\n//     return m;\r\n// }","import { Matrix } from \"./matrix\";\r\n\r\nexport class Transform {\r\n    transform(m: Matrix | number[][]){}\r\n\r\n    copy(source: Transform){\r\n        Object.assign(this, source);\r\n\r\n        return this;\r\n    }\r\n\r\n    rotate(rotation: number){\r\n        if(rotation) {\r\n            const cos = Math.cos(rotation);\r\n            const sin = Math.sin(rotation);\r\n            this.transform(\r\n                [\r\n                    [cos, -sin, 0],\r\n                    [sin, cos, 0],\r\n                    [0, 0, 1]\r\n                ]\r\n            );\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    scale(sx: number | number[] = 1, sy: number = 1){\r\n        if(Array.isArray(sx)){\r\n            sy = sx[1];\r\n            sx = sx[0];\r\n        }\r\n\r\n        if(sx !== 1 || sy !== 1){\r\n            this.transform([\r\n                [sx, 0, 0],\r\n                [0, sy, 0],\r\n                [0, 0, 1]\r\n            ]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    translate(x: number | number[] = 0, y: number = 0){\r\n        if(Array.isArray(x)){\r\n            y = x[1];\r\n            x = x[0];\r\n        }\r\n\r\n        if(x || y){\r\n            this.transform([\r\n                [1, 0, x],\r\n                [0, 1, y],\r\n                [0, 0, 1]\r\n            ]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n}","/**\r\n * 包围盒\r\n */\r\nimport { Matrix } from '../lib/matrix';\r\n\r\nexport class BoundingRect {\r\n    constructor(\r\n        public x: number = 0,\r\n        public y: number = 0,\r\n        public w: number = 0,\r\n        public h: number = 0,\r\n    ){}\r\n\r\n    toArray(){\r\n        return [\r\n            [this.x, this.x + this.w, this.x + this.w, this.x],\r\n            [this.y, this.y, this.y + this.h, this.y + this.h],\r\n            [1, 1, 1, 1]\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * 合并包围盒\r\n     * @param other 另一个包围盒\r\n     */\r\n    extend(other: BoundingRect) {\r\n        const x = Math.min(other.x, this.x);\r\n        const y = Math.min(other.y, this.y);\r\n\r\n        this.w = Math.max(other.x + other.w, this.x + this.w) - x;\r\n        this.h = Math.max(other.y + other.h, this.y + this.h) - y;\r\n        this.x = x;\r\n        this.y = y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 包围盒变换\r\n     * @param m 变换矩阵\r\n     */\r\n    transform(m: Matrix,){\r\n        const thisArr = this.toArray();\r\n        const mArr = m.toArray();\r\n\r\n        let minX: number, minY: number,\r\n            maxX: number, maxY: number,\r\n            x: number, y: number;\r\n        minX = minY = Number.MAX_VALUE;\r\n        maxX = maxY = -Number.MAX_VALUE\r\n\r\n        for(let i=0; i<4; i++) {\r\n            x = mArr[0][0] * thisArr[0][i] + mArr[0][1] * thisArr[1][i] + mArr[0][2];\r\n            y = mArr[1][0] * thisArr[0][i] + mArr[1][1] * thisArr[1][i] + mArr[1][2];\r\n\r\n            minX = Math.min(x, minX);\r\n            minY = Math.min(y, minY);\r\n\r\n            maxX = Math.max(x, maxX);\r\n            maxY = Math.max(y, maxY);\r\n        }\r\n\r\n        this.x = minX;\r\n        this.y = minY;\r\n        this.w = maxX - minX;\r\n        this.h = maxY - minY;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 检测一个点是否在此包围盒内部\r\n     */\r\n    contain(x: number, y: number){\r\n        return x >= this.x && x <= this.x + this.w && y >= this.y && y <= this.y + this.h;\r\n    }\r\n\r\n    /**\r\n     * 检测两个包围盒区域是否相交\r\n     */\r\n    intersect(\r\n        x: BoundingRect | number = 0,\r\n        y: number = 0,\r\n        w: number = 0,\r\n        h: number = 0\r\n    ) {\r\n        if(x instanceof BoundingRect){\r\n            y = x.y;\r\n            w = x.w;\r\n            h = x.h;\r\n            x = x.x;\r\n        }\r\n\r\n        const ax0 = this.x;\r\n        const ax1 = this.x + this.w;\r\n        const ay0 = this.y;\r\n        const ay1 = this.y + this.h;\r\n\r\n        const bx0 = x;\r\n        const bx1 = x + w;\r\n        const by0 = y;\r\n        const by1 = y + h;\r\n\r\n        return !(ax1 < bx0 || bx1 < ax0 || ay1 < by0 || by1 < ay0);\r\n    }\r\n\r\n    clone() {\r\n        return new BoundingRect(this.x, this.y, this.w, this.h);\r\n    }\r\n}","/**\r\n * 资源管理，主要是图片\r\n */\r\n\r\ninterface ResData {\r\n    image: HTMLImageElement,\r\n    count: number\r\n}\r\n\r\nconst res: Map<string, ResData> = new Map();\r\n\r\nexport const DEFAULT_SRC = require('../assets/1.jpg'); // 默认图片\r\n\r\n/**\r\n * 获取图片\r\n * @param isFirst 是否是节点第一次请求图片\r\n */\r\nexport function getImg(path: string, isFirst: boolean = true): Promise<HTMLImageElement> {\r\n    const data = res.get(path);\r\n    if(data){\r\n        if(isFirst){\r\n            data.count++;\r\n        }\r\n\r\n        return Promise.resolve(data.image);\r\n    }\r\n\r\n    const img = new Image();\r\n    img.src = path;\r\n\r\n    return new Promise(resolve => {\r\n        img.onload = () => {\r\n            res.set(path, {image: img, count: 1});\r\n\r\n            resolve(img);\r\n        }\r\n\r\n        img.onerror = () => {\r\n            img.src = DEFAULT_SRC;\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * 释放图片\r\n */\r\nexport function disposeImg(path: string){\r\n    const data = res.get(path);\r\n\r\n    if(data){\r\n        data.count--;\r\n        if(data.count <= 0 && path !== DEFAULT_SRC){\r\n            data.image.src = '';\r\n            res.delete(path);\r\n        }\r\n    }\r\n}\r\n\r\ngetImg(DEFAULT_SRC);","\r\n/**\r\n * 将颜色转为rgba颜色的四个值的数组\r\n * 同easing一样从zRender里拿过来的\r\n */\r\nimport { cached } from \"./util\";\r\n\r\n// ========================================\r\nconst kCSSColorTable = {\r\n    'transparent': [0, 0, 0, 0], 'aliceblue': [240, 248, 255, 1],\r\n    'antiquewhite': [250, 235, 215, 1], 'aqua': [0, 255, 255, 1],\r\n    'aquamarine': [127, 255, 212, 1], 'azure': [240, 255, 255, 1],\r\n    'beige': [245, 245, 220, 1], 'bisque': [255, 228, 196, 1],\r\n    'black': [0, 0, 0, 1], 'blanchedalmond': [255, 235, 205, 1],\r\n    'blue': [0, 0, 255, 1], 'blueviolet': [138, 43, 226, 1],\r\n    'brown': [165, 42, 42, 1], 'burlywood': [222, 184, 135, 1],\r\n    'cadetblue': [95, 158, 160, 1], 'chartreuse': [127, 255, 0, 1],\r\n    'chocolate': [210, 105, 30, 1], 'coral': [255, 127, 80, 1],\r\n    'cornflowerblue': [100, 149, 237, 1], 'cornsilk': [255, 248, 220, 1],\r\n    'crimson': [220, 20, 60, 1], 'cyan': [0, 255, 255, 1],\r\n    'darkblue': [0, 0, 139, 1], 'darkcyan': [0, 139, 139, 1],\r\n    'darkgoldenrod': [184, 134, 11, 1], 'darkgray': [169, 169, 169, 1],\r\n    'darkgreen': [0, 100, 0, 1], 'darkgrey': [169, 169, 169, 1],\r\n    'darkkhaki': [189, 183, 107, 1], 'darkmagenta': [139, 0, 139, 1],\r\n    'darkolivegreen': [85, 107, 47, 1], 'darkorange': [255, 140, 0, 1],\r\n    'darkorchid': [153, 50, 204, 1], 'darkred': [139, 0, 0, 1],\r\n    'darksalmon': [233, 150, 122, 1], 'darkseagreen': [143, 188, 143, 1],\r\n    'darkslateblue': [72, 61, 139, 1], 'darkslategray': [47, 79, 79, 1],\r\n    'darkslategrey': [47, 79, 79, 1], 'darkturquoise': [0, 206, 209, 1],\r\n    'darkviolet': [148, 0, 211, 1], 'deeppink': [255, 20, 147, 1],\r\n    'deepskyblue': [0, 191, 255, 1], 'dimgray': [105, 105, 105, 1],\r\n    'dimgrey': [105, 105, 105, 1], 'dodgerblue': [30, 144, 255, 1],\r\n    'firebrick': [178, 34, 34, 1], 'floralwhite': [255, 250, 240, 1],\r\n    'forestgreen': [34, 139, 34, 1], 'fuchsia': [255, 0, 255, 1],\r\n    'gainsboro': [220, 220, 220, 1], 'ghostwhite': [248, 248, 255, 1],\r\n    'gold': [255, 215, 0, 1], 'goldenrod': [218, 165, 32, 1],\r\n    'gray': [128, 128, 128, 1], 'green': [0, 128, 0, 1],\r\n    'greenyellow': [173, 255, 47, 1], 'grey': [128, 128, 128, 1],\r\n    'honeydew': [240, 255, 240, 1], 'hotpink': [255, 105, 180, 1],\r\n    'indianred': [205, 92, 92, 1], 'indigo': [75, 0, 130, 1],\r\n    'ivory': [255, 255, 240, 1], 'khaki': [240, 230, 140, 1],\r\n    'lavender': [230, 230, 250, 1], 'lavenderblush': [255, 240, 245, 1],\r\n    'lawngreen': [124, 252, 0, 1], 'lemonchiffon': [255, 250, 205, 1],\r\n    'lightblue': [173, 216, 230, 1], 'lightcoral': [240, 128, 128, 1],\r\n    'lightcyan': [224, 255, 255, 1], 'lightgoldenrodyellow': [250, 250, 210, 1],\r\n    'lightgray': [211, 211, 211, 1], 'lightgreen': [144, 238, 144, 1],\r\n    'lightgrey': [211, 211, 211, 1], 'lightpink': [255, 182, 193, 1],\r\n    'lightsalmon': [255, 160, 122, 1], 'lightseagreen': [32, 178, 170, 1],\r\n    'lightskyblue': [135, 206, 250, 1], 'lightslategray': [119, 136, 153, 1],\r\n    'lightslategrey': [119, 136, 153, 1], 'lightsteelblue': [176, 196, 222, 1],\r\n    'lightyellow': [255, 255, 224, 1], 'lime': [0, 255, 0, 1],\r\n    'limegreen': [50, 205, 50, 1], 'linen': [250, 240, 230, 1],\r\n    'magenta': [255, 0, 255, 1], 'maroon': [128, 0, 0, 1],\r\n    'mediumaquamarine': [102, 205, 170, 1], 'mediumblue': [0, 0, 205, 1],\r\n    'mediumorchid': [186, 85, 211, 1], 'mediumpurple': [147, 112, 219, 1],\r\n    'mediumseagreen': [60, 179, 113, 1], 'mediumslateblue': [123, 104, 238, 1],\r\n    'mediumspringgreen': [0, 250, 154, 1], 'mediumturquoise': [72, 209, 204, 1],\r\n    'mediumvioletred': [199, 21, 133, 1], 'midnightblue': [25, 25, 112, 1],\r\n    'mintcream': [245, 255, 250, 1], 'mistyrose': [255, 228, 225, 1],\r\n    'moccasin': [255, 228, 181, 1], 'navajowhite': [255, 222, 173, 1],\r\n    'navy': [0, 0, 128, 1], 'oldlace': [253, 245, 230, 1],\r\n    'olive': [128, 128, 0, 1], 'olivedrab': [107, 142, 35, 1],\r\n    'orange': [255, 165, 0, 1], 'orangered': [255, 69, 0, 1],\r\n    'orchid': [218, 112, 214, 1], 'palegoldenrod': [238, 232, 170, 1],\r\n    'palegreen': [152, 251, 152, 1], 'paleturquoise': [175, 238, 238, 1],\r\n    'palevioletred': [219, 112, 147, 1], 'papayawhip': [255, 239, 213, 1],\r\n    'peachpuff': [255, 218, 185, 1], 'peru': [205, 133, 63, 1],\r\n    'pink': [255, 192, 203, 1], 'plum': [221, 160, 221, 1],\r\n    'powderblue': [176, 224, 230, 1], 'purple': [128, 0, 128, 1],\r\n    'red': [255, 0, 0, 1], 'rosybrown': [188, 143, 143, 1],\r\n    'royalblue': [65, 105, 225, 1], 'saddlebrown': [139, 69, 19, 1],\r\n    'salmon': [250, 128, 114, 1], 'sandybrown': [244, 164, 96, 1],\r\n    'seagreen': [46, 139, 87, 1], 'seashell': [255, 245, 238, 1],\r\n    'sienna': [160, 82, 45, 1], 'silver': [192, 192, 192, 1],\r\n    'skyblue': [135, 206, 235, 1], 'slateblue': [106, 90, 205, 1],\r\n    'slategray': [112, 128, 144, 1], 'slategrey': [112, 128, 144, 1],\r\n    'snow': [255, 250, 250, 1], 'springgreen': [0, 255, 127, 1],\r\n    'steelblue': [70, 130, 180, 1], 'tan': [210, 180, 140, 1],\r\n    'teal': [0, 128, 128, 1], 'thistle': [216, 191, 216, 1],\r\n    'tomato': [255, 99, 71, 1], 'turquoise': [64, 224, 208, 1],\r\n    'violet': [238, 130, 238, 1], 'wheat': [245, 222, 179, 1],\r\n    'white': [255, 255, 255, 1], 'whitesmoke': [245, 245, 245, 1],\r\n    'yellow': [255, 255, 0, 1], 'yellowgreen': [154, 205, 50, 1]\r\n};\r\n\r\nfunction clampCssByte(i: number) {  // Clamp to integer 0 .. 255.\r\n    i = Math.round(i);  // Seems to be what Chrome does (vs truncation).\r\n    return i < 0 ? 0 : i > 255 ? 255 : i;\r\n}\r\n\r\nfunction clampCssFloat(f: number) {  // Clamp to float 0.0 .. 1.0.\r\n    return f < 0 ? 0 : f > 1 ? 1 : f;\r\n}\r\n\r\nfunction parseCssInt(str: string) {  // int or percentage.\r\n    if (str.length && str.charAt(str.length - 1) === '%') {\r\n        return clampCssByte(parseFloat(str) / 100 * 255);\r\n    }\r\n    return clampCssByte(parseInt(str, 10));\r\n}\r\n\r\nfunction parseCssFloat(str: string) {  // float or percentage.\r\n    if (str.length && str.charAt(str.length - 1) === '%') {\r\n        return clampCssFloat(parseFloat(str) / 100);\r\n    }\r\n    return clampCssFloat(parseFloat(str));\r\n}\r\n\r\nfunction cssHueToRgb(m1: number, m2: number, h: number) {\r\n    if (h < 0) {\r\n        h += 1;\r\n    }\r\n    else if (h > 1) {\r\n        h -= 1;\r\n    }\r\n\r\n    if (h * 6 < 1) {\r\n        return m1 + (m2 - m1) * h * 6;\r\n    }\r\n    if (h * 2 < 1) {\r\n        return m2;\r\n    }\r\n    if (h * 3 < 2) {\r\n        return m1 + (m2 - m1) * (2 / 3 - h) * 6;\r\n    }\r\n    return m1;\r\n}\r\n\r\nfunction hsla2rgba(hsla: string[]) {\r\n    const h = (((parseFloat(hsla[0]) % 360) + 360) % 360) / 360;  // 0 .. 1\r\n\r\n    // NOTE(deanm): According to the CSS spec s/l should only be\r\n    // percentages, but we don't bother and let float or percentage.\r\n    const s = parseCssFloat(hsla[1]);\r\n    const l = parseCssFloat(hsla[2]);\r\n    const m2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\r\n    const m1 = l * 2 - m2;\r\n\r\n    const rgba = [\r\n        clampCssByte(cssHueToRgb(m1, m2, h + 1 / 3) * 255),\r\n        clampCssByte(cssHueToRgb(m1, m2, h) * 255),\r\n        clampCssByte(cssHueToRgb(m1, m2, h - 1 / 3) * 255),\r\n        1\r\n    ];\r\n\r\n    if (hsla.length === 4) {\r\n        rgba[3] = +hsla[3];\r\n    }\r\n\r\n    return rgba;\r\n}\r\n\r\nfunction err(str: string) {\r\n    console.error(`${str}不是有效的ccs颜色值`);\r\n    return [0, 0, 0, 0];\r\n}\r\n\r\n/**\r\n * 将颜色转为rgba颜色的四个值的数组\r\n */\r\nexport const parseColor = cached((colorStr: string): number[] => {\r\n    if (typeof colorStr !== 'string' || !colorStr) {\r\n        return err(colorStr);\r\n    }\r\n    const str = colorStr.replace(/ /g, '').toLowerCase();\r\n\r\n    if (Reflect.has(kCSSColorTable, str)) {\r\n        return Array.from(Reflect.get(kCSSColorTable, str));\r\n    }\r\n\r\n    // #abc and #abc123 syntax.\r\n    if (str.startsWith('#')) {\r\n        if (str.length === 4) {\r\n            var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\r\n            if (!(iv >= 0 && iv <= 0xfff)) {\r\n                return err(str);\r\n            }\r\n\r\n            return [\r\n                ((iv & 0xf00) >> 4) | ((iv & 0xf00) >> 8),\r\n                (iv & 0xf0) | ((iv & 0xf0) >> 4),\r\n                (iv & 0xf) | ((iv & 0xf) << 4),\r\n                1\r\n            ];\r\n        }\r\n        else if (str.length === 7) {\r\n            var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\r\n            if (!(iv >= 0 && iv <= 0xffffff)) {\r\n                return err(str);\r\n            }\r\n            return [\r\n                (iv & 0xff0000) >> 16,\r\n                (iv & 0xff00) >> 8,\r\n                iv & 0xff,\r\n                1\r\n            ];\r\n        }\r\n\r\n        return err(str);\r\n    }\r\n\r\n    const op = str.indexOf('(');\r\n    const ep = str.indexOf(')');\r\n    if (op !== -1 && ep + 1 === str.length) {\r\n        const fname = str.substr(0, op);\r\n        const params = str.substr(op + 1, ep - (op + 1)).split(',');\r\n        let alpha = 1;  // To allow case fallthrough.\r\n        switch (fname) {\r\n            case 'rgba':\r\n                if (params.length !== 4) {\r\n                    return err(str);\r\n                }\r\n                alpha = parseCssFloat(params.pop()); // jshint ignore:line\r\n            // Fall through.\r\n            case 'rgb':\r\n                if (params.length !== 3) {\r\n                    return err(str);\r\n                }\r\n\r\n                return [\r\n                    parseCssInt(params[0]),\r\n                    parseCssInt(params[1]),\r\n                    parseCssInt(params[2]),\r\n                    alpha\r\n                ];\r\n            case 'hsla':\r\n                if (params.length !== 4) {\r\n                    return err(str);\r\n                }\r\n                params[3] = parseCssFloat(params[3]) + '';\r\n\r\n                return hsla2rgba(params);\r\n            case 'hsl':\r\n                if (params.length !== 3) {\r\n                    return err(str);\r\n                }\r\n                return hsla2rgba(params);\r\n        }\r\n    }\r\n\r\n    return err(str);\r\n}, 50)\r\n\r\n/**\r\n * @param arrColor like [12,33,44,0.4]\r\n * @param type 'rgba', 'hsva', ...\r\n * @return Result color. (If input illegal, return undefined).\r\n */\r\nexport function stringify(arrColor: number[], type: string) {\r\n    if (!arrColor || !arrColor.length) {\r\n        return;\r\n    }\r\n    let colorStr = arrColor[0] + ',' + arrColor[1] + ',' + arrColor[2];\r\n    if (type === 'rgba' || type === 'hsva' || type === 'hsla') {\r\n        colorStr += ',' + arrColor[3];\r\n    }\r\n\r\n    return type + '(' + colorStr + ')';\r\n}","/// <reference lib=\"es2017.object\" />\r\n\r\n/**\r\n * 样式\r\n */\r\nimport { isImg, makeCheckExist } from \"../tool/util\";\r\nimport { getImg, disposeImg, DEFAULT_SRC } from \"./resource\";\r\nimport { parseColor, stringify } from \"../tool/color\";\r\n\r\n/**\r\n * 将数据解析为有4个元素的数组\r\n */\r\nfunction parseNumArr(data: number | number[]){\r\n    const res = new Array(4).fill(0);\r\n    if(Array.isArray(data)){\r\n        switch(data.length){\r\n            case 1: res[0] = res[1] = data[0];\r\n            case 2: res[2] = res[0];\r\n            case 3:\r\n                res[3] = res[1];\r\n                break;\r\n            default: Object.assign(res, data);\r\n        }\r\n    } else if(typeof data === 'number'){\r\n        res.fill(data)\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\nconst isTransformKey = makeCheckExist(\r\n    'rotation left top bottom right' + ' ' +\r\n    'scale scaleX scaleY width height' + ' ' +\r\n    'origin originX originY'\r\n)\r\n\r\n// ====================================================\r\nexport interface Istyle {\r\n    background?: string | CanvasGradient;\r\n    color?: string | CanvasGradient;\r\n    clip?: boolean;\r\n\r\n    src?: string;\r\n\r\n    border?: number;\r\n    borderColor?: string | CanvasGradient;\r\n    borderRadius?: number | number[];\r\n    borderStyle?: number[];\r\n\r\n    opacity?: number;\r\n\r\n    width?: number | string;\r\n    height?: number | string;\r\n\r\n    rotation?: number;\r\n\r\n    scaleX?: number;\r\n    scaleY?: number;\r\n    scale?: number | number[];\r\n\r\n    left?: number | string;\r\n    right?: number | string;\r\n    top?: number | string;\r\n    bottom?: number | string;\r\n\r\n    origin?: number | number[];\r\n    originX?: number;\r\n    originY?: number;\r\n\r\n    cellId?: number;\r\n    cellWidth?: number | string;\r\n    cellHeight?: number | string;\r\n}\r\n\r\nexport class Style {\r\n    background?: string | CanvasGradient;\r\n    color: string | CanvasGradient = '#000';\r\n\r\n    src?: string; // 图片路径\r\n\r\n    border: number = 0;\r\n    borderColor: string | CanvasGradient = '#000';\r\n    borderRadius?: number[];\r\n    borderStyle: number[] = [];\r\n\r\n    opacity: number = 1; // 有点bug，没有实现类似css的效果, 待解决\r\n\r\n    width: number | string = '100%';\r\n    height: number | string = '100%';\r\n\r\n    rotation: number = 0;\r\n\r\n    scale: number[] = [1, 1];\r\n\r\n    left?: number | string;\r\n    right?: number | string;\r\n    top?: number | string;\r\n    bottom?: number | string;\r\n\r\n    zIndex: number = 0;\r\n\r\n    clip: boolean = false;\r\n\r\n    origin: number[] = [0.5, 0.5];\r\n\r\n    private _res: Set<string> = new Set(); // 节点已加载过的图片资源\r\n\r\n    set(key: string | Istyle, value: any){\r\n        if(typeof key === 'string'){\r\n            return this.attr([key, value]);\r\n        } else {\r\n            return Object.entries(key).map(this.attr, this).includes(true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据样式设置绘制状态\r\n     * @param width 节点的宽\r\n     * @param height 节点的高\r\n     */\r\n    async build(ctx: CanvasRenderingContext2D, width: number, height: number){\r\n        if(this.border){\r\n            ctx.setLineDash(this.borderStyle);\r\n            ctx.strokeStyle = this.borderColor;\r\n            ctx.lineWidth = this.border;\r\n        }\r\n\r\n        if(this.background) {\r\n            if(isImg(this.background)) {\r\n                const path = <string>this.background;\r\n                const img = await this.loadImg(path);\r\n\r\n                const pattern = ctx.createPattern(img, 'no-repeat');\r\n                pattern.setTransform({\r\n                    a: width / img.width, d: height / img.height,\r\n                    b: 0, c: 0, e: 0, f: 0\r\n                });\r\n            } else {\r\n                ctx.fillStyle = this.background;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置全局透明度\r\n     */\r\n    setAlpha(ctx: CanvasRenderingContext2D){\r\n        const alpha = Math.max(0, Math.min(1, this.opacity));\r\n        if(alpha < 1 && ctx.globalAlpha > 0) {\r\n            ctx.globalAlpha *= alpha;\r\n        }\r\n    }\r\n\r\n    dispose(){\r\n        this._res.forEach(disposeImg);\r\n        this._res.clear();\r\n    }\r\n\r\n    /**\r\n     * 判断新值与旧值是否相等\r\n     */\r\n    equal(key: string, value: any){\r\n        let old = Reflect.get(this, key);\r\n        if(old == null) {\r\n            old = Reflect.get(this, key.substr(0, key.length - 1));\r\n        }\r\n\r\n        if(key === 'border') {\r\n            value *= devicePixelRatio;\r\n        }\r\n\r\n        if(Array.isArray(old)) {\r\n            if(Array.isArray(value)) {\r\n                if(key === 'borderStyle' && old.length !== value.length) {\r\n                    return false;\r\n                }\r\n\r\n                return old.every((v, i) => v === value[i]);\r\n            }\r\n\r\n            if(key.endsWith('X')) {\r\n                return old[0] === value;\r\n            }\r\n\r\n            if(key.endsWith('Y')){\r\n                return old[1] === value;\r\n            }\r\n\r\n            return old.every(v => v === value);\r\n        }\r\n\r\n        return old === value;\r\n    }\r\n\r\n    /**\r\n     * 获取Image\r\n     * @param src 图片路径\r\n     */\r\n    loadImg(src:string = this.src) {\r\n        if(!isImg(src)) {\r\n            console.warn(`${src}不是有效的图片路径`);\r\n\r\n            src = DEFAULT_SRC;\r\n        }\r\n\r\n        const isFirst = !this._res.has(src);\r\n        this._res.add(src);\r\n\r\n        return getImg(src, isFirst);\r\n    }\r\n\r\n    private attr([key, value]: [string, any]){\r\n        let isModifyTransform = isTransformKey(key);\r\n        if(isModifyTransform) {\r\n            isModifyTransform = isModifyTransform && !this.equal(key, value);\r\n        }\r\n\r\n        if((key === 'src' || key === 'background') && typeof value === 'string' && !isImg(value)) {\r\n            value = stringify(parseColor(value), 'rgba');\r\n        }\r\n\r\n        switch(key){\r\n            case 'borderRadius':\r\n                this[key] = parseNumArr(value);\r\n                break;\r\n            case 'scale': case 'origin':\r\n                this[key] = Array.isArray(value) ? value : [value, value];\r\n                break;\r\n            case 'scaleX': case 'originX': case 'scaleY': case 'originY':\r\n                const k = <'scale' | 'origin'>key.substr(0, key.length - 1);\r\n                this[k][key.endsWith('X') ? 0 : 1] = value;\r\n                break;\r\n            case 'border':\r\n                value *= devicePixelRatio;\r\n            default:\r\n                Reflect.set(this, key, value);\r\n        }\r\n\r\n        return isModifyTransform;\r\n    }\r\n}","/**\r\n * 事件\r\n */\r\nimport { Canvas2DElement } from \"../node/element\";\r\n\r\nexport type EventType = 'dbclick' | 'click' | 'mousedown' | 'mouseup' | 'mousemove'\r\n                            | 'mouseout' | 'mouseover'\r\n                            | 'touchstart' | 'touchmove' | 'touchend'\r\n                            | 'change' | 'input' | 'focus' | 'blur';\r\n\r\nexport interface IGuiEvent {\r\n    x?: number;\r\n    y?: number;\r\n    target: Canvas2DElement;\r\n    relatedTarget?: Canvas2DElement;\r\n    cancelBubble?: boolean;\r\n}\r\n\r\nexport class EventFul {\r\n    private _handlers: {[type: string]: Set<Function>} = {};\r\n\r\n    on(type: EventType, fn: Function) {\r\n        (this._handlers[type] || (this._handlers[type] = new Set())).add(fn);\r\n\r\n        return this;\r\n    }\r\n\r\n    off(type: EventType, fn: Function) {\r\n        const handlers = this._handlers[type];\r\n        if(handlers) {\r\n            handlers.delete(fn);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    notify(type: EventType, event: Event, guiEvent: IGuiEvent, context: Canvas2DElement) {\r\n        const handlers = this._handlers[type];\r\n        if(handlers) {\r\n            handlers.forEach(fn => fn.call(context, guiEvent, event));\r\n        }\r\n\r\n        return guiEvent.cancelBubble;\r\n    }\r\n\r\n    dispose() {\r\n        this._handlers = {};\r\n    }\r\n}","\r\n\r\n// 画一个圆弧\r\nexport function ellipse(\r\n    ctx: CanvasRenderingContext2D,\r\n    cx: number, cy: number,\r\n    rx: number, ry: number,\r\n    startAngle: number, endAngle: number,\r\n    rotation: number,\r\n    anticlockwise: number,\r\n){\r\n    if(Math.abs(rx - ry) > Number.EPSILON * 2 ** 10){ // 椭圆\r\n        ctx.save();\r\n\r\n        const scaleX = rx > ry ? 1 : rx / ry;\r\n        const scaleY = rx > ry ? ry / rx : 1;\r\n\r\n        ctx.translate(cx, cy);\r\n        ctx.rotate(rotation);\r\n        ctx.scale(scaleX, scaleY);\r\n        ctx.arc(0, 0, Math.max(rx, ry), startAngle, endAngle, !anticlockwise);\r\n\r\n        ctx.restore();\r\n    } else {\r\n        ctx.arc(cx, cy, rx, startAngle, endAngle, !anticlockwise);\r\n    }\r\n}\r\n\r\n/**\r\n * 构建圆角矩形。性能消耗较大, 应减少使用, 或静态时使用\r\n *\r\n * 在 border存在 时圆角处会出现缝隙\r\n * 且 border越大 缝隙越大\r\n */\r\nexport function buildRadiusPath(\r\n    ctx: CanvasRenderingContext2D,\r\n    x: number, y: number,\r\n    w: number, h: number,\r\n    borderRadius: number[]\r\n){\r\n    const radius = borderRadius.map(v => {\r\n        const res = [v, v];\r\n        if(v <= 1) {\r\n            res[0] *= w;\r\n            res[1] *= h;\r\n        }\r\n        res[0] = Math.min(res[0], w / 2);\r\n        res[1] = Math.min(res[1], h / 2);\r\n\r\n        return res;\r\n    });\r\n\r\n    ctx.moveTo(x + w, y + radius[1][1]);\r\n\r\n    // 右上\r\n    ellipse(ctx, x + w - radius[1][0], y + radius[1][1], radius[1][0], radius[1][1], 0, -Math.PI / 2, 0, 0);\r\n    // 上\r\n    if(Math.abs(radius[0][0] - w + radius[1][0]) > 1e-3){\r\n        ctx.lineTo(x + radius[0][0], y);\r\n    }\r\n\r\n    // 左上\r\n    ellipse(ctx, x + radius[0][0], y + radius[0][1], radius[0][0], radius[0][1], -Math.PI / 2, Math.PI, 0, 0);\r\n    // 左\r\n    if(Math.abs(h - radius[0][1] - radius[3][1]) > 1e-3) {\r\n        ctx.lineTo(x, y + h - radius[3][1]);\r\n    }\r\n\r\n    // 左下\r\n    ellipse(ctx, x + radius[3][0], y + h - radius[3][1], radius[3][0], radius[3][1], Math.PI, Math.PI / 2, 0, 0);\r\n    // 下\r\n    if(Math.abs(w - radius[2][0] - radius[3][0]) > 1e-3) {\r\n        ctx.lineTo(x + w - radius[2][0], y + h);\r\n    }\r\n\r\n    // 右下\r\n    ellipse(ctx, x + w - radius[2][0], y + h - radius[2][1], radius[2][0], radius[2][1], Math.PI / 2, 0, 0, 0);\r\n    // 右\r\n    if(Math.abs(radius[1][1] - h + radius[2][1]) > 1e-3) {\r\n        ctx.lineTo(x + w, y + radius[1][1]);\r\n    }\r\n}\r\n\r\n/**\r\n * 创建路径, 可用于检测一个点是否在节点内部\r\n */\r\nexport function buildPath(\r\n    ctx: CanvasRenderingContext2D,\r\n    x: number, y: number,\r\n    width: number, height: number,\r\n    borderRadius?: number[]\r\n){\r\n    ctx.beginPath();\r\n    if(borderRadius){\r\n        buildRadiusPath(ctx, x, y, width, height, borderRadius);\r\n    } else {\r\n        ctx.rect(x, y, width, height);\r\n    }\r\n    ctx.closePath();\r\n}","/**\r\n * 节点基类\r\n * 各尺寸尽可能为偶数\r\n */\r\n\r\nimport { Matrix } from \"../lib/matrix\";\r\nimport { Layer } from \"../layer\";\r\nimport { Container } from \"./container\";\r\nimport { BoundingRect } from \"../core/bounding_rect\";\r\nimport { Style, Istyle } from \"../core/style\";\r\nimport { parseSize } from \"../core/dom\";\r\nimport { Canvas2DAnimation } from \"../animation/animation\";\r\nimport { EventFul, IGuiEvent, EventType } from \"../core/event\";\r\nimport { createId } from \"../tool/util\";\r\nimport { buildPath } from \"../tool/paint\";\r\n\r\nexport class Canvas2DElement {\r\n    readonly type: string = 'element';\r\n\r\n    index: number = 0; // 在父容器内部的添加顺序\r\n    parent?: Container;\r\n    layer?: Layer;\r\n\r\n    transform = new Matrix();\r\n    rect?: BoundingRect;\r\n    event = new EventFul();\r\n    checkedPoint: Map<string, boolean> = new Map(); // 已检测过是否包含的点及其结果\r\n\r\n    isVisible: boolean = true; // 是否可见\r\n    style: Style = new Style();\r\n    origin: number[] = [0, 0]; // update时计算出的变换中心\r\n    width: number = 0; // 通过calcSize计算出的width\r\n    height: number = 0; // 通过calcSize计算出的height\r\n    left?: number; // 存在时覆盖style.left设置\r\n    top?: number;// 存在时覆盖style.top设置\r\n\r\n    protected _needUpdate: boolean = true; // 是否需要执行update\r\n    protected _cached?: HTMLCanvasElement; // 缓存节点\r\n    protected _cachedTransform?: Matrix; // 使用缓存绘制时的变换矩阵的逆矩阵\r\n\r\n    private _animation?: Canvas2DAnimation;\r\n    private _parentWidth: number = 0;\r\n    private _parentHeight: number = 0;\r\n\r\n    private _ignore: boolean = true; // 最近一次绘制是否忽略了此节点的绘制\r\n    private _dirty: boolean = true;\r\n\r\n    constructor(public id: string | number, public isStatic: boolean = false) {\r\n        this.id = createId(id);\r\n    }\r\n\r\n    get needUpdate() {\r\n        return this._needUpdate;\r\n    }\r\n\r\n    set needUpdate(needUpdate: boolean) {\r\n        this._needUpdate = needUpdate;\r\n    }\r\n\r\n    get animation() {\r\n        return this._animation;\r\n    }\r\n\r\n    set animation(animation: Canvas2DAnimation) {\r\n        if(animation !== this._animation) {\r\n            if(this._animation) {\r\n                this._animation.el.delete(this);\r\n            }\r\n\r\n            this._animation = animation;\r\n            animation && animation.addElement(this);\r\n        }\r\n    }\r\n\r\n    dispose() {\r\n        if(this.layer) {\r\n            this.layer.remove(this, false);\r\n        }\r\n\r\n        if(this.parent){\r\n            this.parent.remove(this, false);\r\n        }\r\n\r\n        this.event.dispose();\r\n        this.style.dispose();\r\n        if(this._animation) {\r\n            this._animation.el.delete(this);\r\n        }\r\n\r\n        this._cached\r\n        = this._animation\r\n        = this.rect\r\n        = this.transform\r\n        = this.style\r\n        = this.layer\r\n        = this.parent\r\n        = this.style = null;\r\n    }\r\n\r\n    async draw(ctx: CanvasRenderingContext2D){\r\n        this.beforeUpdate();\r\n        await this.getBoundingRect();\r\n        this.afterUpdate();\r\n\r\n        if(this._isPaint(ctx.canvas.width, ctx.canvas.height)) {\r\n            ctx.save();\r\n            this.style.setAlpha(ctx);\r\n\r\n            if(this.isStatic){\r\n                if(!this._cached){\r\n                    this._cached = await this.buildCached(this.width, this.height, ctx);\r\n                }\r\n                const transform = this._cachedTransform\r\n                                    ? new Matrix().copy(this._cachedTransform).transform(this.transform)\r\n                                    : this.transform;\r\n                this.setTransform(ctx, transform);\r\n                ctx.drawImage(this._cached, 0, 0, this._cached.width, this._cached.height);\r\n            } else {\r\n                this._cachedTransform = null;\r\n                this.setTransform(ctx);\r\n                await this.build(ctx);\r\n            }\r\n            ctx.restore();\r\n\r\n            this.afterBuild();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置节点样式\r\n     */\r\n    attr(key: string | Istyle, value?: any){\r\n        if(typeof key === 'string') {\r\n            key = {[key]: value};\r\n        }\r\n\r\n        let isEqual: boolean = true;\r\n        for(const [k, v] of Object.entries(key)){\r\n            if(!this.style.equal(k, v)) {\r\n                isEqual = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(!isEqual) {\r\n            if(this.style.set(key, value)){\r\n                this.needUpdate = true;\r\n            }\r\n\r\n            this.markDirty();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 获取节点AABB类包围盒\r\n     */\r\n    async getBoundingRect() {\r\n        if(this._needUpdate) {\r\n            await this.update();\r\n\r\n            this.rect = new BoundingRect(0, 0, this.width, this.height)\r\n                            .transform(this.transform);\r\n\r\n            this._needUpdate = false;\r\n        }\r\n\r\n        return this.rect;\r\n    };\r\n\r\n    /**\r\n     * 标记节点所在的层需要重绘\r\n     */\r\n    markDirty(){\r\n        if(!this._dirty) {\r\n            this._dirty = true;\r\n            if(this.parent){\r\n                this.parent.markDirty();\r\n            }\r\n            if(this.layer){\r\n                this.layer.dirty = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 触发事件\r\n     * @param type 事件类型\r\n     */\r\n    notifyEvent(type: EventType, event: Event, guiEvent: IGuiEvent) {\r\n        const skip = this.event.notify(type, event, guiEvent, this);\r\n\r\n        if(!['change', 'input', 'foucs', 'blur'].includes(type) && !skip && this.parent) {\r\n            this.parent.notifyEvent(type, event, guiEvent);\r\n        }\r\n    }\r\n\r\n    // ========================钩子函数\r\n    beforeUpdate() {\r\n        this._ignore = true;\r\n    }\r\n\r\n    async update(){\r\n        this._parentWidth = this._getBaseSize('width');\r\n        this._parentHeight = this._getBaseSize('height');\r\n\r\n        if(!(this.isStatic && this._cached)){\r\n            await this.calcSize();\r\n            this.style.border = Math.min(this.style.border, this.width / 2, this.height / 2);\r\n            if(this.style.border < 0){\r\n                this.style.border = 0;\r\n            }\r\n\r\n            this.origin[0] = this.style.origin[0] * this.width;\r\n            this.origin[1] = this.style.origin[1] * this.height;\r\n        }\r\n\r\n        this.updateTransform();\r\n\r\n        this.checkedPoint.clear();\r\n    }\r\n\r\n    afterUpdate(){\r\n        this._dirty = false;\r\n    }\r\n\r\n    beforeBuild() {}\r\n\r\n    async build(ctx: CanvasRenderingContext2D) {\r\n        const border = this.style.border;\r\n        let width = this.width - border;\r\n        let height = this.height - border;\r\n\r\n        buildPath(ctx, 0, 0, width, height, this.style.borderRadius);\r\n        await this.style.build(ctx, width, height);\r\n\r\n        if(border){\r\n            this.style.borderColor && ctx.stroke();\r\n\r\n            if(this.style.background || this.style.clip){\r\n                buildPath(\r\n                    ctx,\r\n                    border / 2, border / 2,\r\n                    width - border, height - border,\r\n                    this.style.borderRadius\r\n                );\r\n            }\r\n        }\r\n\r\n        if(this.style.background){\r\n            ctx.fill();\r\n        }\r\n    }\r\n    afterBuild() {\r\n        this._ignore = false;\r\n    }\r\n\r\n    /**\r\n     * 计算节点宽高\r\n     */\r\n    async calcSize(){\r\n        this.width = parseSize(this.style.width, this._parentWidth);\r\n        this.height = parseSize(this.style.height, this._parentHeight);\r\n    }\r\n\r\n    // 更新变换矩阵\r\n    updateTransform(){\r\n        const style = this.style;\r\n\r\n        let x: number = this.left, y: number = this.top;\r\n        if(x == null) {\r\n            if(style.left != null) {\r\n                x = parseSize(style.left, this._parentWidth);\r\n            } else if(style.right != null){\r\n                x = this._parentWidth - parseSize(style.right, this._parentWidth) - this.width;\r\n            } else { // x方向没有任何设置, 默认居中\r\n                x = parseSize('50%', this._parentWidth) - this.width / 2;\r\n            }\r\n        }\r\n\r\n        if(y == null) {\r\n            if(style.top != null) {\r\n                y = parseSize(style.top, this._parentHeight);\r\n            } else if(style.bottom != null){\r\n                y = this._parentHeight - parseSize(style.bottom, this._parentHeight) - this.height;\r\n            } else {// y方向没有任何设置, 默认居中\r\n                y = parseSize('50%', this._parentHeight) - this.height / 2;\r\n            }\r\n        }\r\n\r\n        this.transform\r\n            .toUnit()\r\n            .translate(-this.origin[0], -this.origin[1]) // 变换中心\r\n            .scale(style.scale) // 缩放\r\n            .rotate(style.rotation) // 旋转\r\n            .translate(x + this.origin[0], y + this.origin[1]); // 平移\r\n\r\n        // 父节点变换\r\n        if(this.parent){\r\n            const parent = this.parent;\r\n            this.transform\r\n                .translate(parent.style.border, parent.style.border)\r\n                .transform(parent.transform);\r\n        }\r\n    }\r\n    // =============================================================\r\n\r\n    /**\r\n     * 缓存绘制\r\n     * @param width 缓存canvas的宽\r\n     * @param height 缓存canvas的高\r\n     * @param ctx\r\n     */\r\n    async buildCached(width: number, height: number, ctx: CanvasRenderingContext2D) {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        const cachedCtx = canvas.getContext('2d');\r\n        cachedCtx.save();\r\n        cachedCtx.translate(this.style.border / 2, this.style.border / 2);\r\n        await this.build(cachedCtx);\r\n        cachedCtx.restore();\r\n\r\n        return canvas;\r\n    }\r\n\r\n    /**\r\n     * 获取鼠标在哪个元素上\r\n     */\r\n    getTarget(ctx: CanvasRenderingContext2D, x: number, y: number){\r\n        if(this._contain(ctx, x, y)){\r\n            return <Canvas2DElement>this;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 设置画布变换\r\n     */\r\n    setTransform(ctx: CanvasRenderingContext2D, transform: Matrix = this.transform){\r\n        const {a, b, c, d, e, f} = transform;\r\n\r\n        ctx.transform(a, b, c, d, e, f);\r\n        ctx.translate(this.style.border / 2, this.style.border / 2);\r\n\r\n        this.beforeBuild();\r\n    }\r\n\r\n    /**\r\n     * 获取父级尺寸\r\n     */\r\n    getParentSize(key: 'width' | 'height') {\r\n        if(key === 'width') {\r\n            return this._parentWidth;\r\n        } else if(key === 'height') {\r\n            return this._parentHeight;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * 检测一个点是否落在此节点上\r\n     */\r\n    protected _contain(ctx: CanvasRenderingContext2D, x: number, y: number){\r\n        if(this._ignore) {\r\n            return false;\r\n        }\r\n\r\n        const pk: string = `${x}_${y}`;\r\n        if(this.checkedPoint.has(pk)) {\r\n            return this.checkedPoint.get(pk);\r\n        }\r\n\r\n        if(this.rect && !this.rect.contain(x, y)) {\r\n            this.checkedPoint.set(pk, false);\r\n            return false;\r\n        }\r\n\r\n        // =======================================处于裁切路径外的点不在此节点上\r\n        const clipParent = this.getParent((parent: Container) => parent.style.clip);\r\n        if(clipParent) {\r\n            const border = clipParent.style.border;\r\n\r\n            ctx.setTransform(clipParent.transform);\r\n            ctx.translate(border, border);\r\n            buildPath(\r\n                ctx, 0, 0,\r\n                clipParent.width - border * 2,\r\n                clipParent.height - border * 2,\r\n                clipParent.style.borderRadius\r\n            );\r\n\r\n            if(!ctx.isPointInPath(x, y)) {\r\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n                this.checkedPoint.set(pk, false);\r\n\r\n                return false;\r\n            }\r\n        }\r\n\r\n        ctx.setTransform(this.transform);\r\n        buildPath(ctx, 0, 0, this.width, this.height, this.style.borderRadius);\r\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n        const result = ctx.isPointInPath(x, y);\r\n        this.checkedPoint.set(pk, result);\r\n\r\n        return result;\r\n    }\r\n\r\n    // 计算父节点尺寸\r\n    private _getBaseSize(key: 'width'| 'height'){\r\n        let base: number = 0;\r\n        if(this.parent) {\r\n            base = this.parent[key];\r\n            if(this.parent.style.border) {\r\n                base -= this.parent.style.border * 2;\r\n            }\r\n        } else if(this.layer && this.layer.canvas){\r\n            base = this.layer.canvas[key];\r\n        }\r\n\r\n        return base;\r\n    }\r\n\r\n    // 是否需要绘制\r\n    private _isPaint(rootWidth: number, rootHeight: number){\r\n        if(\r\n            this.isVisible\r\n            && this.style.opacity\r\n            && this.style.scale[0]\r\n            && this.style.scale[1]\r\n            && this.width >= 0\r\n            && this.height >= 0\r\n        ) {\r\n            const clipParent = this.getParent((parent: Container) => parent.style.clip);\r\n            if(clipParent){\r\n                return this.rect.intersect(clipParent.rect);\r\n            }\r\n\r\n            if((this.isStatic || this.getParent((parent: Container) => parent.isStatic)) && !this._cached) {\r\n                return true;\r\n            }\r\n\r\n            return this.rect.intersect(0, 0, rootWidth, rootHeight);\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    private getParent(filter: Function) {\r\n        let parent = this.parent;\r\n        while(parent){\r\n            if(filter(parent)){\r\n                return parent;\r\n            }\r\n\r\n            parent = parent.parent;\r\n        }\r\n    }\r\n}","/**\r\n * 容器元素基类\r\n */\r\n\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { Istyle } from \"../core/style\";\r\nimport { findIndexByBinary } from \"../tool/util\";\r\nimport { Matrix } from \"../lib/matrix\";\r\n\r\nexport class Container extends Canvas2DElement {\r\n    readonly type: string = 'container';\r\n\r\n    children: Canvas2DElement[] = [];\r\n\r\n    get needUpdate() {\r\n        return this._needUpdate;\r\n    }\r\n\r\n    set needUpdate(needUpdate: boolean) {\r\n        if(needUpdate !== this._needUpdate) {\r\n            this._needUpdate = needUpdate;\r\n            if(needUpdate && !(this.isStatic && this._cached)) {\r\n                this.children.forEach(v => v.needUpdate = true);\r\n            }\r\n        }\r\n    }\r\n\r\n    attr(key: string | Istyle, value?: any){\r\n        if(typeof key === 'string') {\r\n            key = {[key]: value};\r\n        }\r\n\r\n        // 带边框的父元素的裁剪会影响子元素的鼠标拾取范围, 这里对其进行了简单处理\r\n        // 只要clip或border可能会改变时就清除所有子元素的拾取缓存\r\n        if(Reflect.has(key, 'clip') || Reflect.has(key, 'border')) {\r\n            this.children.forEach(v => v.checkedPoint.clear());\r\n        }\r\n\r\n        super.attr(key, value);\r\n\r\n        return this;\r\n    }\r\n\r\n    async build(ctx: CanvasRenderingContext2D){\r\n        await super.build(ctx);\r\n\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n        this.style.setAlpha(ctx);\r\n        if(this.style.clip){\r\n            ctx.clip();\r\n        }\r\n\r\n        return this._renderChildren(ctx);\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        const i = this.children.findIndex(v => v === el);\r\n        if(i >= 0){\r\n            el.parent = null;\r\n            this.children.splice(i, 1);\r\n\r\n            if(dispose) {\r\n                el.dispose();\r\n            }\r\n\r\n            this.markDirty();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        const parent = el.parent || el.layer;\r\n\r\n        if(parent !== this) {\r\n            if(parent){\r\n                parent.remove(el, false);\r\n            }\r\n            el.parent = this;\r\n            el.left = el.top = null;\r\n            el.needUpdate = true;\r\n\r\n            el.index = this.children.length;\r\n            const index = findIndexByBinary(\r\n                mid => el.style.zIndex - this.children[mid].style.zIndex || 1,\r\n                this.children.length\r\n            );\r\n            this.children.splice(index, 0, el);\r\n            this.markDirty();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(){\r\n        super.dispose();\r\n\r\n        this.children.forEach(v => {\r\n            v.parent = null;\r\n            v.dispose();\r\n        });\r\n        this.children.length = 0;\r\n    }\r\n\r\n    async buildCached(width: number, height: number, ctx: CanvasRenderingContext2D){\r\n        this.setChildrenProps('isStatic', false);\r\n        const invert = this.transform.invert();\r\n        const maxRect = (await this._getMaxRect()).transform(invert);\r\n\r\n        const sx = ctx.canvas.width / maxRect.w;\r\n        const sy = ctx.canvas.height / maxRect.h;\r\n\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = ctx.canvas.width;\r\n        canvas.height = ctx.canvas.height;\r\n\r\n        const cachedCtx = canvas.getContext('2d');\r\n        cachedCtx.scale(sx, sy);\r\n\r\n        const {a, b, c, d, e, f} = invert;\r\n        cachedCtx.transform(a, b, c, d, e - maxRect.x, f - maxRect.y);\r\n\r\n        cachedCtx.save();\r\n        this.setTransform(cachedCtx);\r\n        await this.build(cachedCtx);\r\n        cachedCtx.restore();\r\n\r\n        this._cachedTransform = new Matrix(1 / sx, 0, maxRect.x, 0, 1 / sy, maxRect.y);\r\n\r\n        return canvas;\r\n    }\r\n\r\n    getTarget(ctx: CanvasRenderingContext2D, x: number, y: number): false | Canvas2DElement {\r\n        for(let i=this.children.length - 1; i>=0; i--){\r\n            const traget = this.children[i].getTarget(ctx, x, y);\r\n\r\n            if(traget) {\r\n                return traget;\r\n            }\r\n        }\r\n\r\n        return this._contain(ctx, x, y) ? this : false;\r\n    }\r\n\r\n    setChildrenProps(key: string, value: any) {\r\n        this.children.forEach(v => {\r\n            Reflect.set(v, key, value);\r\n            if(v instanceof Container) {\r\n                v.setChildrenProps(key, value);\r\n            }\r\n        });\r\n    }\r\n\r\n    protected _renderChildren(ctx: CanvasRenderingContext2D): Promise<void> {\r\n        return new Promise(resolve => {\r\n            const _render = async (i: number) => {\r\n                const node = this.children[i++];\r\n                if(node){\r\n                    await node.draw(ctx);\r\n                    _render(i);\r\n                } else {\r\n                    resolve();\r\n                }\r\n            }\r\n\r\n            _render(0);\r\n        });\r\n    }\r\n\r\n    private async _getMaxRect() {\r\n        const rect = (await this.getBoundingRect()).clone();\r\n        for(const v of this.children) {\r\n            const other =  await (v instanceof Container ?  v._getMaxRect() :  v.getBoundingRect());\r\n            rect.extend(other);\r\n        }\r\n\r\n        return rect;\r\n    }\r\n}","/**\r\n * 图片节点\r\n */\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { Istyle } from \"../core/style\";\r\nimport { parseSize } from \"../core/dom\";\r\nimport { isZero } from \"../tool/util\";\r\n\r\nexport class Canvas2DImage extends Canvas2DElement {\r\n    readonly type: string = 'image';\r\n\r\n    private _cellId: number = -1;\r\n    private _cellWidth?: number | string;\r\n    private _cellHeight?: number | string;\r\n\r\n    constructor(id: string | number) {\r\n        super(id, false);\r\n\r\n        this.style.width = this.style.height = 0; // 清除默认宽高设置\r\n    }\r\n\r\n    attr(key: string | Istyle, value?: any) {\r\n        if(typeof key === 'string') {\r\n            key = {[key]: value};\r\n        }\r\n        this._setCell(key);\r\n        const modyfySrc = Reflect.has(key, 'src') && key.src !== this.style.src;\r\n\r\n        super.attr(key, value);\r\n        if(modyfySrc && !(this.style.width && this.style.height)) {\r\n            this.needUpdate = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    async build(ctx: CanvasRenderingContext2D) {\r\n        const img = await this.style.loadImg();\r\n        const sw: number = Math.min(parseSize(this._cellWidth, img.width), img.width),\r\n              sh: number = Math.min(parseSize(this._cellHeight, img.height), img.height);\r\n\r\n        if(this._cellId >= 0 && sw > 0 && sh > 0) { // 精灵图\r\n            const cw: number = Math.floor(this._cellId + 1) * sw;\r\n            let sx: number = (cw % img.width) - sw,\r\n                sy: number = Math.floor(cw / img.width) * sh;\r\n            if(isZero(cw % img.width)) {\r\n                sx = img.width - sw;\r\n                sy -= sh;\r\n            }\r\n            sx = Math.max(Math.min(sx, img.width - sw), 0);\r\n            sy = Math.max(Math.min(sy, img.height - sh), 0);\r\n\r\n            ctx.drawImage(img, sx, sy, sw, sh, 0, 0, this.width, this.height);\r\n        } else { // 整图\r\n            ctx.drawImage(img, 0, 0, this.width, this.height);\r\n        }\r\n    }\r\n\r\n    async update(){\r\n        this.style.background = '';\r\n        this.style.border = 0; // 图片没有边框，如果需要有，可使用Container的背景图\r\n        this.isStatic = false; // 图片本就有缓存，不需要再次缓存\r\n\r\n        return super.update();\r\n    }\r\n\r\n    async calcSize() {\r\n        await super.calcSize();\r\n\r\n        // 图片尺寸默认为其原尺寸\r\n        let img: HTMLImageElement;\r\n        if(this.width <= 0) {\r\n            img = await this.style.loadImg();\r\n            this.width = img.width;\r\n        }\r\n        if(this.height <= 0) {\r\n            img = img || await this.style.loadImg();\r\n            this.height = img.height;\r\n        }\r\n    }\r\n\r\n    private _setCell(data: Istyle) {\r\n        ['cellId', 'cellWidth', 'cellHeight'].forEach(k => {\r\n            if(Reflect.has(data, k)) {\r\n                Reflect.set(this, `_${k}`, Reflect.get(data, k));\r\n                Reflect.deleteProperty(data, k);\r\n            }\r\n        });\r\n    }\r\n}","/**\r\n * 文本相关\r\n */\r\nimport { cached } from \"../tool/util\";\r\nimport { getContext } from \"./dom\";\r\n\r\nexport const getWidth = cached((text: string, font: string) => {\r\n    return text.split('\\n').reduce((a, b) => Math.max(a, measureText(b, font)), 0);\r\n}, 5000);\r\n\r\nexport function getLineHeight(font: string){\r\n    return getWidth('国', font);\r\n}\r\n\r\nfunction measureText(text: string, font: string) {\r\n    var ctx = getContext(null);\r\n    if(font) {\r\n        ctx.font = font;\r\n    }\r\n\r\n    return ctx.measureText(text).width;\r\n};","/**\r\n * 文本\r\n * 解析文本性能消耗较大，大段文本尽可能使用静态文本\r\n */\r\n/// <reference path=\"./text.d.ts\" />\r\n\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { makeCheckExist } from \"../tool/util\";\r\nimport { getLineHeight, getWidth } from \"../core/text\";\r\n\r\n// ==================================================\r\n\r\nconst isFontStyle = makeCheckExist('fontStyle fontVariant fontWeight fontSize fontFamily');\r\nconst canModifyTextMap = makeCheckExist('lineHeight letterSpacing textWarp indent strokeWidth text');\r\n\r\n// ============================================\r\nexport class TextBlock extends Canvas2DElement {\r\n    readonly type: string = 'text';\r\n\r\n    text: string = '';\r\n    textMap: TextMap[] = [];\r\n\r\n    private _textAlign: TextAlign = 'left'; // 文本横向对齐\r\n    private _verticalAlign: VerticalAlign = 'top';// 文本垂直对齐\r\n\r\n    private _strokeColor?: string | CanvasGradient = '#000'; // 描边颜色\r\n    private _strokeWidth: number = 0; // 描边宽度\r\n    private _lineHeight: number = 0; // 行高\r\n    private _letterSpacing: number = 0; // 字间距\r\n    private _textWarp: TextWarp = 'warp'; // 是否换行\r\n    private _indent: number = 0;\r\n\r\n    private _font: string[] = [null, null, null, '12px', 'sans-serif']; // 文本设置\r\n\r\n    private _modifyText: boolean = false;\r\n\r\n    constructor(id: string | number, isStatic: boolean = true) {\r\n        super(id, isStatic);\r\n\r\n        this.style.height = 0; // 清除默认高设置\r\n        this.style.color = ''; // 默认使用父级颜色\r\n    }\r\n\r\n    set fontStyle(style: FontStyle) {\r\n        this._setFont(style, 0);\r\n    }\r\n\r\n    set fontVariant(style: 'normal' | 'small-caps') {\r\n        this._setFont(style, 1);\r\n    }\r\n\r\n    set fontWeight(style: FontWeight) {\r\n        if(typeof style === 'number') {\r\n            style = <FontWeight>`${style}`;\r\n        }\r\n\r\n        this._setFont(<string>style, 2);\r\n    }\r\n\r\n    set fontSize(style: number | string) {\r\n        if(typeof style === 'number') {\r\n            style = style + 'px';\r\n        }\r\n\r\n        this._setFont(style, 3);\r\n    }\r\n\r\n    set fontFamily(style: string) {\r\n        this._setFont(style, 4);\r\n    }\r\n\r\n    async build(ctx: CanvasRenderingContext2D) {\r\n        const last = this.textMap[this.textMap.length - 1];\r\n        if(last) {\r\n            await super.build(ctx);\r\n            ctx.clip();\r\n\r\n            ctx.textBaseline = 'top';\r\n            const color = this.style.color || (this.parent ? this.parent.style.color : '');\r\n            if(color) {\r\n                ctx.fillStyle = color;\r\n            }\r\n            if(this._strokeWidth) {\r\n                ctx.strokeStyle = this._strokeColor;\r\n            }\r\n\r\n            const font = this._font.filter(v => v != null && v !== '').join(' ');\r\n            if(font) {\r\n                ctx.font = font;\r\n            }\r\n\r\n            this.textMap.forEach(v => {\r\n                const x = this._adjustX(last, v);\r\n                const y = this._adjustY(last, v);\r\n                if(this._strokeWidth) {\r\n                    ctx.strokeText(v.char, x, y);\r\n                }\r\n                ctx.fillText(v.char, x, y);\r\n            })\r\n        }\r\n\r\n        if(this.isStatic) {\r\n            this.textMap.length = 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置文本样式\r\n     */\r\n    setTextStyle(key: string | TextStyle, value?: any) {\r\n        this._modifyText = false;\r\n        if(typeof key === 'string') {\r\n            this._setTextStyle([key, value]);\r\n        } else {\r\n            Object.entries(key).forEach(this._setTextStyle, this);\r\n        }\r\n\r\n        if(this._modifyText && !this.isStatic) {\r\n            if(\r\n                !this.style.height && this.style.top == null\r\n                || !this.style.width && this.style.left == null\r\n            ){\r\n                this.needUpdate = true;\r\n            } else if(!this.needUpdate){\r\n                this._parseText();\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    beforeUpdate() {\r\n        super.beforeUpdate();\r\n\r\n        this.style.border = 0;\r\n    }\r\n\r\n    async calcSize(){\r\n        await super.calcSize();\r\n\r\n        this._parseText();\r\n\r\n        // 高默认用文本高填充\r\n        if(this.height <= 0) {\r\n            this.height = 0;\r\n\r\n            const last = this.textMap[this.textMap.length - 1];\r\n            if(last) {\r\n                this.height = last.y + last.height;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _parseText() {\r\n        this.textMap.length = 0;\r\n\r\n        // 静态文本只解析一次\r\n        if(this.isStatic && this._cached) {\r\n            this.width = this._cached.width;\r\n            this.height = this._cached.height;\r\n            return;\r\n        }\r\n\r\n        if(this.text) {\r\n            const font = this._font.filter(v => v != null && v !== '').join(' ');\r\n            const lineHeight = (this._lineHeight || getLineHeight(font));\r\n\r\n            if(!this.style.width) {\r\n                this.width = Infinity;\r\n            }\r\n\r\n            const ellipsisWidth = getWidth('...', font);\r\n\r\n            const lines = this.text.replace(/\\n*$/, '').split('\\n');\r\n            const options = { y: 0, lineHeight, font, ellipsisWidth };\r\n\r\n            let maxWidth: number = 0;\r\n            for(const v of lines) {\r\n                this._setTextMap(v, options);\r\n\r\n                const last = this.textMap[this.textMap.length - 1];\r\n                if(last) {\r\n                    maxWidth = Math.max(maxWidth, last.x + last.width);\r\n                }\r\n\r\n                options.y += lineHeight;\r\n\r\n                if(this.height > 0 && options.y > this.height) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(this.width === Infinity) {\r\n                this.width = maxWidth;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _setTextMap(line: string, options: any) {\r\n        let width: number = 0;\r\n        if(!this.textMap.length) {\r\n            width += this._indent;\r\n        }\r\n\r\n        for(let i=0; i<line.length; i++) {\r\n            if(i) {\r\n                width += this._letterSpacing;\r\n            }\r\n\r\n            const textWidth = getWidth(line[i], options.font) + this._strokeWidth;\r\n            const textData = {\r\n                char: line[i],\r\n                x: width,\r\n                y: options.y,\r\n                width: textWidth,\r\n                height: options.lineHeight\r\n            }\r\n\r\n            width += textWidth;\r\n\r\n            if(width > this.width) {\r\n                if(this._textWarp === 'warp') {\r\n                    textData.x = 0;\r\n                    width = textWidth;\r\n                    textData.y += options.lineHeight;\r\n                    options.y += options.lineHeight;\r\n\r\n                    if(this.height > 0 && options.y > this.height){\r\n                        return;\r\n                    }\r\n                } else {\r\n                    return this._addEllipsis(textData, options.ellipsisWidth);\r\n                }\r\n            } else if(\r\n                this._textWarp === 'ellipsis'\r\n                && i < line.length - 1\r\n                && width + options.ellipsisWidth > this.width\r\n            ) {\r\n                return this._addEllipsis(textData, options.ellipsisWidth);\r\n            }\r\n\r\n            this.textMap.push(textData);\r\n        }\r\n    }\r\n\r\n    private _addEllipsis(textData: TextMap, ellipsisWidth: number) {\r\n        if(this._textWarp === 'ellipsis') {\r\n            textData.char = '...';\r\n            textData.width = ellipsisWidth;\r\n            this.textMap.push(textData);\r\n        }\r\n    }\r\n\r\n    private _setFont(style: string, index: number) {\r\n        const old = this._font[index];\r\n        if(style !== old) {\r\n            this._font[index] = style;\r\n\r\n            this._modifyText = true;\r\n            this.markDirty();\r\n        }\r\n    }\r\n\r\n    private _setTextStyle([key, value]: [string, any]) {\r\n        if(!isFontStyle(key)) {\r\n            const k = key === 'text' ? key : '_' + key;\r\n            if(typeof value === 'number') {\r\n                value *= devicePixelRatio;\r\n            }\r\n\r\n            if(Reflect.get(this, k) !== value) {\r\n                Reflect.set(this, k, value);\r\n\r\n                if(canModifyTextMap(key)) {\r\n                    this._modifyText = true;\r\n                }\r\n\r\n                this.markDirty();\r\n            }\r\n        } else {\r\n            (<any>this)[key] = value;\r\n        }\r\n    }\r\n\r\n    private _adjustX(last: TextMap, data: TextMap) {\r\n        const more = this.width - last.x - last.width;\r\n        if(more > 0 && data.y === last.y) {\r\n            if(this._textAlign === 'center') {\r\n                return data.x + more / 2;\r\n            }\r\n\r\n            if(this._textAlign === 'right') {\r\n                return data.x + more;\r\n            }\r\n        }\r\n\r\n        return data.x;\r\n    }\r\n\r\n    private _adjustY(last: TextMap, data: TextMap) {\r\n        const more = this.height - last.y - last.height;\r\n        if(more > 0) {\r\n            if(this._verticalAlign === 'middle') {\r\n                return data.y + more / 2;\r\n            }\r\n\r\n            if(this._verticalAlign === 'bottom') {\r\n                return data.y + more;\r\n            }\r\n        }\r\n\r\n        return data.y;\r\n    }\r\n}","import { line2hump } from \"../tool/util\";\n\n/**\n * 缓动代码来自 https://github.com/sole/tween.js/blob/master/src/Tween.js\n * 直接将zRender里的easing.js复制过来了\n */\n\nconst easing = {\n    // ===========================t^1\n    linear(k: number) {\n        return k;\n    },\n\n    // ===========================t^2\n    quadraticIn(k: number) {\n        return k * k;\n    },\n    quadraticOut(k: number) {\n        return k * (2 - k);\n    },\n    quadraticInOut(k: number) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k;\n        }\n        return -0.5 * (--k * (k - 2) - 1);\n    },\n\n    // ===========================t^3\n    cubicIn(k: number) {\n        return k * k * k;\n    },\n    cubicOut(k: number) {\n        return --k * k * k + 1;\n    },\n    cubicInOut(k: number) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k * k;\n        }\n        return 0.5 * ((k -= 2) * k * k + 2);\n    },\n\n    // ===========================t^4\n    quarticIn(k: number) {\n        return k * k * k * k;\n    },\n    quarticOut(k: number) {\n        return 1 - (--k * k * k * k);\n    },\n    quarticInOut(k: number) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k * k * k;\n        }\n        return -0.5 * ((k -= 2) * k * k * k - 2);\n    },\n\n    // ===========================t^5\n    quinticIn(k: number) {\n        return k * k * k * k * k;\n    },\n    quinticOut(k: number) {\n        return --k * k * k * k * k + 1;\n    },\n    quinticInOut(k: number) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k * k * k * k;\n        }\n        return 0.5 * ((k -= 2) * k * k * k * k + 2);\n    },\n\n    // ==============================正弦曲线的缓动（sin(t)）\n    sinusoidalIn(k: number) {\n        return 1 - Math.cos(k * Math.PI / 2);\n    },\n    sinusoidalOut(k: number) {\n        return Math.sin(k * Math.PI / 2);\n    },\n    sinusoidalInOut(k: number) {\n        return 0.5 * (1 - Math.cos(Math.PI * k));\n    },\n\n    // ==============================指数曲线的缓动（2^t）\n    exponentialIn(k: number) {\n        return k === 0 ? 0 : Math.pow(1024, k - 1);\n    },\n    exponentialOut(k: number) {\n        return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\n    },\n    exponentialInOut(k: number) {\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if ((k *= 2) < 1) {\n            return 0.5 * Math.pow(1024, k - 1);\n        }\n        return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\n    },\n\n    // ================================圆形曲线的缓动（sqrt(1-t^2)）\n    circularIn(k: number) {\n        return 1 - Math.sqrt(1 - k * k);\n    },\n    circularOut(k: number) {\n        return Math.sqrt(1 - (--k * k));\n    },\n    circularInOut(k: number) {\n        if ((k *= 2) < 1) {\n            return -0.5 * (Math.sqrt(1 - k * k) - 1);\n        }\n        return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\n    },\n\n    // ================================创建类似于弹簧在停止前来回振荡的动画\n    elasticIn(k: number) {\n        let s: number;\n        let a = 0.1;\n        const p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1;\n            s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / (2 * Math.PI);\n        }\n        return -(a * Math.pow(2, 10 * (k -= 1))\n                    * Math.sin((k - s) * (2 * Math.PI) / p));\n    },\n    elasticOut(k: number) {\n        let s: number;\n        let a = 0.1;\n        const p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1;\n            s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / (2 * Math.PI);\n        }\n        return (a * Math.pow(2, -10 * k)\n                    * Math.sin((k - s) * (2 * Math.PI) / p) + 1);\n    },\n    elasticInOut(k: number) {\n        let s: number;\n        let a = 0.1;\n        const p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1;\n            s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / (2 * Math.PI);\n        }\n        if ((k *= 2) < 1) {\n            return -0.5 * (a * Math.pow(2, 10 * (k -= 1))\n                * Math.sin((k - s) * (2 * Math.PI) / p));\n        }\n        return a * Math.pow(2, -10 * (k -= 1))\n                * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\n\n    },\n\n    // 在某一动画开始沿指示的路径进行动画处理前稍稍收回该动画的移动\n    backIn(k: number) {\n        const s = 1.70158;\n        return k * k * ((s + 1) * k - s);\n    },\n    backOut(k: number) {\n        const s = 1.70158;\n        return --k * k * ((s + 1) * k + s) + 1;\n    },\n    backInOut(k: number) {\n        const s = 1.70158 * 1.525;\n        if ((k *= 2) < 1) {\n            return 0.5 * (k * k * ((s + 1) * k - s));\n        }\n        return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n    },\n\n    // ======================创建弹跳效果\n    bounceIn(k: number) {\n        return 1 - easing.bounceOut(1 - k);\n    },\n    bounceOut(k: number) {\n        if (k < (1 / 2.75)) {\n            return 7.5625 * k * k;\n        }\n        else if (k < (2 / 2.75)) {\n            return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\n        }\n        else if (k < (2.5 / 2.75)) {\n            return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\n        }\n        else {\n            return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\n        }\n    },\n    bounceInOut(k: number) {\n        if (k < 0.5) {\n            return easing.bounceIn(k * 2) * 0.5;\n        }\n        return easing.bounceOut(k * 2 - 1) * 0.5 + 0.5;\n    }\n};\n\nexport function setEasing(name: string, fn: (x: number) => number) {\n    name = line2hump(name);\n    Reflect.set(easing, name, fn);\n}\n\nexport function getEasing(name: string) {\n    name = line2hump(name);\n\n    const fn = Reflect.get(easing, name);\n    if(typeof fn !== 'function') {\n        console.error(`缓动函数${name}不存在`);\n\n        return easing.linear\n    }\n\n    return fn;\n}","/**\r\n * 动画\r\n */\r\n\r\nimport { parseColor, stringify } from \"../tool/color\";\r\nimport { isImg } from \"../tool/util\";\r\nimport { Canvas2DElement } from \"../node/element\";\r\nimport { getEasing } from \"./easing\";\r\nimport { Canvas2DImage } from \"../node/image\";\r\n\r\ninterface AnimationAttr {\r\n    [key: string]: string | number | number[];\r\n}\r\n\r\ninterface AnimationFrame {\r\n    background?: string;\r\n    color?: string;\r\n\r\n    opacity?: number;\r\n\r\n    width?: number | string;\r\n    height?: number | string;\r\n\r\n    rotation?: number;\r\n\r\n    scaleX?: number;\r\n    scaleY?: number;\r\n    scale?: number | number[];\r\n\r\n    left?: number | string;\r\n    right?: number | string;\r\n    top?: number | string;\r\n    bottom?: number | string;\r\n\r\n    cellId?: number;\r\n}\r\n\r\nconst animationKey = [\r\n    'width', 'height', 'scaleX', 'scaleY', 'rotation', 'left','right',\r\n    'top', 'bottom', 'opacity', 'color', 'background', 'cellId'\r\n];\r\n\r\nexport class Canvas2DAnimation {\r\n    el: Map<Canvas2DElement, AnimationAttr> = new Map();\r\n\r\n    private _endCall: Set<Function> = new Set();\r\n\r\n    private _startTime: number = 0;\r\n    private _pauseTime: number = 0;\r\n    private _prevTime: number = 0;\r\n    private _isStart: boolean = false;\r\n    private _isPause: boolean = false;\r\n    private _timer?: number;\r\n\r\n    // ===================================可添加动画的属性\r\n    private width: AnimationAttr = {};\r\n    private height: AnimationAttr = {};\r\n    private scaleX: AnimationAttr = {};\r\n    private scaleY: AnimationAttr = {};\r\n    private rotation: AnimationAttr = {};\r\n    private left: AnimationAttr = {};\r\n    private right: AnimationAttr = {};\r\n    private top: AnimationAttr = {};\r\n    private bottom: AnimationAttr = {};\r\n    private opacity: AnimationAttr = {};\r\n    private color: AnimationAttr = {};\r\n    private background: AnimationAttr = {};\r\n    private cellId: AnimationAttr = {};\r\n\r\n    private errKey: Set<string> = new Set();\r\n\r\n    constructor(\r\n        public time: number = 0,\r\n        public count: number = 1,\r\n        public delay: number = 0,\r\n        public easing: string = 'linear'\r\n    ) {}\r\n\r\n    addFrame(frame: number | string, value: AnimationFrame, reWrite: boolean = true) {\r\n        this.errKey.clear();\r\n\r\n        frame = this._parseFrame(frame);\r\n        if(Reflect.has(value, 'scale')) {\r\n            const scale = Array.isArray(value.scale) ? value.scale : [value.scale, value.scale];\r\n            value.scaleX = scale[0];\r\n            value.scaleY = scale[1];\r\n        }\r\n\r\n        animationKey.forEach(k => {\r\n            let attr: any = Reflect.get(value, k);\r\n            const thisAttr = Reflect.get(this, k);\r\n            if(attr !== '' && (reWrite || !Reflect.has(thisAttr, frame))) {\r\n                if(typeof attr === 'number' || typeof attr === 'string') {\r\n                    if(k === 'color' || k === 'background') {\r\n                        attr = parseColor(attr);\r\n                    }\r\n\r\n                    Reflect.set(thisAttr, frame, attr);\r\n                } else if(attr != null){\r\n                    console.warn('只能用number及string类型设置动画');\r\n                }\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    addElement(el: Canvas2DElement) {\r\n        if(!this.el.has(el)) {\r\n            const style = el.style;\r\n            const attr: AnimationAttr = {\r\n                width: style.width,\r\n                height: style.height,\r\n                rotation: style.rotation,\r\n                left: style.left,\r\n                right: style.right,\r\n                top: style.top,\r\n                bottom: style.bottom,\r\n                opacity: style.opacity,\r\n                scaleX: style.scale[0],\r\n                scaleY: style.scale[1],\r\n            };\r\n            if(typeof style.color === 'string') {\r\n                attr.color = parseColor(style.color);\r\n            }\r\n            if(typeof style.background === 'string' && !isImg(style.background)) {\r\n                attr.background = parseColor(style.background);\r\n            }\r\n            if(el instanceof Canvas2DImage) {\r\n                attr.cellId = 0;\r\n            }\r\n            this.el.set(el, attr);\r\n            if(el.animation !== this) {\r\n                el.animation = this;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    addEndCall(fn: Function) {\r\n        this._endCall.add(fn);\r\n\r\n        return this;\r\n    }\r\n    removeEndCall(fn: Function) {\r\n        this._endCall.delete(fn);\r\n\r\n        return this;\r\n    }\r\n    dispose(){\r\n        if(this._timer) {\r\n            cancelAnimationFrame(this._timer);\r\n        }\r\n        this._endCall.clear();\r\n\r\n        this.el.forEach(v => v.animation = null);\r\n        this.el.clear();\r\n    }\r\n\r\n    start(now: number = Date.now()) {\r\n        if(!this._isStart) {\r\n            this.stop();\r\n\r\n            this._startTime = now + this.delay;\r\n            this._isStart = true;\r\n            this._pauseTime = this._prevTime = 0;\r\n\r\n            this._play();\r\n        }\r\n\r\n        this._isPause = false;\r\n    }\r\n\r\n    pause() {\r\n        this._isPause = true;\r\n    }\r\n\r\n    stop() {\r\n        this._isStart = this._isPause = false;\r\n        if(this._timer) {\r\n            cancelAnimationFrame(this._timer);\r\n        }\r\n    }\r\n\r\n    notify() {\r\n        this._endCall.forEach(fn => fn());\r\n    }\r\n\r\n    private _end() {\r\n        this.stop();\r\n        this.notify();\r\n\r\n        if(--this.count > 0) {\r\n            this.start();\r\n        }\r\n    }\r\n\r\n    private _play() {\r\n        if(this._isStart && this.el.size) {\r\n            const now = Date.now();\r\n\r\n            if(now >= this._startTime) {\r\n                const progress = Math.min(1, (now - this._startTime - this._pauseTime) / this.time);\r\n\r\n                if(!this._isPause) {\r\n                    for(const [e, v] of this.el.entries()) {\r\n                        if(e.animation === this) {\r\n                            e.attr(this._getAttr(progress, v))\r\n                        } else {\r\n                            this.el.delete(e);\r\n                        }\r\n                    }\r\n                } else {\r\n                    this._pauseTime += now - this._prevTime;\r\n                }\r\n                if(now - this._startTime - this._pauseTime > this.time) {\r\n                    return this._end();\r\n                }\r\n                this._prevTime = now;\r\n            }\r\n\r\n            this._timer = requestAnimationFrame(() => this._play());\r\n        }\r\n    }\r\n\r\n    private _getAttr(progress: number, zeroFrame: AnimationAttr) {\r\n        const attr: AnimationFrame = {};\r\n\r\n        animationKey.forEach(k => {\r\n            const thisAttr: any = {...Reflect.get(this, k)};\r\n            thisAttr[0] = thisAttr[0] == null ? Reflect.get(zeroFrame, k) : thisAttr[0];\r\n\r\n            const frames = Object.keys(thisAttr).sort((a, b) => +a - +b);\r\n            const frame = frames.findIndex(v => +v >= progress);\r\n\r\n            let value = thisAttr[frames[frame]];\r\n            if(value != null) {\r\n                let prev = thisAttr[frames[frame - 1]];\r\n                const type1 = typeof value;\r\n                const type2 = typeof prev;\r\n                if(type1 === type2) {\r\n                    let rate = 1 - (+frames[frame] - progress) / (+frames[frame] - +frames[frame - 1]);\r\n                    rate = getEasing(this.easing)(rate);\r\n\r\n                    if(Array.isArray(value)) { // color、background\r\n                        value = value.map((v, i) => (v - prev[i]) * rate +  prev[i]);\r\n                    } else if(type1 === 'number'){\r\n                        value = (value - prev) * rate + prev;\r\n                    } else if(type1 === 'string') {\r\n                        let reg = /^([\\+-]?\\d+)(.*)$/;\r\n                        if(reg.test(value)) {\r\n                            value = value.replace(reg, (_: string, v: string, s: string) => {\r\n                                let prevValue = +parseFloat(prev);\r\n\r\n                                reg = new RegExp(`^[\\\\+-]?\\\\d+${s}$`);\r\n                                if(!reg.test(prev)) {\r\n                                    this._warnOnce(k);\r\n                                    prevValue = 0;\r\n                                }\r\n\r\n                                return (+v - prevValue) * rate + prevValue + s;\r\n                            });\r\n                        } else {\r\n                            value = 0;\r\n                        }\r\n                    }\r\n                } else if(type2 !== 'undefined'){\r\n                    this._warnOnce(k);\r\n                }\r\n\r\n                if(Array.isArray(value)) {\r\n                    value = stringify(value, 'rgba');\r\n                }\r\n                Reflect.set(attr, k, value);\r\n            }\r\n        });\r\n\r\n        return attr;\r\n    }\r\n\r\n    private _parseFrame(frame: number | string) {\r\n        let res: number;\r\n        if(typeof frame === 'string') {\r\n            res = parseFloat(frame) || 0;\r\n            if(frame.endsWith('%')) {\r\n                res /= 100;\r\n            }\r\n        } else {\r\n            res = frame;\r\n        }\r\n\r\n        return Math.max(0, Math.min(res, 1));\r\n    }\r\n\r\n    private _warnOnce(key: string) {\r\n        if(!this.errKey.has(key)) {\r\n            console.error(`对属性${key}的设置存在类型不一样的设置`);\r\n            this.errKey.add(key);\r\n        }\r\n    }\r\n}","/**\r\n * 堆栈式容器\r\n * 垂直排列时-子元素top/bottom为其上下间隙\r\n * 横向排列时-子元素left/right为其左右间隙\r\n */\r\nimport { Container } from \"./container\";\r\nimport { parseSize } from \"../core/dom\";\r\nimport { Canvas2DElement } from \"./element\";\r\n\r\nexport class Stack extends Container {\r\n    readonly type: string = 'stack';\r\n\r\n    private _isVertical: boolean = true; // 是否是垂直排列\r\n\r\n    constructor(id: number | string, isStatic?: boolean) {\r\n        super(id, isStatic);\r\n\r\n        this.style.width = this.style.height = 0;\r\n    }\r\n\r\n    get isVertical() {\r\n        return this._isVertical;\r\n    }\r\n\r\n    set isVertical(isVertical: boolean) {\r\n        if(isVertical !== this._isVertical) {\r\n            this._isVertical = isVertical;\r\n            this.needUpdate = true;\r\n        }\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        super.remove(el, dispose);\r\n        if(!(this.style.width && this.style.height)) {\r\n            this.needUpdate = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        super.add(el);\r\n        if(!(this.style.width && this.style.height)) {\r\n            this.needUpdate = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    async calcSize() {\r\n        await super.calcSize();\r\n\r\n        let sizeKey: 'height' | 'width' = 'height';\r\n        let otherSizeKey: 'height' | 'width' = 'width'\r\n        let positionKey: 'left' | 'top' = 'top';\r\n        if(!this._isVertical) {\r\n            sizeKey = 'width';\r\n            positionKey = 'left';\r\n            otherSizeKey = 'height';\r\n        }\r\n        const oldSize = this[sizeKey];\r\n        this[sizeKey] = this.getParentSize(sizeKey);\r\n\r\n        const [size, max] = await this._calcSize(sizeKey, positionKey, otherSizeKey);\r\n\r\n        this[sizeKey] = oldSize || size;\r\n        this[otherSizeKey] = this[otherSizeKey] || max;\r\n    }\r\n\r\n    private async _calcSize(\r\n        sizeKey: 'height' | 'width',\r\n        positionKey: 'left' | 'top',\r\n        otherSizeKey: 'height' | 'width'\r\n    ) {\r\n        let size: number = 0;\r\n        let max: number = 0;\r\n        const positionOtherKey: 'right' | 'bottom' = positionKey === 'left' ? 'right' : 'bottom';\r\n\r\n        for(const v of Array.from(this.children).sort((a, b) => a.index - b.index)){\r\n            size += parseSize(v.style[positionKey], 0);\r\n            v[positionKey] = size;\r\n\r\n            await v.calcSize();\r\n            size += v[sizeKey] + parseSize(v.style[positionOtherKey], 0);\r\n            max = Math.max(max, v[otherSizeKey]);\r\n\r\n            v.isVisible = v[sizeKey] ? v.isVisible : false;\r\n        }\r\n\r\n        return [size, max];\r\n    }\r\n}","/**\r\n * 单向可滚动容器\r\n */\r\nimport { Container } from \"./container\";\r\nimport { Stack } from \"./stack\";\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { IGuiEvent } from \"../core/event\";\r\nimport { addHandler, removeHandler } from \"../core/dom\";\r\n\r\nexport class Scroll extends Container {\r\n    readonly type: string = 'scroll';\r\n\r\n    children: Stack[] = [];\r\n    move: number = 0; // 移动距离, [-this._maxMove, 0]\r\n    more: number = 10; // 回弹效果\r\n\r\n    private _isVertical: boolean = true; // 是否是垂直排列\r\n    private _isDown: boolean = false;\r\n    private _downPoint: number = 0;\r\n    private _maxMove: number = 0;\r\n\r\n    constructor(id: number | string, isStatic?: boolean) {\r\n        super(id, isStatic);\r\n        super.add(new Stack(`__scroll__${id}`).attr('zIndex', -Number.MAX_VALUE));\r\n\r\n        this.event.on('mousedown', this._downCall);\r\n        this.event.on('mousemove', this._moveCall);\r\n\r\n        this.event.on('touchstart', this._downCall);\r\n        this.event.on('touchmove', this._moveCall);\r\n\r\n        addHandler(document, 'mouseup', this._upCall);\r\n        addHandler(document, 'touchend', this._upCall);\r\n    }\r\n\r\n    get isVertical() {\r\n        return this._isVertical;\r\n    }\r\n\r\n    set isVertical(isVertical: boolean) {\r\n        if(isVertical !== this._isVertical) {\r\n            this._isVertical = isVertical;\r\n            this.move = 0;\r\n            this.needUpdate = true;\r\n            this.children[0].isVertical = isVertical;\r\n        }\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        this.children[0].remove(el, dispose);\r\n\r\n        return this;\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        this.children[0].add(el);\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(){\r\n        super.dispose();\r\n\r\n        removeHandler(document, 'mouseup', this._upCall);\r\n        removeHandler(document, 'touchend', this._upCall);\r\n    }\r\n\r\n    beforeUpdate() {\r\n        super.beforeUpdate();\r\n\r\n        this.style.clip = true;\r\n\r\n        this.children.length = 1;\r\n        this.children[0].style[this._isVertical ? 'top' : 'left'] = this.move;\r\n        this.children[0].isVertical = this._isVertical;\r\n        this.children[0].isStatic = this.isStatic;\r\n        this.isStatic = false;\r\n    }\r\n\r\n    getTarget(ctx: CanvasRenderingContext2D, x: number, y: number): false | Canvas2DElement {\r\n        const target = super.getTarget(ctx, x, y);\r\n\r\n        return target === this.children[0] ? this : target;\r\n    }\r\n\r\n    private _downCall(guiEvent: IGuiEvent) {\r\n        this._isDown = true;\r\n        this._downPoint = this._isVertical ? guiEvent.y : guiEvent.x;\r\n    }\r\n\r\n    private _moveCall(guiEvent: IGuiEvent, event: MouseEvent) {\r\n        if(this._isDown) {\r\n            if(event.preventDefault){\r\n                event.preventDefault();\r\n            }else{\r\n                event.returnValue = false;\r\n            }\r\n\r\n            const now = this._isVertical ? guiEvent.y : guiEvent.x;\r\n            const diff = now - this._downPoint;\r\n\r\n            const sizeKey: 'height' | 'width' = this._isVertical ? 'height' : 'width';\r\n            this._maxMove = this.children[0][sizeKey] - this[sizeKey] + this.style.border * 2;\r\n\r\n            if(Math.abs(diff) > 1e-3 && this._maxMove >= 1) {\r\n                this.move += diff;\r\n                this.move = Math.min(this.more, Math.max(this.move, -this._maxMove - this.more));\r\n\r\n                this.needUpdate = true;\r\n                this.markDirty();\r\n            }\r\n        }\r\n    }\r\n\r\n    private _upCall = () => {\r\n        this._isDown = false;\r\n\r\n        if(this.move > 0 || this.move < -this._maxMove) {\r\n            this.move = Math.min(0, Math.max(this.move, -this._maxMove));\r\n            this.needUpdate = true;\r\n            this.markDirty();\r\n        }\r\n    }\r\n}","export { Layer } from \"./layer\";\r\nexport { Engine } from \"./engine\";\r\nexport { Canvas2DElement } from \"./node/element\";\r\nexport { Container } from \"./node/container\";\r\nexport { Canvas2DImage } from \"./node/image\";\r\nexport { TextBlock } from \"./node/text\";\r\nexport { Canvas2DAnimation } from './animation/animation';\r\nexport { Stack } from \"./node/stack\";\r\nexport { Scroll } from \"./node/scroll\";"],"sourceRoot":""}