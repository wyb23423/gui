{"version":3,"sources":["webpack://WsGui/webpack/universalModuleDefinition","webpack://WsGui/webpack/bootstrap","webpack://WsGui/./src/assets/1.jpg","webpack://WsGui/./src/animation/play.worker.ts","webpack://WsGui/./node_modules/worker-loader/dist/workers/InlineWorker.js","webpack://WsGui/./node_modules/tslib/tslib.es6.js","webpack://WsGui/./src/tool/util.ts","webpack://WsGui/./src/config.ts","webpack://WsGui/./src/core/dom.ts","webpack://WsGui/./src/lib/transform.ts","webpack://WsGui/./src/lib/matrix.ts","webpack://WsGui/./src/core/bounding_rect.ts","webpack://WsGui/./src/core/resource.ts","webpack://WsGui/./src/tool/color.ts","webpack://WsGui/./src/core/style.ts","webpack://WsGui/./src/core/event.ts","webpack://WsGui/./src/tool/paint.ts","webpack://WsGui/./src/lib/vector.ts","webpack://WsGui/./src/node/element.ts","webpack://WsGui/./src/node/container.ts","webpack://WsGui/./src/layer.ts","webpack://WsGui/./src/engine.ts","webpack://WsGui/./src/node/image.ts","webpack://WsGui/./src/core/text.ts","webpack://WsGui/./src/node/text.ts","webpack://WsGui/./src/animation/animation.ts","webpack://WsGui/./src/core/path.ts","webpack://WsGui/./src/node/stack.ts","webpack://WsGui/./src/node/scroll.ts","webpack://WsGui/./src/lib/bezier.ts","webpack://WsGui/./src/lib/bbox.ts","webpack://WsGui/./src/node/path.ts","webpack://WsGui/./src/index.ts"],"names":["root","factory","exports","module","define","amd","WsGui","this","r","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","e","URL","window","webkitURL","content","url","blob","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","Blob","Worker","createObjectURL","encodeURIComponent","Error","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","constructor","__assign","assign","arguments","length","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","throw","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","return","iterator","v","op","TypeError","pop","push","__values","__read","ar","error","__spread","concat","cached","fn","maxSize","cache","Map","arg","_i","join","has","size","delete","keys","set","imgReg","isImg","str","test","startsWith","makeCheckExist","ignore","split","map","toLowerCase","k","includes","isZero","val","Number","EPSILON","findIndexByBinary","compare","len","low","high","mid","res","Math","floor","replace","w","toUpperCase","line","num","ids","Set","createId","id","Date","now","toString","padStart","add","devicePixelRatio","max","dom_id","createCanvas","h","canvas","document","createElement","style","position","left","top","width","height","setAttribute","getContext","parseSize","base","endsWith","parseFloat","addHandler","element","type","handler","addEventListener","attachEvent","removeHandler","removeEventListener","detachEvent","Transform","transform","copy","source","rotate","rotation","cos","sin","scale","sx","sy","isArray","translate","x","matrix_Matrix","_super","Matrix","a","_this","toUnit","toArray","isRight","thisArr","right","invert","det","BoundingRect","extend","other","min","minX","minY","maxX","maxY","mArr","MAX_VALUE","contain","intersect","ax0","ax1","ay0","ay1","clone","DEFAULT_SRC","getImg","path","isFirst","data","count","image","img","Image","src","onload","onerror","disposeImg","kCSSColorTable","transparent","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","clampCssByte","round","clampCssFloat","parseCssInt","charAt","parseInt","parseCssFloat","cssHueToRgb","m1","m2","hsla2rgba","hsla","rgba","err","console","parseColor","colorStr","iv","Reflect","from","substr","indexOf","ep","fname","params","alpha","color_isEqual","arr1","arr2_1","every","isTransformKey","style_Style","Style","color","border","borderColor","borderStyle","opacity","zIndex","clip","origin","_res","attr","entries","build","ctx","setLineDash","strokeStyle","lineWidth","background","loadImg","_a","pattern","createPattern","setTransform","fillStyle","setAlpha","globalAlpha","dispose","forEach","clear","equal","old","warn","_b","isModifyTransform","arrColor","fill","EventFul","_handlers","on","off","handlers","notify","event","guiEvent","context","cancelBubble","ellipse","cx","cy","rx","ry","startAngle","endAngle","anticlockwise","abs","pow","save","scaleX","scaleY","arc","restore","buildPath","borderRadius","radius","beginPath","moveTo","PI","lineTo","rect","closePath","vector_Vector2","Vector2","createMin","createMax","toMin","toMax","element_Canvas2DElement","Canvas2DElement","isStatic","index","events","isVisible","_needUpdate","_hadCalc","_parentWidth","_parentHeight","_ignore","_dirty","_checkedPoint","needUpdate","_animation","animation","el","addElement","layer","remove","parent","_cached","draw","beforeUpdate","getBoundingRect","_c","afterUpdate","isPaint","beforeBuild","buildCached","drawImage","afterBuild","isEqual","_d","_e","markDirty","update","dirty","notifyEvent","skip","_getBaseSize","calcSize","updateTransform","stroke","bottom","parent_1","start","cachedCtx","getTarget","_contain","getParentSize","clipParent","getParent","parent_2","pk","isPointInPath","filter","container_Container","Container","children","_start","configurable","_renderChildren","findIndex","splice","maxRect","_getMaxRect","traget","_render","node","isStaic","_updateChildren","layer_Layer","Layer","z","roots","_time","_drawCanvas","_view","dom","removeChild","beforeRender","render","clearRect","afterRender","resize","_resize","_clearCached","eventNames","engine_Engine","Engine","_root","_layers","_isOut","_eventHandler","offsetX","offsetY","getBoundingClientRect","clientX","clientY","touches","target","_getTarget","_moveHandler","_leave","_enter","-webkit-tap-highlight-color","-webkit-user-select","user-select","-webkit-touch-callout","touch-action","innerHTML","offsetWidth","offsetHeight","getLayer","_timer","requestAnimationFrame","addLayer","_addLayerToDom","replaceLayer","removeLayer","curLayer","cancelAnimationFrame","_preTarget","values","insertBefore","appendChild","layers","sort","layers_1","layers_1_1","relatedTarget","image_Canvas2DImage","Canvas2DImage","_cellId","_setCell","modyfySrc","sw","_cellWidth","sh","_cellHeight","cw","deleteProperty","getWidth","text","font","reduce","measureText","isFontStyle","canModifyTextMap","text_TextBlock","TextBlock","textMap","_textAlign","_verticalAlign","_strokeColor","_strokeWidth","_lineHeight","_letterSpacing","_textWarp","_indent","_font","_modifyText","_setFont","symbol","last","textBaseline","_adjustX","_adjustY","strokeText","char","fillText","setTextStyle","_setTextStyle","_parseText","lineHeight","Infinity","ellipsisWidth","lines","options","maxWidth","lines_1","lines_1_1","_setTextMap","textWidth","textData","_addEllipsis","more","animationKey","worker","construct","animations","message","terminate","CMD","animation_Canvas2DAnimation","Canvas2DAnimation","time","delay","easing","animation_id","_endCall","_startTime","_pauseTime","_prevTime","_isStart","_isPause","cellId","errKey","addFrame","frame","reWrite","_parseFrame","thisAttr","addEndCall","removeEndCall","stop","_play","pause","msg","attrs","isEnd","_end","postMessage","_createMsg","stack_Stack","Stack","_isVertical","isVertical","sizeKey","otherSizeKey","positionKey","oldSize","_calcSize","positionOtherKey","children_1","children_1_1","scroll_Scroll","Scroll","_this_1","move","maxMove","_isDown","_downPoint","_upCall","_downCall","_moveCall","stack","_setBuild","preventDefault","returnValue","diff","sizeKey_1","_this_2","YHTriangle","trunc","mi","slice","j","bezier","cubicExtrema","p0","p1","p2","p3","extremum","t1","disc","discSqrt","sqrt","t2","quadraticExtremum","divider","bbox_line","x1","y1","x2","y2","cubic","x0","y0","x3","y3","PI2","tmp","angle","M","L","C","Q","A","Z","R","path_Path","Path","lineDash","_len","_ctx","addData","bezierCurveTo","quadraticCurveTo","setData","Float32Array","appendPath","appendSize","xi","yi","min1","max1","isStart","rebuildPath","_expandData","toStatic","newData","node_path_Path","_path","rectPath","__webpack_exports__"],"mappings":"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","file":"ws-gui.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WsGui\"] = factory();\n\telse\n\t\troot[\"WsGui\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","module.exports = __webpack_public_path__ + \"assets/1.c820cfde.jpg\";","module.exports = function() {\n  return require(\"!!E:\\\\www\\\\gui\\\\node_modules\\\\worker-loader\\\\dist\\\\workers\\\\InlineWorker.js\")(\"!function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\\\"undefined\\\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\\\"Module\\\"}),Object.defineProperty(e,\\\"__esModule\\\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\\\"object\\\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\\\"default\\\",{enumerable:!0,value:e}),2&r&&\\\"string\\\"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\\\"a\\\",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p=\\\"\\\",t(t.s=0)}([function(e,r,t){\\\"use strict\\\";t.r(r);var n=function(){return(n=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var a in r=arguments[t])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};function a(e,r){var t=\\\"function\\\"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,a,u=t.call(e),i=[];try{for(;(void 0===r||0<r--)&&!(n=u.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(t=u.return)&&t.call(u)}finally{if(a)throw a.error}}return i}function u(e,r){var t=new Map;return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var u=n.join(\\\":\\\");return t.has(u)||(r&&t.size>=r&&t.delete(t.keys().next().value),t.set(u,e.apply(null,n))),t.get(u)}}var i=u(function(e){return e.replace(/[-_]+(\\\\w)/g,function(e,r){return r.toUpperCase()})});u(function(e,r){return void 0===r&&(r=\\\"-\\\"),e.replace(/[A-Z]/g,function(e){return r+e.toLowerCase()})}),new Set;\\\"constructor prototype name\\\".split(\\\" \\\");var o={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(e){return(e=Math.round(e))<0?0:255<e?255:e}function c(e){return e<0?0:1<e?1:e}function s(e){return e.length&&\\\"%\\\"===e.charAt(e.length-1)?l(parseFloat(e)/100*255):l(parseInt(e,10))}function f(e){return e.length&&\\\"%\\\"===e.charAt(e.length-1)?c(parseFloat(e)/100):c(parseFloat(e))}function d(e,r,t){return t<0?t+=1:1<t&&(t-=1),6*t<1?e+(r-e)*t*6:2*t<1?r:3*t<2?e+(r-e)*(2/3-t)*6:e}function h(e){var r=(parseFloat(e[0])%360+360)%360/360,t=f(e[1]),n=f(e[2]),a=n<=.5?n*(t+1):n+t-n*t,u=2*n-a,i=[l(255*d(u,a,r+1/3)),l(255*d(u,a,r)),l(255*d(u,a,r-1/3)),1];return 4===e.length&&(i[3]=+e[3]),i}function g(e){return console.error(e+\\\"不是有效的ccs颜色值\\\"),[0,0,0,0]}u(function(e){if(\\\"string\\\"!=typeof e||!e)return g(e);var r,t=e.replace(/ /g,\\\"\\\").toLowerCase();if(Reflect.has(o,t))return Array.from(Reflect.get(o,t));if(t.startsWith(\\\"#\\\"))return 4===t.length?0<=(r=parseInt(t.substr(1),16))&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:g(t):7===t.length&&0<=(r=parseInt(t.substr(1),16))&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:g(t);var n=t.indexOf(\\\"(\\\"),a=t.indexOf(\\\")\\\");if(-1!==n&&a+1===t.length){var u=t.substr(0,n),i=t.substr(n+1,a-(n+1)).split(\\\",\\\"),l=1;switch(u){case\\\"rgba\\\":if(4!==i.length)return g(t);l=f(i.pop());case\\\"rgb\\\":return 3!==i.length?g(t):[s(i[0]),s(i[1]),s(i[2]),l];case\\\"hsla\\\":return 4!==i.length?g(t):(i[3]=f(i[3])+\\\"\\\",h(i));case\\\"hsl\\\":return 3!==i.length?g(t):h(i)}}return g(t)},500);var p={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var r,t=.1;return 0===e?0:1===e?1:(r=!t||t<1?(t=1,.1):.4*Math.asin(1/t)/(2*Math.PI),-t*Math.pow(2,10*(e-=1))*Math.sin((e-r)*(2*Math.PI)/.4))},elasticOut:function(e){var r,t=.1;return 0===e?0:1===e?1:(r=!t||t<1?(t=1,.1):.4*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*e)*Math.sin((e-r)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var r,t=.1;return 0===e?0:1===e?1:(r=!t||t<1?(t=1,.1):.4*Math.asin(1/t)/(2*Math.PI),(e*=2)<1?t*Math.pow(2,10*(e-=1))*Math.sin((e-r)*(2*Math.PI)/.4)*-.5:t*Math.pow(2,-10*(e-=1))*Math.sin((e-r)*(2*Math.PI)/.4)*.5+1)},backIn:function(e){return e*e*(2.70158*e-1.70158)},backOut:function(e){return--e*e*(2.70158*e+1.70158)+1},backInOut:function(e){var r=2.5949095;return(e*=2)<1?e*e*((r+1)*e-r)*.5:.5*((e-=2)*e*((r+1)*e+r)+2)},bounceIn:function(e){return 1-p.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*p.bounceIn(2*e):.5*p.bounceOut(2*e-1)+.5}};self.addEventListener(\\\"message\\\",function(e){var r=e.data,t=r.animation,n=function(e,r){var t,n,u={animation:e,isEnd:!1,attrs:new Map},i=Math.min(1,(r-e._startTime-e._pauseTime)/e.time);if(e._isPause)e._pauseTime+=r-e._prevTime;else try{for(var o=function(e){var r=\\\"function\\\"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}(e.el.entries()),l=o.next();!l.done;l=o.next()){var c=a(l.value,2),s=c[0],f=c[1];u.attrs.set(s,b(i,f,e))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r-e._startTime-e._pauseTime>e.time?(u.isEnd=!0,u):(e._prevTime=r,u)}(t,r.now);Reflect.deleteProperty(t,\\\"el\\\"),self.postMessage(n)});var y=[\\\"width\\\",\\\"height\\\",\\\"scaleX\\\",\\\"scaleY\\\",\\\"rotation\\\",\\\"left\\\",\\\"right\\\",\\\"top\\\",\\\"bottom\\\",\\\"opacity\\\",\\\"color\\\",\\\"background\\\",\\\"cellId\\\"];function b(e,r,t){var a={},u=function(e){e=i(e);var r=Reflect.get(p,e);return\\\"function\\\"!=typeof r?(console.error(\\\"缓动函数\\\"+e+\\\"不存在\\\"),p.linear):r}(t.easing);return y.forEach(function(i){var o=n({},Reflect.get(t,i));o[0]=null==o[0]?Reflect.get(r,i):o[0];var l=Object.keys(o).sort(function(e,r){return+e-+r}),c=l.findIndex(function(r){return e<=+r}),s=o[l[c]];if(null!=s){var f=o[l[c-1]],d=typeof s,h=typeof f;if(d===h){var g=1-(+l[c]-e)/(+l[c]-+l[c-1]);if(g=u(g),Array.isArray(s))s=s.map(function(e,r){return(e-f[r])*g+f[r]});else if(\\\"number\\\"===d)s=(s-f)*g+f;else if(\\\"string\\\"===d){var p=/^([\\\\+-]?\\\\d+)(.*)$/;s=p.test(s)?s.replace(p,function(e,r,n){var a=+parseFloat(f);return(p=new RegExp(\\\"^[\\\\\\\\+-]?\\\\\\\\d+\\\"+n+\\\"$\\\")).test(f)||(m(i,t),a=0),(+r-a)*g+a+n}):0}}else\\\"undefined\\\"!==h&&m(i,t);Array.isArray(s)&&(s=function(e,r){if(e&&e.length){var t=e[0]+\\\",\\\"+e[1]+\\\",\\\"+e[2];return r+\\\"(\\\"+(t+=\\\",\\\"+e[3])+\\\")\\\"}}(s,\\\"rgba\\\")),Reflect.set(a,i,s)}}),a}function m(e,r){r.errKey.has(e)||(console.error(\\\"对属性\\\"+e+\\\"的设置存在类型不一样的设置\\\"),r.errKey.add(e))}}]);\\n//# sourceMappingURL=play.worker.d064b1d6.js.map\", \"worker\" + \"worker/play.worker.d064b1d6.js\");\n};","'use strict';\n\n// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\n\nvar URL = window.URL || window.webkitURL;\n\nmodule.exports = function (content, url) {\n  try {\n    try {\n      var blob;\n\n      try {\n        // BlobBuilder = Deprecated, but widely implemented\n        var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n\n        blob = new BlobBuilder();\n\n        blob.append(content);\n\n        blob = blob.getBlob();\n      } catch (e) {\n        // The proposed API\n        blob = new Blob([content]);\n      }\n\n      return new Worker(URL.createObjectURL(blob));\n    } catch (e) {\n      return new Worker('data:application/javascript,' + encodeURIComponent(content));\n    }\n  } catch (e) {\n    if (!url) {\n      throw Error('Inline worker is not supported');\n    }\n\n    return new Worker(url);\n  }\n};","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { join } from \"path\";\r\n\r\n/// <reference lib=\"es2017.object\" />\r\n\r\n/**\r\n * 创建一个纯函数的缓存版本\r\n */\r\nexport function cached<T>(fn: (...arg: any[]) => T, maxSize?: number): (...arg: any[]) => T {\r\n    const cache:Map<any, any> = new Map();\r\n\r\n    return (...arg: any[]) => {\r\n        const key = arg.join(':');\r\n\r\n        if(!cache.has(key)) {\r\n            if(maxSize && cache.size >= maxSize) {\r\n                cache.delete(cache.keys().next().value);\r\n            }\r\n            cache.set(key, fn.apply(null, arg));\r\n        }\r\n\r\n        return cache.get(key);\r\n    }\r\n}\r\n\r\n/**\r\n * 深复制对象\r\n */\r\nexport function clone(obj: any){\r\n    if(typeof obj === 'object' && obj !== null){\r\n        let res: any;\r\n\r\n        if(obj instanceof Map){\r\n            res = new Map();\r\n            obj.forEach((v, k) => res.set(k, clone(v)));\r\n        } else if(obj instanceof Set) {\r\n            res = new Set();\r\n            obj.forEach(v => res.add(clone(v)));\r\n        } else if(Array.isArray(obj)){\r\n            res = obj.map(clone);\r\n        } else {\r\n            res = {};\r\n            for(let [k, v] of Object.entries(obj)){\r\n                res[k] = clone(v);\r\n            }\r\n        }\r\n\r\n        return res;\r\n    } else {\r\n        return obj;\r\n    }\r\n}\r\n\r\nconst imgReg = /\\.(jpg|png|gif|jpeg)$/i;\r\nexport function isImg(str: any){\r\n    if(typeof str === 'string'){\r\n        return imgReg.test(str) || str.startsWith('data:image/');\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/**\r\n * 创建一个检测一个字符串是否在一系列字符串内的函数+\r\n * @param str 用于检测的系列字符串组成的字符串，以空格分隔\r\n * @param ignore 是否忽略大小写\r\n */\r\nexport function makeCheckExist(str: string, ignore?: boolean){\r\n    let keys = str.split(' ');\r\n    if(ignore){\r\n        keys = keys.map(v => v.toLowerCase());\r\n    }\r\n\r\n    return function(k: string){\r\n        if(ignore) {\r\n            k = k.toLowerCase();\r\n        }\r\n\r\n        return keys.includes(k);\r\n    }\r\n}\r\n\r\n/**\r\n * 判断一个数值是否是0, 误差为Number.EPSILON\r\n */\r\nexport function isZero(val: number) {\r\n    return val > -Number.EPSILON && val < Number.EPSILON;\r\n}\r\n\r\n/**\r\n * 获取闭区间[min, max]内的随机整数, 四舍五入\r\n * 若max < min则闭区间为[max, min]\r\n */\r\nexport function randomInt(min: number, max: number){\r\n    if(max === min) return Math.round(max);\r\n\r\n    if(max < min) {\r\n        [min, max] = [max, min];\r\n    }\r\n\r\n    return Math.round(Math.random() * (max - min) + min);\r\n}\r\n\r\n/**\r\n * 二分法查找插入位置\r\n * @param compare 比较函数, 返回值<=0时, 插入位置<=mid, 反之>mid\r\n * @param len 数组长度\r\n */\r\nexport function findIndexByBinary(compare: (mid: number) => number, len: number) {\r\n    let low = 0, high = len - 1, mid = 0;\r\n    while(low <= high){\r\n        mid = Math.floor((high + low) / 2);\r\n        const res = compare(mid);\r\n        if(res < 0){\r\n            high = mid - 1;\r\n        } else if(res > 0){\r\n            low = mid + 1;\r\n        } else {\r\n            return mid;\r\n        }\r\n    }\r\n\r\n    return low;\r\n}\r\n\r\n/**\r\n * 下/中划线转驼峰\r\n */\r\nexport const line2hump = cached((str: string) => {\r\n    return str.replace(/[-_]+(\\w)/g, (_, w: string) => w.toUpperCase());\r\n})\r\n\r\n/**\r\n * 驼峰转下/中划线\r\n */\r\nexport const hump2line = cached((str: string, line: string = '-') => {\r\n    return str.replace(/[A-Z]/g, (w: string) => line + w.toLowerCase());\r\n})\r\n\r\nconst ids: Set<string | number> = new Set();\r\nexport const createId = (() => {\r\n    let num: number = 0;\r\n\r\n    return function(id: string | number) {\r\n        if(ids.has(id)) {\r\n            id = `${Date.now().toString(16)}${num.toString(16).padStart(6, '0')}`;\r\n            num++;\r\n        }\r\n        ids.add(id);\r\n\r\n        return id;\r\n    }\r\n})();\r\nexport function removeId(id: string | number) {\r\n    ids.delete(id);\r\n}\r\n\r\nexport function Mixin(...source: Function[]) {\r\n    return (target: Function) => {\r\n        const proto = target.prototype;\r\n        source.forEach(s =>\r\n            Reflect.ownKeys(s.prototype).forEach(key => {\r\n                if (!(isNotMixinKey(<string>key) || Reflect.has(proto, key))) {\r\n                    const desc = Object.getOwnPropertyDescriptor(s.prototype, key);\r\n                    Object.defineProperty(proto, key, desc);\r\n                }\r\n            })\r\n        )\r\n    }\r\n}\r\nconst isNotMixinKey = makeCheckExist('constructor prototype name');","// 设备像素比\r\nexport const devicePixelRatio = Math.max(window.devicePixelRatio || 1, 2);","/**\r\n * dom相关\r\n */\r\nimport { cached } from \"../tool/util\";\r\nimport { devicePixelRatio } from '../config';\r\n\r\nlet id: number = 0;\r\nfunction createId(){\r\n    return id++;\r\n}\r\n\r\n/**\r\n * 创建canvas\r\n * @param w\r\n * @param h\r\n */\r\nexport function createCanvas(w: number, h: number, id?: string){\r\n    const canvas = document.createElement('canvas');\r\n    Object.assign(canvas.style, {\r\n        position: 'absolute',\r\n        left: 0,\r\n        top: 0,\r\n        width: `${w}px`,\r\n        height: `${h}px`\r\n    })\r\n\r\n    canvas.setAttribute('data-dom-id', id || `canvas-${createId()}`);\r\n    canvas.width = w * devicePixelRatio;\r\n    canvas.height = h * devicePixelRatio;\r\n\r\n    return canvas;\r\n}\r\n\r\nexport const getContext = cached(() => {\r\n    return document.createElement('canvas').getContext('2d');\r\n})\r\n\r\n/**\r\n * 解析css尺寸\r\n * @param size 尺寸设置\r\n * @param base 百分比相对值\r\n */\r\nexport function parseSize(size: number | string, base: number): number {\r\n    if(typeof size === 'string'){\r\n        if(size.endsWith('%')){\r\n            return base * (parseFloat(size) || 0) / 100;\r\n        } else {\r\n            return (parseFloat(size) || 0) * devicePixelRatio;\r\n        }\r\n    }\r\n\r\n    return (size || 0) * devicePixelRatio;\r\n}\r\n\r\n/**\r\n * 获取鼠标相对于canvas的位置\r\n */\r\nexport function getPosition(el: HTMLElement, e: any) {\r\n    if(e.offsetX != null && e.offsetY != null) {\r\n        return {x: e.offsetX, y: e.offsetY};\r\n    }\r\n\r\n    if(el.getBoundingClientRect) {\r\n        const rect = el.getBoundingClientRect();\r\n        let clientX = e.clientX, clientY = e.clientY;\r\n        if(e.touches) {\r\n            if(!e.touches.length) {\r\n                return {x: 0, y: 0};\r\n            }\r\n            clientX = e.touches[0].clientX;\r\n            clientY = e.touches[0].clientY;\r\n        }\r\n\r\n        return {\r\n            x: clientX - rect.left,\r\n            y: clientY - rect.top\r\n        };\r\n    }\r\n\r\n    return {x: 0, y: 0};\r\n}\r\n\r\nexport function addHandler(element: any, type: string, handler: Function) {\r\n    if(element.addEventListener){\r\n        element.addEventListener(type, handler, false);\r\n    } else if (element.attachEvent){\r\n        element.attachEvent('on' + type, handler);\r\n    } else {\r\n        element['on' + type] = handler;\r\n    }\r\n}\r\n\r\nexport function removeHandler(element: any, type: string, handler: Function){\r\n    if(element.removeEventListener){\r\n        element.removeEventListener(type, handler, false);\r\n    } else if (element.detachEvent){\r\n        element.detachEvent('on' + type, handler);\r\n    } else {\r\n        element['on' + type] = null;\r\n    }\r\n}","import { Matrix } from \"./matrix\";\r\n\r\nexport class Transform {\r\n    transform(m: Matrix | number[][]){}\r\n\r\n    copy(source: Transform){\r\n        Object.assign(this, source);\r\n\r\n        return this;\r\n    }\r\n\r\n    rotate(rotation: number){\r\n        if(rotation) {\r\n            const cos = Math.cos(rotation);\r\n            const sin = Math.sin(rotation);\r\n            this.transform(\r\n                [\r\n                    [cos, -sin, 0],\r\n                    [sin, cos, 0],\r\n                    [0, 0, 1]\r\n                ]\r\n            );\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    scale(sx: number | number[] = 1, sy: number = 1){\r\n        if(Array.isArray(sx)){\r\n            sy = sx[1];\r\n            sx = sx[0];\r\n        }\r\n\r\n        if(sx !== 1 || sy !== 1){\r\n            this.transform([\r\n                [sx, 0, 0],\r\n                [0, sy, 0],\r\n                [0, 0, 1]\r\n            ]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    translate(x: number | number[] = 0, y: number = 0){\r\n        if(Array.isArray(x)){\r\n            y = x[1];\r\n            x = x[0];\r\n        }\r\n\r\n        if(x || y){\r\n            this.transform([\r\n                [1, 0, x],\r\n                [0, 1, y],\r\n                [0, 0, 1]\r\n            ]);\r\n        }\r\n\r\n        return this;\r\n    }\r\n}","/**\r\n * 变换矩阵\r\n */\r\nimport { Transform } from \"./transform\";\r\n\r\n\r\nexport class Matrix extends Transform {\r\n    constructor(\r\n        public a: number = 1, // 水平缩放\r\n        public c: number = 0, // 垂直倾斜\r\n        public e: number = 0, // 水平位移\r\n\r\n        public b: number = 0, // 水平倾斜\r\n        public d: number = 1, // 垂直缩放\r\n        public f: number = 0 // 垂直位移\r\n    ) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * 重置为单位阵\r\n     */\r\n    toUnit(){\r\n        this.a = this.d = 1;\r\n        this.c = this.e = this.b = this.f = 0;\r\n\r\n        return this;\r\n    }\r\n\r\n    toArray(){\r\n        return [\r\n            [this.a, this.c, this.e],\r\n            [this.b, this.d, this.f],\r\n            [0, 0, 1]\r\n        ]\r\n    }\r\n\r\n    transform(m: Matrix | number[][], isRight?: boolean){\r\n        if(m instanceof Matrix){\r\n            m = m.toArray();\r\n        }\r\n        const thisArr = this.toArray();\r\n        let left = m, right = thisArr;\r\n        if(isRight) {\r\n            left = thisArr;\r\n            right = m;\r\n        };\r\n\r\n        this.a = left[0][0] * right[0][0] + left[0][1] * right[1][0];\r\n        this.c = left[0][0] * right[0][1] + left[0][1] * right[1][1];\r\n        this.e = left[0][0] * right[0][2] + left[0][1] * right[1][2] + left[0][2];\r\n\r\n        this.b = left[1][0] * right[0][0] + left[1][1] * right[1][0];\r\n        this.d = left[1][0] * right[0][1] + left[1][1] * right[1][1];\r\n        this.f = left[1][0] * right[0][2] + left[1][1] * right[1][2] + left[1][2];\r\n\r\n        return this;\r\n    }\r\n\r\n    // 矩阵求逆\r\n    invert() {\r\n        // |A| == 0, 矩阵不可逆, 使用js最小精度求近似值\r\n        // 矩阵不可逆的情况对于变换矩阵而言出现几率通常较低\r\n        const det = this.a * this.d - this.b * this.c || Number.EPSILON;\r\n\r\n        return new Matrix(\r\n            this.d / det, -this.c / det, (this.c * this.f - this.d * this.e) / det,\r\n            -this.b / det, this.a / det, (this.b * this.e - this.a * this.f) / det\r\n        );\r\n    }\r\n}\r\n\r\n/**\r\n* 矩阵相乘\r\n*/\r\n// export function mul(...m: number[][][]){\r\n//     if(!m.length) {\r\n//         return [];\r\n//     }\r\n//     if(m.length === 1) {\r\n//         return m[0];\r\n//     }\r\n\r\n//     return m.reduce(_mul);\r\n// }\r\n\r\n// function _mul(left: number[][], right: number[][]){\r\n//     let r:number, l: number;\r\n\r\n//     try {\r\n//         r = left.length || 0;\r\n//         l = right[0].length || 0;\r\n//     } catch(e) {\r\n//         return console.error(e), [];\r\n//     }\r\n\r\n//     const m: number[][] = [];\r\n//     for(let i=0; i<r; i++){\r\n//         m[i] = [];\r\n\r\n//         for(let j=0; j<l; j++){\r\n//             if(Array.isArray(left[i])){\r\n//                 m[i][j] = left[i].reduce((a, lv, k) => {\r\n//                     let rv = 0;\r\n\r\n//                     if(right[k] && right[k][j] != null){\r\n//                         rv = right[k][j];\r\n//                     } else {\r\n//                         console.error(`${JSON.stringify(right)} ${k}行${j}列不存在`);\r\n//                     }\r\n\r\n//                     return a + lv * rv;\r\n//                 }, 0)\r\n//             } else {\r\n//                 m[i][j] = 0;\r\n//             }\r\n//         }\r\n//     }\r\n\r\n//     return m;\r\n// }","/**\r\n * 包围盒\r\n */\r\nimport { Matrix } from '../lib/matrix';\r\n\r\nexport class BoundingRect {\r\n    constructor(\r\n        public x: number = 0,\r\n        public y: number = 0,\r\n        public w: number = 0,\r\n        public h: number = 0,\r\n    ){}\r\n\r\n    toArray(){\r\n        return [\r\n            [this.x, this.x + this.w, this.x + this.w, this.x],\r\n            [this.y, this.y, this.y + this.h, this.y + this.h],\r\n            [1, 1, 1, 1]\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * 合并包围盒\r\n     * @param other 另一个包围盒\r\n     */\r\n    extend(other: BoundingRect) {\r\n        const x = Math.min(other.x, this.x);\r\n        const y = Math.min(other.y, this.y);\r\n\r\n        this.w = Math.max(other.x + other.w, this.x + this.w) - x;\r\n        this.h = Math.max(other.y + other.h, this.y + this.h) - y;\r\n        this.x = x;\r\n        this.y = y;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 包围盒变换\r\n     * @param m 变换矩阵\r\n     */\r\n    transform(m: Matrix,){\r\n        const thisArr = this.toArray();\r\n        const mArr = m.toArray();\r\n\r\n        let minX: number, minY: number,\r\n            maxX: number, maxY: number,\r\n            x: number, y: number;\r\n        minX = minY = Number.MAX_VALUE;\r\n        maxX = maxY = -Number.MAX_VALUE\r\n\r\n        for(let i=0; i<4; i++) {\r\n            x = mArr[0][0] * thisArr[0][i] + mArr[0][1] * thisArr[1][i] + mArr[0][2];\r\n            y = mArr[1][0] * thisArr[0][i] + mArr[1][1] * thisArr[1][i] + mArr[1][2];\r\n\r\n            minX = Math.min(x, minX);\r\n            minY = Math.min(y, minY);\r\n\r\n            maxX = Math.max(x, maxX);\r\n            maxY = Math.max(y, maxY);\r\n        }\r\n\r\n        this.x = minX;\r\n        this.y = minY;\r\n        this.w = maxX - minX;\r\n        this.h = maxY - minY;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 检测一个点是否在此包围盒内部\r\n     */\r\n    contain(x: number, y: number){\r\n        return x >= this.x && x <= this.x + this.w && y >= this.y && y <= this.y + this.h;\r\n    }\r\n\r\n    /**\r\n     * 检测两个包围盒区域是否相交\r\n     */\r\n    intersect(\r\n        x: BoundingRect | number = 0,\r\n        y: number = 0,\r\n        w: number = 0,\r\n        h: number = 0\r\n    ) {\r\n        if(x instanceof BoundingRect){\r\n            y = x.y;\r\n            w = x.w;\r\n            h = x.h;\r\n            x = x.x;\r\n        }\r\n\r\n        const ax0 = this.x;\r\n        const ax1 = this.x + this.w;\r\n        const ay0 = this.y;\r\n        const ay1 = this.y + this.h;\r\n\r\n        const bx0 = x;\r\n        const bx1 = x + w;\r\n        const by0 = y;\r\n        const by1 = y + h;\r\n\r\n        return ax1 >= bx0 || ax0 <= bx1 || ay1 >= by0 || by1 >= ay0;\r\n    }\r\n\r\n    clone() {\r\n        return new BoundingRect(this.x, this.y, this.w, this.h);\r\n    }\r\n}","/**\r\n * 资源管理，主要是图片\r\n */\r\n\r\ninterface ResData {\r\n    image: HTMLImageElement,\r\n    count: number\r\n}\r\n\r\nconst res: Map<string, ResData> = new Map();\r\n\r\nexport const DEFAULT_SRC = require('../assets/1.jpg'); // 默认图片\r\n\r\n/**\r\n * 获取图片\r\n * @param isFirst 是否是节点第一次请求图片\r\n */\r\nexport function getImg(path: string, isFirst: boolean = true): Promise<HTMLImageElement> {\r\n    const data = res.get(path);\r\n    if(data){\r\n        if(isFirst){\r\n            data.count++;\r\n        }\r\n\r\n        return Promise.resolve(data.image);\r\n    }\r\n\r\n    const img = new Image();\r\n    img.src = path;\r\n\r\n    return new Promise(resolve => {\r\n        img.onload = () => {\r\n            res.set(path, {image: img, count: 1});\r\n            resolve(img);\r\n        }\r\n\r\n        img.onerror = () => {\r\n            img.src = DEFAULT_SRC;\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * 释放图片\r\n */\r\nexport function disposeImg(path: string){\r\n    const data = res.get(path);\r\n\r\n    if(data){\r\n        data.count--;\r\n        if(data.count <= 0 && path !== DEFAULT_SRC){\r\n            data.image.onload = null;\r\n            data.image.src = '';\r\n            res.delete(path);\r\n        }\r\n    }\r\n}\r\n\r\ngetImg(DEFAULT_SRC);","\r\n/**\r\n * 将颜色转为rgba颜色的四个值的数组\r\n * 同easing一样从zRender里拿过来的\r\n */\r\nimport { cached } from \"./util\";\r\n\r\n// ========================================\r\nconst kCSSColorTable = {\r\n    'transparent': [0, 0, 0, 0], 'aliceblue': [240, 248, 255, 1],\r\n    'antiquewhite': [250, 235, 215, 1], 'aqua': [0, 255, 255, 1],\r\n    'aquamarine': [127, 255, 212, 1], 'azure': [240, 255, 255, 1],\r\n    'beige': [245, 245, 220, 1], 'bisque': [255, 228, 196, 1],\r\n    'black': [0, 0, 0, 1], 'blanchedalmond': [255, 235, 205, 1],\r\n    'blue': [0, 0, 255, 1], 'blueviolet': [138, 43, 226, 1],\r\n    'brown': [165, 42, 42, 1], 'burlywood': [222, 184, 135, 1],\r\n    'cadetblue': [95, 158, 160, 1], 'chartreuse': [127, 255, 0, 1],\r\n    'chocolate': [210, 105, 30, 1], 'coral': [255, 127, 80, 1],\r\n    'cornflowerblue': [100, 149, 237, 1], 'cornsilk': [255, 248, 220, 1],\r\n    'crimson': [220, 20, 60, 1], 'cyan': [0, 255, 255, 1],\r\n    'darkblue': [0, 0, 139, 1], 'darkcyan': [0, 139, 139, 1],\r\n    'darkgoldenrod': [184, 134, 11, 1], 'darkgray': [169, 169, 169, 1],\r\n    'darkgreen': [0, 100, 0, 1], 'darkgrey': [169, 169, 169, 1],\r\n    'darkkhaki': [189, 183, 107, 1], 'darkmagenta': [139, 0, 139, 1],\r\n    'darkolivegreen': [85, 107, 47, 1], 'darkorange': [255, 140, 0, 1],\r\n    'darkorchid': [153, 50, 204, 1], 'darkred': [139, 0, 0, 1],\r\n    'darksalmon': [233, 150, 122, 1], 'darkseagreen': [143, 188, 143, 1],\r\n    'darkslateblue': [72, 61, 139, 1], 'darkslategray': [47, 79, 79, 1],\r\n    'darkslategrey': [47, 79, 79, 1], 'darkturquoise': [0, 206, 209, 1],\r\n    'darkviolet': [148, 0, 211, 1], 'deeppink': [255, 20, 147, 1],\r\n    'deepskyblue': [0, 191, 255, 1], 'dimgray': [105, 105, 105, 1],\r\n    'dimgrey': [105, 105, 105, 1], 'dodgerblue': [30, 144, 255, 1],\r\n    'firebrick': [178, 34, 34, 1], 'floralwhite': [255, 250, 240, 1],\r\n    'forestgreen': [34, 139, 34, 1], 'fuchsia': [255, 0, 255, 1],\r\n    'gainsboro': [220, 220, 220, 1], 'ghostwhite': [248, 248, 255, 1],\r\n    'gold': [255, 215, 0, 1], 'goldenrod': [218, 165, 32, 1],\r\n    'gray': [128, 128, 128, 1], 'green': [0, 128, 0, 1],\r\n    'greenyellow': [173, 255, 47, 1], 'grey': [128, 128, 128, 1],\r\n    'honeydew': [240, 255, 240, 1], 'hotpink': [255, 105, 180, 1],\r\n    'indianred': [205, 92, 92, 1], 'indigo': [75, 0, 130, 1],\r\n    'ivory': [255, 255, 240, 1], 'khaki': [240, 230, 140, 1],\r\n    'lavender': [230, 230, 250, 1], 'lavenderblush': [255, 240, 245, 1],\r\n    'lawngreen': [124, 252, 0, 1], 'lemonchiffon': [255, 250, 205, 1],\r\n    'lightblue': [173, 216, 230, 1], 'lightcoral': [240, 128, 128, 1],\r\n    'lightcyan': [224, 255, 255, 1], 'lightgoldenrodyellow': [250, 250, 210, 1],\r\n    'lightgray': [211, 211, 211, 1], 'lightgreen': [144, 238, 144, 1],\r\n    'lightgrey': [211, 211, 211, 1], 'lightpink': [255, 182, 193, 1],\r\n    'lightsalmon': [255, 160, 122, 1], 'lightseagreen': [32, 178, 170, 1],\r\n    'lightskyblue': [135, 206, 250, 1], 'lightslategray': [119, 136, 153, 1],\r\n    'lightslategrey': [119, 136, 153, 1], 'lightsteelblue': [176, 196, 222, 1],\r\n    'lightyellow': [255, 255, 224, 1], 'lime': [0, 255, 0, 1],\r\n    'limegreen': [50, 205, 50, 1], 'linen': [250, 240, 230, 1],\r\n    'magenta': [255, 0, 255, 1], 'maroon': [128, 0, 0, 1],\r\n    'mediumaquamarine': [102, 205, 170, 1], 'mediumblue': [0, 0, 205, 1],\r\n    'mediumorchid': [186, 85, 211, 1], 'mediumpurple': [147, 112, 219, 1],\r\n    'mediumseagreen': [60, 179, 113, 1], 'mediumslateblue': [123, 104, 238, 1],\r\n    'mediumspringgreen': [0, 250, 154, 1], 'mediumturquoise': [72, 209, 204, 1],\r\n    'mediumvioletred': [199, 21, 133, 1], 'midnightblue': [25, 25, 112, 1],\r\n    'mintcream': [245, 255, 250, 1], 'mistyrose': [255, 228, 225, 1],\r\n    'moccasin': [255, 228, 181, 1], 'navajowhite': [255, 222, 173, 1],\r\n    'navy': [0, 0, 128, 1], 'oldlace': [253, 245, 230, 1],\r\n    'olive': [128, 128, 0, 1], 'olivedrab': [107, 142, 35, 1],\r\n    'orange': [255, 165, 0, 1], 'orangered': [255, 69, 0, 1],\r\n    'orchid': [218, 112, 214, 1], 'palegoldenrod': [238, 232, 170, 1],\r\n    'palegreen': [152, 251, 152, 1], 'paleturquoise': [175, 238, 238, 1],\r\n    'palevioletred': [219, 112, 147, 1], 'papayawhip': [255, 239, 213, 1],\r\n    'peachpuff': [255, 218, 185, 1], 'peru': [205, 133, 63, 1],\r\n    'pink': [255, 192, 203, 1], 'plum': [221, 160, 221, 1],\r\n    'powderblue': [176, 224, 230, 1], 'purple': [128, 0, 128, 1],\r\n    'red': [255, 0, 0, 1], 'rosybrown': [188, 143, 143, 1],\r\n    'royalblue': [65, 105, 225, 1], 'saddlebrown': [139, 69, 19, 1],\r\n    'salmon': [250, 128, 114, 1], 'sandybrown': [244, 164, 96, 1],\r\n    'seagreen': [46, 139, 87, 1], 'seashell': [255, 245, 238, 1],\r\n    'sienna': [160, 82, 45, 1], 'silver': [192, 192, 192, 1],\r\n    'skyblue': [135, 206, 235, 1], 'slateblue': [106, 90, 205, 1],\r\n    'slategray': [112, 128, 144, 1], 'slategrey': [112, 128, 144, 1],\r\n    'snow': [255, 250, 250, 1], 'springgreen': [0, 255, 127, 1],\r\n    'steelblue': [70, 130, 180, 1], 'tan': [210, 180, 140, 1],\r\n    'teal': [0, 128, 128, 1], 'thistle': [216, 191, 216, 1],\r\n    'tomato': [255, 99, 71, 1], 'turquoise': [64, 224, 208, 1],\r\n    'violet': [238, 130, 238, 1], 'wheat': [245, 222, 179, 1],\r\n    'white': [255, 255, 255, 1], 'whitesmoke': [245, 245, 245, 1],\r\n    'yellow': [255, 255, 0, 1], 'yellowgreen': [154, 205, 50, 1]\r\n};\r\n\r\nfunction clampCssByte(i: number) {  // Clamp to integer 0 .. 255.\r\n    i = Math.round(i);  // Seems to be what Chrome does (vs truncation).\r\n    return i < 0 ? 0 : i > 255 ? 255 : i;\r\n}\r\n\r\nfunction clampCssFloat(f: number) {  // Clamp to float 0.0 .. 1.0.\r\n    return f < 0 ? 0 : f > 1 ? 1 : f;\r\n}\r\n\r\nfunction parseCssInt(str: string) {  // int or percentage.\r\n    if (str.length && str.charAt(str.length - 1) === '%') {\r\n        return clampCssByte(parseFloat(str) / 100 * 255);\r\n    }\r\n    return clampCssByte(parseInt(str, 10));\r\n}\r\n\r\nfunction parseCssFloat(str: string) {  // float or percentage.\r\n    if (str.length && str.charAt(str.length - 1) === '%') {\r\n        return clampCssFloat(parseFloat(str) / 100);\r\n    }\r\n    return clampCssFloat(parseFloat(str));\r\n}\r\n\r\nfunction cssHueToRgb(m1: number, m2: number, h: number) {\r\n    if (h < 0) {\r\n        h += 1;\r\n    }\r\n    else if (h > 1) {\r\n        h -= 1;\r\n    }\r\n\r\n    if (h * 6 < 1) {\r\n        return m1 + (m2 - m1) * h * 6;\r\n    }\r\n    if (h * 2 < 1) {\r\n        return m2;\r\n    }\r\n    if (h * 3 < 2) {\r\n        return m1 + (m2 - m1) * (2 / 3 - h) * 6;\r\n    }\r\n    return m1;\r\n}\r\n\r\nfunction hsla2rgba(hsla: string[]) {\r\n    const h = (((parseFloat(hsla[0]) % 360) + 360) % 360) / 360;  // 0 .. 1\r\n\r\n    // NOTE(deanm): According to the CSS spec s/l should only be\r\n    // percentages, but we don't bother and let float or percentage.\r\n    const s = parseCssFloat(hsla[1]);\r\n    const l = parseCssFloat(hsla[2]);\r\n    const m2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\r\n    const m1 = l * 2 - m2;\r\n\r\n    const rgba = [\r\n        clampCssByte(cssHueToRgb(m1, m2, h + 1 / 3) * 255),\r\n        clampCssByte(cssHueToRgb(m1, m2, h) * 255),\r\n        clampCssByte(cssHueToRgb(m1, m2, h - 1 / 3) * 255),\r\n        1\r\n    ];\r\n\r\n    if (hsla.length === 4) {\r\n        rgba[3] = +hsla[3];\r\n    }\r\n\r\n    return rgba;\r\n}\r\n\r\nfunction err(str: string) {\r\n    console.error(`${str}不是有效的ccs颜色值`);\r\n    return [0, 0, 0, 0];\r\n}\r\n\r\n/**\r\n * 将颜色转为rgba颜色的四个值的数组\r\n */\r\nexport const parseColor = cached((colorStr: string): number[] => {\r\n    if (typeof colorStr !== 'string' || !colorStr) {\r\n        return err(colorStr);\r\n    }\r\n    const str = colorStr.replace(/ /g, '').toLowerCase();\r\n\r\n    if (Reflect.has(kCSSColorTable, str)) {\r\n        return Array.from(Reflect.get(kCSSColorTable, str));\r\n    }\r\n\r\n    // #abc and #abc123 syntax.\r\n    if (str.startsWith('#')) {\r\n        if (str.length === 4) {\r\n            var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\r\n            if (!(iv >= 0 && iv <= 0xfff)) {\r\n                return err(str);\r\n            }\r\n\r\n            return [\r\n                ((iv & 0xf00) >> 4) | ((iv & 0xf00) >> 8),\r\n                (iv & 0xf0) | ((iv & 0xf0) >> 4),\r\n                (iv & 0xf) | ((iv & 0xf) << 4),\r\n                1\r\n            ];\r\n        }\r\n        else if (str.length === 7) {\r\n            var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\r\n            if (!(iv >= 0 && iv <= 0xffffff)) {\r\n                return err(str);\r\n            }\r\n            return [\r\n                (iv & 0xff0000) >> 16,\r\n                (iv & 0xff00) >> 8,\r\n                iv & 0xff,\r\n                1\r\n            ];\r\n        }\r\n\r\n        return err(str);\r\n    }\r\n\r\n    const op = str.indexOf('(');\r\n    const ep = str.indexOf(')');\r\n    if (op !== -1 && ep + 1 === str.length) {\r\n        const fname = str.substr(0, op);\r\n        const params = str.substr(op + 1, ep - (op + 1)).split(',');\r\n        let alpha = 1;  // To allow case fallthrough.\r\n        switch (fname) {\r\n            case 'rgba':\r\n                if (params.length !== 4) {\r\n                    return err(str);\r\n                }\r\n                alpha = parseCssFloat(params.pop()); // jshint ignore:line\r\n            // Fall through.\r\n            case 'rgb':\r\n                if (params.length !== 3) {\r\n                    return err(str);\r\n                }\r\n\r\n                return [\r\n                    parseCssInt(params[0]),\r\n                    parseCssInt(params[1]),\r\n                    parseCssInt(params[2]),\r\n                    alpha\r\n                ];\r\n            case 'hsla':\r\n                if (params.length !== 4) {\r\n                    return err(str);\r\n                }\r\n                params[3] = parseCssFloat(params[3]) + '';\r\n\r\n                return hsla2rgba(params);\r\n            case 'hsl':\r\n                if (params.length !== 3) {\r\n                    return err(str);\r\n                }\r\n                return hsla2rgba(params);\r\n        }\r\n    }\r\n\r\n    return err(str);\r\n}, 500)\r\n\r\n/**\r\n * @param arrColor like [12,33,44,0.4]\r\n * @param type 'rgba', 'hsva', ...\r\n * @return Result color. (If input illegal, return undefined).\r\n */\r\nexport function stringify(arrColor: number[], type: string) {\r\n    if (!arrColor || !arrColor.length) {\r\n        return;\r\n    }\r\n    let colorStr = arrColor[0] + ',' + arrColor[1] + ',' + arrColor[2];\r\n    if (type === 'rgba' || type === 'hsva' || type === 'hsla') {\r\n        colorStr += ',' + arrColor[3];\r\n    }\r\n\r\n    return type + '(' + colorStr + ')';\r\n}\r\n\r\n/**\r\n * 判断两个颜色是否相等\r\n */\r\nexport function isEqual(a: any, b: any) {\r\n    if(typeof a === 'string' && typeof b === 'string') {\r\n        const arr1 = parseColor(a);\r\n        const arr2 = parseColor(b);\r\n\r\n        return arr1.every((v, i) => v === arr2[i]);\r\n    }\r\n\r\n    return a === b;\r\n}","/// <reference lib=\"es2017.object\" />\r\n\r\n/**\r\n * 样式\r\n */\r\nimport { isImg, makeCheckExist } from \"../tool/util\";\r\nimport { getImg, disposeImg, DEFAULT_SRC } from \"./resource\";\r\nimport { parseColor, stringify, isEqual } from \"../tool/color\";\r\nimport { devicePixelRatio } from '../config';\r\n\r\n/**\r\n * 将数据解析为有4个元素的数组\r\n */\r\nfunction parseNumArr(data: number | number[]){\r\n    const res = new Array(4).fill(0);\r\n    if(Array.isArray(data)){\r\n        switch(data.length){\r\n            case 1: res[0] = res[1] = data[0];\r\n            case 2: res[2] = res[0];\r\n            case 3:\r\n                res[3] = res[1];\r\n                break;\r\n            default: Object.assign(res, data);\r\n        }\r\n    } else if(typeof data === 'number'){\r\n        res.fill(data)\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\nconst isTransformKey = makeCheckExist(\r\n    'rotation left top bottom right' + ' ' +\r\n    'scale scaleX scaleY width height' + ' ' +\r\n    'origin originX originY'\r\n)\r\n\r\n// ====================================================\r\nexport interface Istyle {\r\n    background?: string | CanvasGradient;\r\n    color?: string | CanvasGradient;\r\n    clip?: boolean;\r\n\r\n    src?: string;\r\n\r\n    border?: number;\r\n    borderColor?: string | CanvasGradient;\r\n    borderRadius?: number | number[];\r\n    borderStyle?: number[];\r\n\r\n    opacity?: number;\r\n\r\n    width?: number | string;\r\n    height?: number | string;\r\n\r\n    rotation?: number;\r\n\r\n    scaleX?: number;\r\n    scaleY?: number;\r\n    scale?: number | number[];\r\n\r\n    left?: number | string;\r\n    right?: number | string;\r\n    top?: number | string;\r\n    bottom?: number | string;\r\n\r\n    origin?: number | number[];\r\n    originX?: number;\r\n    originY?: number;\r\n\r\n    cellId?: number;\r\n    cellWidth?: number | string;\r\n    cellHeight?: number | string;\r\n}\r\n\r\nexport class Style {\r\n    background?: string | CanvasGradient;\r\n    color: string | CanvasGradient = 'rgba(0, 0, 0, 1)';\r\n\r\n    src?: string; // 图片路径\r\n\r\n    border: number = 0;\r\n    borderColor: string | CanvasGradient = 'rgba(0, 0, 0, 1)';\r\n    borderRadius?: number[];\r\n    borderStyle: number[] = [];\r\n\r\n    opacity: number = 1; // bug已解决\r\n\r\n    width: number | string = '100%';\r\n    height: number | string = '100%';\r\n\r\n    rotation: number = 0;\r\n\r\n    scale: number[] = [1, 1];\r\n\r\n    left?: number | string;\r\n    right?: number | string;\r\n    top?: number | string;\r\n    bottom?: number | string;\r\n\r\n    zIndex: number = 0;\r\n\r\n    clip: boolean = false;\r\n\r\n    origin: number[] = [0.5, 0.5];\r\n\r\n    private _res: Set<string> = new Set(); // 节点已加载过的图片资源\r\n\r\n    set(key: string | Istyle, value: any){\r\n        if(typeof key === 'string'){\r\n            return this.attr([key, value]);\r\n        } else {\r\n            return Object.entries(key).map(this.attr, this).includes(true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据样式设置绘制状态\r\n     * @param width 节点的宽\r\n     * @param height 节点的高\r\n     */\r\n    async build(ctx: CanvasRenderingContext2D, width: number, height: number){\r\n        if(this.border){\r\n            ctx.setLineDash(this.borderStyle);\r\n            if(!isEqual(ctx.strokeStyle, this.borderColor)) {\r\n                ctx.strokeStyle = this.borderColor;\r\n            }\r\n            if(ctx.lineWidth !== this.border) {\r\n                ctx.lineWidth = this.border;\r\n            }\r\n        }\r\n\r\n        if(this.background) {\r\n            if(isImg(this.background)) {\r\n                const path = <string>this.background;\r\n                const img = await this.loadImg(path);\r\n\r\n                const pattern = ctx.createPattern(img, 'no-repeat');\r\n                pattern.setTransform({\r\n                    a: width / img.width, d: height / img.height,\r\n                    b: 0, c: 0, e: 0, f: 0\r\n                });\r\n                ctx.fillStyle = pattern;\r\n            } else {\r\n                if(!isEqual(ctx.fillStyle, this.background)) {\r\n                    ctx.fillStyle = this.background;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置全局透明度\r\n     */\r\n    setAlpha(ctx: CanvasRenderingContext2D){\r\n        const alpha = Math.max(0, Math.min(1, this.opacity));\r\n        if(ctx.globalAlpha !== alpha) {\r\n            ctx.globalAlpha = alpha;\r\n        }\r\n    }\r\n\r\n    dispose(){\r\n        this._res.forEach(disposeImg);\r\n        this._res.clear();\r\n    }\r\n\r\n    /**\r\n     * 判断新值与旧值是否相等\r\n     */\r\n    equal(key: string, value: any){\r\n        let old = Reflect.get(this, key);\r\n        if(old == null) {\r\n            old = Reflect.get(this, key.substr(0, key.length - 1));\r\n        }\r\n\r\n        if(key === 'border') {\r\n            value *= devicePixelRatio;\r\n        }\r\n\r\n        if(Array.isArray(old)) {\r\n            if(Array.isArray(value)) {\r\n                if(key === 'borderStyle' && old.length !== value.length) {\r\n                    return false;\r\n                }\r\n\r\n                return old.every((v, i) => v === value[i]);\r\n            }\r\n\r\n            if(key.endsWith('X')) {\r\n                return old[0] === value;\r\n            }\r\n\r\n            if(key.endsWith('Y')){\r\n                return old[1] === value;\r\n            }\r\n\r\n            return old.every(v => v === value);\r\n        }\r\n\r\n        return old === value;\r\n    }\r\n\r\n    /**\r\n     * 获取Image\r\n     * @param src 图片路径\r\n     */\r\n    loadImg(src:string = this.src) {\r\n        if(!isImg(src)) {\r\n            console.warn(`${src}不是有效的图片路径`);\r\n\r\n            src = DEFAULT_SRC;\r\n        }\r\n\r\n        const isFirst = !this._res.has(src);\r\n        this._res.add(src);\r\n\r\n        return getImg(src, isFirst);\r\n    }\r\n\r\n    private attr([key, value]: [string, any]){\r\n        let isModifyTransform = isTransformKey(key);\r\n        if(isModifyTransform) {\r\n            isModifyTransform = isModifyTransform && !this.equal(key, value);\r\n        }\r\n\r\n        if((key === 'src' || key === 'background') && typeof value === 'string' && !isImg(value)) {\r\n            value = stringify(parseColor(value), 'rgba');\r\n        }\r\n\r\n        switch(key){\r\n            case 'borderRadius':\r\n                this[key] = parseNumArr(value);\r\n                break;\r\n            case 'scale': case 'origin':\r\n                this[key] = Array.isArray(value) ? value : [value, value];\r\n                break;\r\n            case 'scaleX': case 'originX': case 'scaleY': case 'originY':\r\n                const k = <'scale' | 'origin'>key.substr(0, key.length - 1);\r\n                this[k][key.endsWith('X') ? 0 : 1] = value;\r\n                break;\r\n            case 'border':\r\n                value *= devicePixelRatio;\r\n            default:\r\n                Reflect.set(this, key, value);\r\n        }\r\n\r\n        return isModifyTransform;\r\n    }\r\n}","/**\r\n * 事件\r\n */\r\nimport { Canvas2DElement } from \"../node/element\";\r\n\r\nexport type EventType = 'dbclick' | 'click' | 'mousedown' | 'mouseup' | 'mousemove'\r\n                            | 'mouseout' | 'mouseover' | 'scroll'\r\n                            | 'touchstart' | 'touchmove' | 'touchend'\r\n                            | 'change' | 'input' | 'focus' | 'blur';\r\n\r\nexport interface IGuiEvent {\r\n    x?: number;\r\n    y?: number;\r\n    target: Canvas2DElement;\r\n    relatedTarget?: Canvas2DElement;\r\n    cancelBubble?: boolean;\r\n}\r\n\r\nexport class EventFul {\r\n    private _handlers: {[type: string]: Set<Function>} = {};\r\n\r\n    on(type: EventType, fn: Function) {\r\n        (this._handlers[type] || (this._handlers[type] = new Set())).add(fn);\r\n\r\n        return this;\r\n    }\r\n\r\n    off(type: EventType, fn: Function) {\r\n        const handlers = this._handlers[type];\r\n        if(handlers) {\r\n            handlers.delete(fn);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    notify(type: EventType, event: Event, guiEvent: IGuiEvent, context: Canvas2DElement) {\r\n        const handlers = this._handlers[type];\r\n        if(handlers) {\r\n            handlers.forEach(fn => fn.call(context, guiEvent, event));\r\n        }\r\n\r\n        return guiEvent.cancelBubble;\r\n    }\r\n\r\n    dispose() {\r\n        this._handlers = {};\r\n    }\r\n}","\r\n\r\n// 画一个圆弧\r\nexport function ellipse(\r\n    ctx: CanvasRenderingContext2D,\r\n    cx: number, cy: number,\r\n    rx: number, ry: number,\r\n    startAngle: number, endAngle: number,\r\n    rotation: number,\r\n    anticlockwise: number,\r\n){\r\n    if(Math.abs(rx - ry) > Number.EPSILON * 2 ** 10){ // 椭圆\r\n        ctx.save();\r\n\r\n        const scaleX = rx > ry ? 1 : rx / ry;\r\n        const scaleY = rx > ry ? ry / rx : 1;\r\n\r\n        ctx.translate(cx, cy);\r\n        ctx.rotate(rotation);\r\n        ctx.scale(scaleX, scaleY);\r\n        ctx.arc(0, 0, Math.max(rx, ry), startAngle, endAngle, !anticlockwise);\r\n\r\n        ctx.restore();\r\n    } else {\r\n        ctx.arc(cx, cy, rx, startAngle, endAngle, !anticlockwise);\r\n    }\r\n}\r\n\r\n/**\r\n * 构建圆角矩形。性能消耗较大, 应减少使用, 或静态时使用\r\n *\r\n * 在 border存在 时圆角处会出现缝隙\r\n * 且 border越大 缝隙越大\r\n */\r\nexport function buildRadiusPath(\r\n    ctx: CanvasRenderingContext2D,\r\n    x: number, y: number,\r\n    w: number, h: number,\r\n    borderRadius: number[]\r\n){\r\n    const radius = borderRadius.map(v => {\r\n        const res = [v, v];\r\n        if(v <= 1) {\r\n            res[0] *= w;\r\n            res[1] *= h;\r\n        }\r\n        res[0] = Math.min(res[0], w / 2);\r\n        res[1] = Math.min(res[1], h / 2);\r\n\r\n        return res;\r\n    });\r\n\r\n    ctx.moveTo(x + w, y + radius[1][1]);\r\n\r\n    // 右上\r\n    ellipse(ctx, x + w - radius[1][0], y + radius[1][1], radius[1][0], radius[1][1], 0, -Math.PI / 2, 0, 0);\r\n    // 上\r\n    if(Math.abs(radius[0][0] - w + radius[1][0]) > 1e-3){\r\n        ctx.lineTo(x + radius[0][0], y);\r\n    }\r\n\r\n    // 左上\r\n    ellipse(ctx, x + radius[0][0], y + radius[0][1], radius[0][0], radius[0][1], -Math.PI / 2, Math.PI, 0, 0);\r\n    // 左\r\n    if(Math.abs(h - radius[0][1] - radius[3][1]) > 1e-3) {\r\n        ctx.lineTo(x, y + h - radius[3][1]);\r\n    }\r\n\r\n    // 左下\r\n    ellipse(ctx, x + radius[3][0], y + h - radius[3][1], radius[3][0], radius[3][1], Math.PI, Math.PI / 2, 0, 0);\r\n    // 下\r\n    if(Math.abs(w - radius[2][0] - radius[3][0]) > 1e-3) {\r\n        ctx.lineTo(x + w - radius[2][0], y + h);\r\n    }\r\n\r\n    // 右下\r\n    ellipse(ctx, x + w - radius[2][0], y + h - radius[2][1], radius[2][0], radius[2][1], Math.PI / 2, 0, 0, 0);\r\n    // 右\r\n    if(Math.abs(radius[1][1] - h + radius[2][1]) > 1e-3) {\r\n        ctx.lineTo(x + w, y + radius[1][1]);\r\n    }\r\n}\r\n\r\n/**\r\n * 创建路径, 可用于检测一个点是否在节点内部\r\n */\r\nexport function buildPath(\r\n    ctx: CanvasRenderingContext2D,\r\n    x: number, y: number,\r\n    width: number, height: number,\r\n    borderRadius?: number[]\r\n){\r\n    ctx.beginPath();\r\n    if(borderRadius){\r\n        buildRadiusPath(ctx, x, y, width, height, borderRadius);\r\n    } else {\r\n        ctx.rect(x, y, width, height);\r\n    }\r\n    ctx.closePath();\r\n}","/**\r\n * 2维向量\r\n */\r\nimport { Matrix } from \"./matrix\";\r\nimport { Transform } from \"./transform\";\r\n\r\nexport class Vector2 extends Transform {\r\n    constructor(public x: number = 0, public y: number = x) { super(); }\r\n\r\n    /**\r\n     * 使用x及y的最小值创建2维向量\r\n     */\r\n    static createMin(x: number[] | number, y: number[] | number) {\r\n        if(!Array.isArray(x)) {\r\n            x = [x];\r\n        }\r\n        if(!Array.isArray(y)) {\r\n            y = [y];\r\n        }\r\n\r\n        return new Vector2(Math.min(...x), Math.min(...y));\r\n    }\r\n\r\n    /**\r\n     * 使用x及y的最大值创建2维向量\r\n     */\r\n    static createMax(x: number[] | number, y: number[] | number) {\r\n        if(!Array.isArray(x)) {\r\n            x = [x];\r\n        }\r\n        if(!Array.isArray(y)) {\r\n            y = [y];\r\n        }\r\n\r\n        return new Vector2(Math.max(...x), Math.max(...y));\r\n    }\r\n\r\n    toMin(v: Vector2){\r\n        this.x = Math.min(v.x, this.x);\r\n        this.y = Math.min(v.y, this.y);\r\n\r\n        return this;\r\n    }\r\n\r\n    toMax(v: Vector2){\r\n        this.x = Math.max(v.x, this.x);\r\n        this.y = Math.max(v.y, this.y);\r\n\r\n        return this;\r\n    }\r\n\r\n    /** 向量变换, 右乘矩阵 */\r\n    transform(m: Matrix | number[][]){\r\n        if(m instanceof Matrix){\r\n            m = m.toArray();\r\n        }\r\n        this.x = m[0][0] * this.x + m[0][1] * this.y + m[0][2];\r\n        this.y = m[1][0] * this.x + m[1][1] * this.y + m[1][2];\r\n\r\n        return this;\r\n    }\r\n}","/**\r\n * 节点基类\r\n * 各尺寸尽可能为偶数\r\n */\r\n\r\nimport { Matrix } from \"../lib/matrix\";\r\nimport { Layer } from \"../layer\";\r\nimport { Container } from \"./container\";\r\nimport { BoundingRect } from \"../core/bounding_rect\";\r\nimport { Style, Istyle } from \"../core/style\";\r\nimport { parseSize } from \"../core/dom\";\r\nimport { Canvas2DAnimation } from \"../animation/animation\";\r\nimport { EventFul, IGuiEvent, EventType } from \"../core/event\";\r\nimport { createId, removeId } from \"../tool/util\";\r\nimport { buildPath } from \"../tool/paint\";\r\nimport { Vector2 } from \"../lib/vector\";\r\n\r\nexport class Canvas2DElement {\r\n    readonly type: string = 'element';\r\n\r\n    index: number = 0; // 在父容器内部的添加顺序\r\n    parent?: Container;\r\n    layer?: Layer;\r\n\r\n    transform = new Matrix();\r\n    rect?: BoundingRect;\r\n    events = new EventFul();\r\n\r\n    isVisible: boolean = true; // 是否可见\r\n    style: Style = new Style();\r\n    origin: number[] = [0, 0]; // update时计算出的变换中心\r\n    width: number = 0; // 通过calcSize计算出的width\r\n    height: number = 0; // 通过calcSize计算出的height\r\n    left?: number; // 存在时覆盖style.left设置\r\n    top?: number;// 存在时覆盖style.top设置\r\n\r\n    _cached?: HTMLCanvasElement; // 缓存节点\r\n\r\n    protected _needUpdate: boolean = true; // 是否需要执行update\r\n    private _hadCalc: boolean = false;\r\n\r\n    private _animation?: Canvas2DAnimation;\r\n    private _parentWidth: number = 0;\r\n    private _parentHeight: number = 0;\r\n\r\n    private _ignore: boolean = true; // 最近一次绘制是否忽略了此节点的绘制\r\n    private _dirty: boolean = true;\r\n    private _checkedPoint: Map<string, boolean> = new Map(); // 已检测过是否包含的点及其结果\r\n\r\n    constructor(public id: string | number, public isStatic: boolean = false) {\r\n        this.id = createId(id);\r\n    }\r\n\r\n    get needUpdate() {\r\n        return this._needUpdate;\r\n    }\r\n\r\n    set needUpdate(needUpdate: boolean) {\r\n        this._needUpdate = needUpdate;\r\n    }\r\n\r\n    get animation() {\r\n        return this._animation;\r\n    }\r\n\r\n    set animation(animation: Canvas2DAnimation) {\r\n        if(animation !== this._animation) {\r\n            if(this._animation) {\r\n                this._animation.el.delete(this);\r\n            }\r\n\r\n            this._animation = animation;\r\n            animation && animation.addElement(this);\r\n        }\r\n    }\r\n\r\n    dispose() {\r\n        if(this.layer) {\r\n            this.layer.remove(this, false);\r\n        }\r\n\r\n        if(this.parent){\r\n            this.parent.remove(this, false);\r\n        }\r\n\r\n        this.events.dispose();\r\n        this.style.dispose();\r\n        if(this._animation) {\r\n            this._animation.el.delete(this);\r\n        }\r\n\r\n        this._cached\r\n        = this._animation\r\n        = this.layer\r\n        = this.parent\r\n        = null;\r\n\r\n        removeId(this.id);\r\n    }\r\n\r\n    async draw(ctx: CanvasRenderingContext2D){\r\n        this.beforeUpdate();\r\n        await this.getBoundingRect();\r\n        this.afterUpdate();\r\n\r\n        const isPaint = this.isPaint();\r\n        if(isPaint) {\r\n            this.beforeBuild();\r\n\r\n            if(!this.isStatic){\r\n                this._cached = null;\r\n            }\r\n            this._cached = this._cached || await this.buildCached();\r\n            this.setTransform(ctx);\r\n            this.style.setAlpha(ctx);\r\n            ctx.drawImage(this._cached, 0, 0, this._cached.width, this._cached.height);\r\n\r\n            if(!this.isStatic){\r\n                this._cached = null;\r\n            }\r\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n            this.afterBuild();\r\n        }\r\n\r\n        return isPaint;\r\n    }\r\n\r\n    /**\r\n     * 设置节点样式\r\n     */\r\n    attr(key: string | Istyle, value?: any){\r\n        if(typeof key === 'string') {\r\n            key = {[key]: value};\r\n        }\r\n\r\n        let isEqual: boolean = true;\r\n        for(const [k, v] of Object.entries(key)){\r\n            if(!this.style.equal(k, v)) {\r\n                isEqual = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(!isEqual) {\r\n            if(this.style.set(key, value)){\r\n                this.needUpdate = true;\r\n            }\r\n\r\n            this.markDirty();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 获取节点AABB类包围盒\r\n     */\r\n    async getBoundingRect() {\r\n        if(this._needUpdate) {\r\n            await this.update();\r\n\r\n            this.rect = new BoundingRect(0, 0, this.width, this.height)\r\n                            .transform(this.transform);\r\n\r\n            this._needUpdate = false;\r\n        }\r\n\r\n        return this.rect;\r\n    };\r\n\r\n    /**\r\n     * 标记节点所在的层需要重绘\r\n     */\r\n    markDirty(){\r\n        if(!this._dirty) {\r\n            this._dirty = true;\r\n            if(this.parent){\r\n                this.parent.markDirty();\r\n            }\r\n            if(this.layer){\r\n                this.layer.dirty = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 触发事件\r\n     * @param type 事件类型\r\n     */\r\n    notifyEvent(type: EventType, event: Event, guiEvent: IGuiEvent) {\r\n        let skip = this.events.notify(type, event, guiEvent, this);\r\n        skip = skip || ['change', 'input', 'foucs', 'blur', 'scroll'].includes(type);\r\n\r\n        if(this.parent && !skip) {\r\n            this.parent.notifyEvent(type, event, guiEvent);\r\n        }\r\n    }\r\n\r\n    // ========================钩子函数\r\n    beforeUpdate() {\r\n        this._ignore = true;\r\n    }\r\n\r\n    async update(){\r\n        this._parentWidth = this._getBaseSize('width');\r\n        this._parentHeight = this._getBaseSize('height');\r\n\r\n        if(!(this.isStatic && this._cached)){\r\n            if(!this._hadCalc) {\r\n                await this.calcSize();\r\n            }\r\n\r\n            this.style.border = Math.min(this.style.border, this.width / 2, this.height / 2);\r\n            if(this.style.border < 0){\r\n                this.style.border = 0;\r\n            }\r\n\r\n            this.origin[0] = this.style.origin[0] * this.width;\r\n            this.origin[1] = this.style.origin[1] * this.height;\r\n        }\r\n\r\n        this.updateTransform();\r\n\r\n        this._checkedPoint.clear();\r\n    }\r\n\r\n    afterUpdate(){\r\n        this._dirty = this._hadCalc = false;\r\n    }\r\n\r\n    beforeBuild() {}\r\n\r\n    async build(ctx: CanvasRenderingContext2D) {\r\n        const border = this.style.border;\r\n        let width = this.width - border;\r\n        let height = this.height - border;\r\n\r\n        buildPath(ctx, 0, 0, width, height, this.style.borderRadius);\r\n        await this.style.build(ctx, width, height);\r\n\r\n        if(this.style.background){\r\n            ctx.fill();\r\n        }\r\n\r\n        if(border && this.style.borderColor){\r\n            ctx.stroke();\r\n        }\r\n    }\r\n\r\n    afterBuild() {\r\n        this._ignore = false;\r\n    }\r\n\r\n    /**\r\n     * 计算节点宽高\r\n     */\r\n    calcSize(){\r\n        this.width = parseSize(this.style.width, this._parentWidth);\r\n        this.height = parseSize(this.style.height, this._parentHeight);\r\n\r\n        this._hadCalc = true;\r\n    }\r\n\r\n    // 更新变换矩阵\r\n    updateTransform(){\r\n        const style = this.style;\r\n\r\n        let x: number = this.left, y: number = this.top;\r\n        if(x == null) {\r\n            if(style.left != null) {\r\n                x = parseSize(style.left, this._parentWidth);\r\n            } else if(style.right != null){\r\n                x = this._parentWidth - parseSize(style.right, this._parentWidth) - this.width;\r\n            } else { // x方向没有任何设置, 默认居中\r\n                x = parseSize('50%', this._parentWidth) - this.width / 2;\r\n            }\r\n        }\r\n\r\n        if(y == null) {\r\n            if(style.top != null) {\r\n                y = parseSize(style.top, this._parentHeight);\r\n            } else if(style.bottom != null){\r\n                y = this._parentHeight - parseSize(style.bottom, this._parentHeight) - this.height;\r\n            } else {// y方向没有任何设置, 默认居中\r\n                y = parseSize('50%', this._parentHeight) - this.height / 2;\r\n            }\r\n        }\r\n\r\n        this.transform\r\n            .toUnit()\r\n            .translate(-this.origin[0], -this.origin[1]) // 变换中心\r\n            .scale(style.scale) // 缩放\r\n            .rotate(style.rotation) // 旋转\r\n            .translate(x + this.origin[0], y + this.origin[1]); // 平移\r\n\r\n        // 父节点变换\r\n        if(this.parent){\r\n            const parent = this.parent;\r\n            this.transform\r\n                .translate(parent.style.border, parent.style.border)\r\n                .transform(parent.transform);\r\n        }\r\n    }\r\n    // =============================================================\r\n\r\n    /**\r\n     * 缓存绘制\r\n     */\r\n    async buildCached(\r\n        width: number = this.width,\r\n        height: number = this.height,\r\n        start: Vector2 = new Vector2()\r\n    ) {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        const cachedCtx = canvas.getContext('2d');\r\n        cachedCtx.translate(this.style.border / 2 + start.x, this.style.border / 2 + start.y);\r\n        await this.build(cachedCtx);\r\n\r\n        return canvas;\r\n    }\r\n\r\n    /**\r\n     * 获取鼠标在哪个元素上\r\n     */\r\n    getTarget(ctx: CanvasRenderingContext2D, x: number, y: number){\r\n        if(this._contain(ctx, x, y)){\r\n            return <Canvas2DElement>this;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 设置画布变换\r\n     */\r\n    setTransform(ctx: CanvasRenderingContext2D){\r\n        const transform = new Matrix().copy(this.transform);\r\n        if(this.parent) {\r\n            transform.transform(this.parent.transform.invert());\r\n        }\r\n\r\n        const {a, b, c, d, e, f} = transform;\r\n        ctx.transform(a, b, c, d, e, f);\r\n    }\r\n\r\n    /**\r\n     * 获取父级尺寸\r\n     */\r\n    getParentSize(key: 'width' | 'height') {\r\n        if(key === 'width') {\r\n            return this._parentWidth;\r\n        } else if(key === 'height') {\r\n            return this._parentHeight;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    // 是否需要绘制\r\n    isPaint(){\r\n        if(\r\n            this.isVisible\r\n            && this.style.opacity\r\n            && this.style.scale[0]\r\n            && this.style.scale[1]\r\n            && this.width > 0\r\n            && this.height > 0\r\n        ) {\r\n            const clipParent = this.getParent((parent: Container) => parent.style.clip);\r\n            if(clipParent){\r\n                return this.rect.intersect(clipParent.rect);\r\n            }\r\n\r\n            const parent = this.layer ? this : this.getParent((p: Container) => p.layer);\r\n\r\n            return this.rect.intersect(0, 0, parent.getParentSize('width'),  parent.getParentSize('height'));\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 检测一个点是否落在此节点上\r\n     */\r\n    protected _contain(ctx: CanvasRenderingContext2D, x: number, y: number){\r\n        if(this._ignore) {\r\n            return false;\r\n        }\r\n\r\n        const pk: string = `${x}_${y}`;\r\n        if(this._checkedPoint.has(pk)) {\r\n            return this._checkedPoint.get(pk);\r\n        }\r\n\r\n        if(this.rect && !this.rect.contain(x, y)) {\r\n            this._checkedPoint.set(pk, false);\r\n            return false;\r\n        }\r\n\r\n        // =======================================处于裁切路径外的点不在此节点上\r\n        const clipParent = this.getParent((parent: Container) => parent.style.clip);\r\n        if(clipParent) {\r\n            const border = clipParent.style.border;\r\n\r\n            ctx.setTransform(clipParent.transform);\r\n            ctx.translate(border, border);\r\n            buildPath(\r\n                ctx, 0, 0,\r\n                clipParent.width - border * 2,\r\n                clipParent.height - border * 2,\r\n                clipParent.style.borderRadius\r\n            );\r\n\r\n            if(!ctx.isPointInPath(x, y)) {\r\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n                this._checkedPoint.set(pk, false);\r\n\r\n                return false;\r\n            }\r\n        }\r\n\r\n        ctx.setTransform(this.transform);\r\n        this.buildPath(ctx);\r\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n        const result = ctx.isPointInPath(x, y);\r\n        this._checkedPoint.set(pk, result);\r\n\r\n        return result;\r\n    }\r\n\r\n    protected buildPath(ctx: CanvasRenderingContext2D) {\r\n        buildPath(ctx, 0, 0, this.width, this.height, this.style.borderRadius);\r\n    }\r\n\r\n    protected getParent(filter: Function) {\r\n        let parent = this.parent;\r\n        while(parent){\r\n            if(filter(parent)){\r\n                return parent;\r\n            }\r\n\r\n            parent = parent.parent;\r\n        }\r\n    }\r\n\r\n    // 计算父节点尺寸\r\n    private _getBaseSize(key: 'width'| 'height'){\r\n        let base: number = 0;\r\n        if(this.parent) {\r\n            base = this.parent[key];\r\n            if(this.parent.style.border) {\r\n                base -= this.parent.style.border * 2;\r\n            }\r\n        } else if(this.layer && this.layer.canvas){\r\n            base = this.layer.canvas[key];\r\n        }\r\n\r\n        return Math.max(0, base);\r\n    }\r\n}","/**\r\n * 容器元素基类\r\n */\r\n\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { Istyle } from \"../core/style\";\r\nimport { findIndexByBinary } from \"../tool/util\";\r\nimport { buildPath } from \"../tool/paint\";\r\nimport { Vector2 } from \"../lib/vector\";\r\nimport { BoundingRect } from \"../core/bounding_rect\";\r\n\r\nexport class Container extends Canvas2DElement {\r\n    readonly type: string = 'container';\r\n\r\n    children: Canvas2DElement[] = [];\r\n\r\n    private _start = new Vector2();\r\n\r\n    get needUpdate() {\r\n        return this._needUpdate;\r\n    }\r\n\r\n    set needUpdate(needUpdate: boolean) {\r\n        if(needUpdate !== this._needUpdate) {\r\n            this._needUpdate = needUpdate;\r\n            if(needUpdate && !(this.isStatic && this._cached)) {\r\n                this.children.forEach(v => v.needUpdate = true);\r\n            }\r\n        }\r\n    }\r\n\r\n    attr(key: string | Istyle, value?: any){\r\n        if(typeof key === 'string') {\r\n            key = {[key]: value};\r\n        }\r\n\r\n        // 带边框的父元素的裁剪会影响子元素的鼠标拾取范围, 这里对其进行了简单处理\r\n        // 只要clip或border可能会改变时就清除所有子元素的拾取缓存\r\n        if(Reflect.has(key, 'clip') || Reflect.has(key, 'border')) {\r\n            this.children.forEach(v => v.needUpdate = true);\r\n        }\r\n\r\n        super.attr(key, value);\r\n\r\n        return this;\r\n    }\r\n\r\n    async build(ctx: CanvasRenderingContext2D){\r\n        await super.build(ctx);\r\n\r\n        if(this.style.clip){\r\n            buildPath(\r\n                ctx,\r\n                this.style.border / 2,\r\n                this.style.border / 2,\r\n                this.width - this.style.border * 2,\r\n                this.height - this.style.border * 2,\r\n                this.style.borderRadius\r\n            );\r\n        }\r\n\r\n        ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n        if(this.style.clip){\r\n            ctx.save();\r\n            ctx.clip();\r\n        }\r\n\r\n        return this._renderChildren(ctx);\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        if(el) {\r\n            const i = this.children.findIndex(v => v === el);\r\n            if(i >= 0){\r\n                el.parent = null;\r\n                this.children.splice(i, 1);\r\n\r\n                if(dispose) {\r\n                    el.dispose();\r\n                }\r\n\r\n                this.markDirty();\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        if(el) {\r\n            const parent = el.parent || el.layer;\r\n\r\n            if(parent !== this) {\r\n                if(parent){\r\n                    parent.remove(el, false);\r\n                }\r\n                el.parent = this;\r\n                el.left = el.top = null;\r\n                el.needUpdate = true;\r\n\r\n                el.index = this.children.length;\r\n                const index = findIndexByBinary(\r\n                    mid => el.style.zIndex - this.children[mid].style.zIndex || 1,\r\n                    this.children.length\r\n                );\r\n                this.children.splice(index, 0, el);\r\n                this.markDirty();\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(){\r\n        super.dispose();\r\n\r\n        this.children.forEach(v => {\r\n            v.parent = null;\r\n            v.dispose();\r\n        });\r\n        this.children.length = 0;\r\n    }\r\n\r\n    setTransform(ctx: CanvasRenderingContext2D){\r\n        super.setTransform(ctx);\r\n        ctx.translate(-this._start.x, -this._start.y);\r\n    }\r\n\r\n    async buildCached(){\r\n        let maxRect = null;\r\n        if(this.style.clip) {\r\n            maxRect = new BoundingRect(0, 0, this.width, this.height);\r\n        } else {\r\n            const invert = this.transform.invert();\r\n            maxRect = (await this._getMaxRect()).transform(invert);\r\n        }\r\n\r\n        this._start.x = -maxRect.x;\r\n        this._start.y = -maxRect.y;\r\n\r\n        return super.buildCached(maxRect.w, maxRect.h, this._start);\r\n    }\r\n\r\n    getTarget(ctx: CanvasRenderingContext2D, x: number, y: number): false | Canvas2DElement {\r\n        for(let i=this.children.length - 1; i>=0; i--){\r\n            const traget = this.children[i].getTarget(ctx, x, y);\r\n\r\n            if(traget) {\r\n                return traget;\r\n            }\r\n        }\r\n\r\n        return this._contain(ctx, x, y) ? this : false;\r\n    }\r\n\r\n    protected _renderChildren(ctx: CanvasRenderingContext2D): Promise<void> {\r\n        return new Promise(resolve => {\r\n            const _render = async (i: number) => {\r\n                const node = this.children[i++];\r\n                if(node){\r\n                    ctx.translate(this._start.x, this._start.y);\r\n                    await node.draw(ctx);\r\n                    _render(i);\r\n                } else {\r\n                    if(this.style.clip){\r\n                        ctx.restore();\r\n                    }\r\n                    resolve();\r\n                }\r\n            }\r\n\r\n            _render(0);\r\n        });\r\n    }\r\n\r\n    async update() {\r\n        await super.update();\r\n\r\n        if(this.needUpdate) {\r\n            let isStaic = this.isStatic;\r\n            let el:Container = this;\r\n            if(!isStaic) {\r\n                el = this.getParent((parent: Container) => parent);\r\n                isStaic = !!el;\r\n            }\r\n\r\n            if(isStaic && el._cached) {\r\n                this._updateChildren();\r\n            }\r\n        }\r\n    }\r\n\r\n    private _updateChildren() {\r\n        this.children.forEach(v => {\r\n            v.beforeUpdate();\r\n\r\n            v.needUpdate = true;\r\n            v.getBoundingRect().then(() => {\r\n                v.afterUpdate();\r\n\r\n                if(v.isPaint()) {\r\n                    v.beforeBuild();\r\n                    v.afterBuild();\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    private async _getMaxRect() {\r\n        const rect = (await this.getBoundingRect()).clone();\r\n        for(const v of this.children) {\r\n            const other =  await (v instanceof Container ?  v._getMaxRect() :  v.getBoundingRect());\r\n            rect.extend(other);\r\n        }\r\n\r\n        return rect;\r\n    }\r\n}","/**\r\n * canvas层\r\n */\r\nimport { Canvas2DElement } from \"./node/element\";\r\nimport { createCanvas } from \"./core/dom\";\r\nimport { findIndexByBinary } from \"./tool/util\";\r\nimport { devicePixelRatio } from './config';\r\nimport { Container } from \"./node/container\";\r\nexport class Layer {\r\n    canvas?: HTMLCanvasElement;\r\n    dirty: boolean = true; // 是否需要绘制\r\n\r\n    private roots: Canvas2DElement[] = [];\r\n    private ctx?: CanvasRenderingContext2D;\r\n    private _time: number = 0; // 最近一次绘制开始时间\r\n\r\n    private _drawCanvas?: HTMLCanvasElement;\r\n    private _view?:CanvasRenderingContext2D;\r\n\r\n    constructor(width: number, height: number, public z: number = 0) {\r\n        this.canvas = createCanvas(width, height, 'layer' + z);\r\n        this._drawCanvas = createCanvas(width, height, 'layer_draw_' + z)\r\n        this.ctx = this._drawCanvas.getContext('2d');\r\n        this._view = this.canvas.getContext('2d');\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        if(el) {\r\n            const parent = el.parent || el.layer;\r\n            if(parent !== this){\r\n                if(parent) {\r\n                    parent.remove(el, false);\r\n                }\r\n\r\n                el.layer = this;\r\n                el.needUpdate = true;\r\n                el.left = el.top = null;\r\n\r\n                const index = findIndexByBinary(\r\n                    mid => el.style.zIndex - this.roots[mid].style.zIndex || 1,\r\n                    this.roots.length\r\n                );\r\n                this.roots.splice(index, 0, el);\r\n\r\n                this.dirty = true;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        if(el) {\r\n            const i: number = this.roots.findIndex(v => v === el);\r\n            if(i >= 0) {\r\n                el.layer = null;\r\n                this.roots.splice(i, 1);\r\n\r\n                if(dispose) {\r\n                    el.dispose();\r\n                }\r\n\r\n                this.dirty = true;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(dom: HTMLElement){\r\n        this.roots.forEach(v => {\r\n            v.layer = null;\r\n            v.dispose();\r\n        });\r\n        this.roots.length = 0;\r\n\r\n        dom.removeChild(this.canvas);\r\n        this.canvas = this.ctx = this._drawCanvas = null;\r\n    }\r\n\r\n    beforeRender() {}\r\n    render(){\r\n        this.beforeRender();\r\n        if(this.dirty){\r\n            this.dirty = false;\r\n\r\n            this._time = Date.now();\r\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n            this._render(0);\r\n        }\r\n    }\r\n    afterRender() {\r\n        this._view.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this._view.drawImage(this._drawCanvas, 0, 0);\r\n    }\r\n\r\n    getTarget(x: number, y: number){\r\n        for(let i=this.roots.length - 1; i>=0; i--){\r\n            const traget = this.roots[i].getTarget(this.ctx, x, y);\r\n\r\n            if(traget) {\r\n                return traget;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    resize(width: number, height: number) {\r\n        this.dirty = true;\r\n\r\n        this._resize(width, height, this.canvas);\r\n        this._resize(width, height, this._drawCanvas);\r\n\r\n        this.roots.forEach(v => {\r\n            this._clearCached(v);\r\n            v.needUpdate = true;\r\n        });\r\n    }\r\n\r\n    private _clearCached(node: Canvas2DElement) {\r\n        node._cached = null;\r\n\r\n        if(node instanceof Container) {\r\n            node.children.forEach(this._clearCached, this);\r\n        }\r\n    }\r\n\r\n    private _resize(width: number, height: number, canvas: HTMLCanvasElement) {\r\n        Object.assign(canvas.style, {\r\n            width: `${width}px`,\r\n            height: `${height}px`\r\n        })\r\n\r\n        canvas.width = width * devicePixelRatio;\r\n        canvas.height = height * devicePixelRatio;\r\n    }\r\n\r\n    private async _render(i: number){\r\n        const node = this.roots[i++];\r\n\r\n        if(node){\r\n            await node.draw(this.ctx);\r\n            this._render(i);\r\n        } else {\r\n            this.afterRender();\r\n        }\r\n    }\r\n}","import { Layer } from \"./layer\";\r\nimport { addHandler, getPosition, removeHandler } from \"./core/dom\";\r\nimport { IGuiEvent, EventType } from \"./core/event\";\r\nimport { Canvas2DElement } from \"./node/element\";\r\nimport { devicePixelRatio } from './config';\r\n\r\n// =============================================\r\nconst eventNames: EventType[] = [\r\n    'dbclick', 'click', 'mousedown', 'mouseup', 'mousemove',\r\n    'touchstart', 'touchmove', 'touchend'\r\n];\r\n// ===============================================\r\nexport class Engine {\r\n    private _layers: Map<number, Layer> = new Map();\r\n    private _timer?: number;\r\n    private _preTarget?: Canvas2DElement;\r\n    private _isOut: boolean = false;\r\n\r\n    constructor(private _root: HTMLElement) {\r\n        Object.assign(_root.style, {\r\n            '-webkit-tap-highlight-color': 'transparent',\r\n            '-webkit-user-select': 'none',\r\n            'user-select': 'none',\r\n            '-webkit-touch-callout': 'none',\r\n            'touch-action': 'none'\r\n        })\r\n        _root.innerHTML = '';\r\n        if(!['relative', 'absolute', 'fixed'].includes(_root.style.position)){\r\n            _root.style.position = 'relative';\r\n        }\r\n\r\n        eventNames.forEach((type : EventType) => {\r\n            addHandler(this._root, type, this._eventHandler);\r\n        })\r\n        addHandler(_root, 'mouseleave', this._leave);\r\n        addHandler(_root, 'mouseenter', this._enter);\r\n    }\r\n\r\n    get width() {\r\n        return this._root ? this._root.offsetWidth : 0;\r\n    }\r\n\r\n    get height() {\r\n        return this._root ? this._root.offsetHeight : 0;\r\n    }\r\n\r\n    getLayer(z: number){\r\n        return this._layers.get(z);\r\n    }\r\n\r\n    render(){\r\n        this._layers.forEach(v => v.render());\r\n\r\n        if(this._root){\r\n            this._timer = requestAnimationFrame(this.render.bind(this));\r\n        }\r\n    }\r\n\r\n    addLayer(layer: Layer | number){\r\n        let z: number = typeof layer === 'number' ? layer : layer.z;\r\n        if(this._layers.has(z)) {\r\n            console.warn(`层级${z}已存在`);\r\n        } else {\r\n            if(typeof layer === 'number'){\r\n                layer = new Layer(this._root.offsetWidth, this._root.offsetHeight, layer);\r\n            }\r\n\r\n            this._addLayerToDom(layer)._layers.set(z, layer);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    replaceLayer(layer: Layer){\r\n        const old = this._layers.get(layer.z);\r\n        if(old){\r\n            old.dispose(this._root);\r\n        }\r\n        this._addLayerToDom(layer)._layers.set(layer.z, layer);\r\n\r\n        return this;\r\n    }\r\n\r\n    removeLayer(layer: Layer | number){\r\n        const z: number = typeof layer === 'number' ? layer : layer.z;\r\n        const curLayer = this._layers.get(z);\r\n        if(curLayer){\r\n            curLayer.dispose(this._root);\r\n            this._layers.delete(z);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(){\r\n        if(this._timer) {\r\n            cancelAnimationFrame(this._timer);\r\n        }\r\n        this._layers.forEach(this.removeLayer, this);\r\n\r\n        if(this._root) {\r\n            eventNames.forEach((type : EventType) => {\r\n                removeHandler(this._root, type, this._eventHandler);\r\n            })\r\n            removeHandler(this._root, 'mouseleave', this._leave);\r\n            removeHandler(this._root, 'mouseenter', this._enter);\r\n        }\r\n        this._root = this._preTarget = null;\r\n    }\r\n\r\n    resize() {\r\n        this._layers.forEach(v => v.resize(this._root.offsetWidth, this._root.offsetHeight));\r\n    }\r\n\r\n    private _addLayerToDom(layer: Layer){\r\n        for(const v of Array.from(this._layers.values())){\r\n            if(v.z > layer.z){\r\n                this._root.insertBefore(layer.canvas, v.canvas);\r\n\r\n                return this;\r\n            }\r\n        }\r\n\r\n        this._root.appendChild(layer.canvas);\r\n\r\n        return this;\r\n    }\r\n\r\n    private _getTarget(x: number, y: number) {\r\n        const layers = Array.from(this._layers.keys()).sort((a, b) => b - a);\r\n        for(const layer of layers) {\r\n            const target = this._layers.get(layer).getTarget(x, y);\r\n\r\n            if(target) {\r\n                return target;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _eventHandler = (e: Event) =>{\r\n        if(!this._isOut) {\r\n            e = e || window.event;\r\n            let {x, y} = getPosition(this._root, <MouseEvent>e);\r\n            x *= devicePixelRatio;\r\n            y *= devicePixelRatio;\r\n            const target = this._getTarget(x, y);\r\n            const guiEvent:IGuiEvent = {x, y, target, cancelBubble: false};\r\n            if(e.type === 'mousemove' || e.type === 'touchmove') {\r\n                this._moveHandler(guiEvent, e, e.type);\r\n            }\r\n\r\n            if(target && e.type !== 'mousemove' && e.type !== 'touchmove') {\r\n                target.notifyEvent(<EventType>e.type, e, guiEvent);\r\n            }\r\n        }\r\n    }\r\n    private _moveHandler(guiEvent: IGuiEvent, e: Event, type: 'mousemove' | 'touchmove') {\r\n        if(this._preTarget === guiEvent.target) {\r\n            guiEvent.target && guiEvent.target.notifyEvent(type, e, guiEvent);\r\n        } else {\r\n            if(this._preTarget) {\r\n                this._preTarget.notifyEvent('mouseout', e, {...guiEvent, relatedTarget: guiEvent.target});\r\n            }\r\n            if(guiEvent.target) {\r\n                guiEvent.target.notifyEvent('mouseover', e, {...guiEvent, relatedTarget: this._preTarget});\r\n            }\r\n        }\r\n\r\n        this._preTarget = guiEvent.target;\r\n    };\r\n    private _leave = () => this._isOut = true;\r\n    private _enter = () => this._isOut = false;\r\n}","/**\r\n * 图片节点\r\n */\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { Istyle } from \"../core/style\";\r\nimport { parseSize } from \"../core/dom\";\r\nimport { isZero } from \"../tool/util\";\r\n\r\nexport class Canvas2DImage extends Canvas2DElement {\r\n    readonly type: string = 'image';\r\n\r\n    private _cellId: number = -1;\r\n    private _cellWidth?: number | string;\r\n    private _cellHeight?: number | string;\r\n\r\n    constructor(id: string | number, isStatic?: boolean) {\r\n        super(id, isStatic);\r\n\r\n        this.style.width = this.style.height = 0; // 清除默认宽高设置\r\n    }\r\n\r\n    attr(key: string | Istyle, value?: any) {\r\n        if(typeof key === 'string') {\r\n            key = {[key]: value};\r\n        }\r\n        this._setCell(key);\r\n        const modyfySrc = Reflect.has(key, 'src') && key.src !== this.style.src;\r\n\r\n        super.attr(key, value);\r\n        if(modyfySrc && !(this.style.width && this.style.height)) {\r\n            this.needUpdate = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    async build(ctx: CanvasRenderingContext2D) {\r\n        const img = await this.style.loadImg();\r\n        if(img) {\r\n            const sw: number = Math.min(parseSize(this._cellWidth, img.width), img.width),\r\n                sh: number = Math.min(parseSize(this._cellHeight, img.height), img.height);\r\n\r\n            if(this._cellId >= 0 && sw > 0 && sh > 0) { // 精灵图\r\n                const cw: number = Math.floor(this._cellId + 1) * sw;\r\n                let sx: number = (cw % img.width) - sw,\r\n                    sy: number = Math.floor(cw / img.width) * sh;\r\n                if(isZero(cw % img.width)) {\r\n                    sx = img.width - sw;\r\n                    sy -= sh;\r\n                }\r\n                sx = Math.max(Math.min(sx, img.width - sw), 0);\r\n                sy = Math.max(Math.min(sy, img.height - sh), 0);\r\n\r\n                ctx.drawImage(img, sx, sy, sw, sh, 0, 0, this.width, this.height);\r\n            } else { // 整图\r\n                ctx.drawImage(img, 0, 0, this.width, this.height);\r\n            }\r\n        }\r\n    }\r\n\r\n    update(){\r\n        this.style.background = '';\r\n        this.style.border = 0; // 图片没有边框，如果需要有，可使用Container的背景图\r\n\r\n        return super.update();\r\n    }\r\n\r\n    async calcSize() {\r\n        super.calcSize();\r\n\r\n        // 图片尺寸默认为其原尺寸等比缩放\r\n        if(this.width <= 0 || this.height <= 0) {\r\n            const img = await this.style.loadImg();\r\n\r\n            if(img) {\r\n                if(this.width <= 0 && this.height <= 0) {\r\n                    this.width = img.width;\r\n                    this.height = img.height;\r\n                } else if(this.width <= 0) {\r\n                    this.width = this.height * img.width / img.height;\r\n                } else if(this.height <= 0) {\r\n                    this.height = this.width * img.height / img.width;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private _setCell(data: Istyle) {\r\n        ['cellId', 'cellWidth', 'cellHeight'].forEach(k => {\r\n            if(Reflect.has(data, k)) {\r\n                Reflect.set(this, `_${k}`, Reflect.get(data, k));\r\n                Reflect.deleteProperty(data, k);\r\n            }\r\n        });\r\n    }\r\n}","/**\r\n * 文本相关\r\n */\r\nimport { cached } from \"../tool/util\";\r\nimport { getContext } from \"./dom\";\r\n\r\nexport const getWidth = cached((text: string, font: string) => {\r\n    return text.split('\\n').reduce((a, b) => Math.max(a, measureText(b, font)), 0);\r\n}, 5000);\r\n\r\nexport function getLineHeight(font: string){\r\n    return getWidth('国', font);\r\n}\r\n\r\nconst measureText = cached((text: string, font: string) => {\r\n    const ctx = getContext(null);\r\n    if(font && ctx.font !== font) {\r\n        ctx.font = font;\r\n    }\r\n\r\n    return ctx.measureText(text).width;\r\n})","/**\r\n * 文本\r\n * 解析文本性能消耗较大，大段文本尽可能使用静态文本\r\n */\r\n/// <reference path=\"./text.d.ts\" />\r\n\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { makeCheckExist } from \"../tool/util\";\r\nimport { getLineHeight, getWidth } from \"../core/text\";\r\nimport { devicePixelRatio } from '../config';\r\nimport { isEqual } from \"../tool/color\";\r\n// ==================================================\r\n\r\nconst isFontStyle = makeCheckExist('fontStyle fontVariant fontWeight fontSize fontFamily');\r\nconst canModifyTextMap = makeCheckExist('lineHeight letterSpacing textWarp indent strokeWidth text');\r\n\r\n// ============================================\r\nexport class TextBlock extends Canvas2DElement {\r\n    readonly type: string = 'text';\r\n\r\n    text: string = '';\r\n    textMap: TextMap[] = [];\r\n\r\n    private _textAlign: TextAlign = 'left'; // 文本横向对齐\r\n    private _verticalAlign: VerticalAlign = 'top';// 文本垂直对齐\r\n\r\n    private _strokeColor?: string | CanvasGradient = 'rgba(0, 0, 0, 1)'; // 描边颜色\r\n    private _strokeWidth: number = 0; // 描边宽度\r\n    private _lineHeight: number = 0; // 行高\r\n    private _letterSpacing: number = 0; // 字间距\r\n    private _textWarp: TextWarp = 'warp'; // 是否换行\r\n    private _indent: number = 0;\r\n\r\n    private _font: string[] = [null, null, null, '12px', 'sans-serif']; // 文本设置\r\n\r\n    private _modifyText: boolean = false;\r\n\r\n    constructor(id: string | number, isStatic: boolean = true) {\r\n        super(id, isStatic);\r\n\r\n        this.style.height = 0; // 清除默认高设置\r\n        this.style.color = ''; // 默认使用父级颜色\r\n    }\r\n\r\n    set fontStyle(style: FontStyle) {\r\n        this._setFont(style, 0);\r\n    }\r\n\r\n    set fontVariant(style: 'normal' | 'small-caps') {\r\n        this._setFont(style, 1);\r\n    }\r\n\r\n    set fontWeight(style: FontWeight) {\r\n        if(typeof style === 'number') {\r\n            style = <FontWeight>`${style}`;\r\n        }\r\n\r\n        this._setFont(<string>style, 2);\r\n    }\r\n\r\n    set fontSize(style: number | string) {\r\n        if(typeof style === 'number') {\r\n            style = style * devicePixelRatio + 'px';\r\n        } else {\r\n            style = style.replace(\r\n                /^(\\d+)(.*)$/,\r\n                (_: string, size: string, symbol: string) => {\r\n                    return +(size || 12) * devicePixelRatio + (symbol || 'px')\r\n                }\r\n            );\r\n        }\r\n\r\n        this._setFont(style, 3);\r\n    }\r\n\r\n    set fontFamily(style: string) {\r\n        this._setFont(style, 4);\r\n    }\r\n\r\n    async build(ctx: CanvasRenderingContext2D) {\r\n        const last = this.textMap[this.textMap.length - 1];\r\n        if(last) {\r\n            if(this.style.background) {\r\n                await super.build(ctx);\r\n            }\r\n\r\n            if(ctx.textBaseline !== 'top') {\r\n                ctx.textBaseline = 'top';\r\n            }\r\n\r\n            const color = this.style.color || (this.parent ? this.parent.style.color : '');\r\n            if(color && !isEqual(ctx.fillStyle, color)) {\r\n                ctx.fillStyle = color;\r\n            }\r\n            if(this._strokeWidth && !isEqual(ctx.strokeStyle, this._strokeColor)) {\r\n                ctx.strokeStyle = this._strokeColor;\r\n            }\r\n\r\n            const font = this._font.filter(v => v != null && v !== '').join(' ');\r\n            if(font && ctx.font !== font) {\r\n                ctx.font = font;\r\n            }\r\n\r\n            this.textMap.forEach(v => {\r\n                const x = this._adjustX(last, v);\r\n                const y = this._adjustY(last, v);\r\n                if(this._strokeWidth) {\r\n                    ctx.strokeText(v.char, x, y);\r\n                }\r\n                ctx.fillText(v.char, x, y);\r\n            })\r\n        }\r\n\r\n        if(this.isStatic) {\r\n            this.textMap.length = 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置文本样式\r\n     */\r\n    setTextStyle(key: string | TextStyle, value?: any) {\r\n        this._modifyText = false;\r\n        if(typeof key === 'string') {\r\n            this._setTextStyle([key, value]);\r\n        } else {\r\n            Object.entries(key).forEach(this._setTextStyle, this);\r\n        }\r\n\r\n        if(this._modifyText && !this.isStatic) {\r\n            if(\r\n                !this.style.height && this.style.top == null\r\n                || !this.style.width && this.style.left == null\r\n            ){\r\n                this.needUpdate = true;\r\n            } else if(!this.needUpdate){\r\n                this._parseText();\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    beforeUpdate() {\r\n        super.beforeUpdate();\r\n\r\n        this.style.border = 0;\r\n    }\r\n\r\n    calcSize(){\r\n        super.calcSize();\r\n\r\n        this._parseText();\r\n\r\n        // 高默认用文本高填充\r\n        if(this.height <= 0) {\r\n            this.height = 0;\r\n\r\n            const last = this.textMap[this.textMap.length - 1];\r\n            if(last) {\r\n                this.height = last.y + last.height;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _parseText() {\r\n        this.textMap.length = 0;\r\n\r\n        // 静态文本只解析一次\r\n        if(this.isStatic && this._cached) {\r\n            this.width = this._cached.width;\r\n            this.height = this._cached.height;\r\n            return;\r\n        }\r\n\r\n        if(this.text) {\r\n            const font = this._font.filter(v => v != null && v !== '').join(' ');\r\n            const lineHeight = (this._lineHeight || getLineHeight(font));\r\n\r\n            if(!(this.style.width && this.width)) {\r\n                this.width = Infinity;\r\n            }\r\n\r\n            const ellipsisWidth = getWidth('...', font);\r\n\r\n            const lines = this.text.replace(/\\n*$/, '').split('\\n');\r\n            const options = { y: 0, lineHeight, font, ellipsisWidth };\r\n\r\n            let maxWidth: number = 0;\r\n            for(const v of lines) {\r\n                this._setTextMap(v, options);\r\n\r\n                const last = this.textMap[this.textMap.length - 1];\r\n                if(last) {\r\n                    maxWidth = Math.max(maxWidth, last.x + last.width);\r\n                }\r\n\r\n                options.y += lineHeight;\r\n\r\n                if(this.height > 0 && options.y > this.height) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if(this.width === Infinity) {\r\n                this.width = maxWidth;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _setTextMap(line: string, options: any) {\r\n        let width: number = 0;\r\n        if(!this.textMap.length) {\r\n            width += this._indent;\r\n        }\r\n\r\n        for(let i=0; i<line.length; i++) {\r\n            if(i) {\r\n                width += this._letterSpacing;\r\n            }\r\n\r\n            const textWidth = getWidth(line[i], options.font) + this._strokeWidth;\r\n            const textData = {\r\n                char: line[i],\r\n                x: width,\r\n                y: options.y,\r\n                width: textWidth,\r\n                height: options.lineHeight\r\n            }\r\n\r\n            width += textWidth;\r\n\r\n            if(width > this.width) {\r\n                if(this._textWarp === 'warp') {\r\n                    textData.x = 0;\r\n                    width = textWidth;\r\n                    textData.y += options.lineHeight;\r\n                    options.y += options.lineHeight;\r\n\r\n                    if(this.height > 0 && options.y > this.height){\r\n                        return;\r\n                    }\r\n                } else {\r\n                    return this._addEllipsis(textData, options.ellipsisWidth);\r\n                }\r\n            } else if(\r\n                this._textWarp === 'ellipsis'\r\n                && i < line.length - 1\r\n                && width + options.ellipsisWidth > this.width\r\n            ) {\r\n                return this._addEllipsis(textData, options.ellipsisWidth);\r\n            }\r\n\r\n            this.textMap.push(textData);\r\n        }\r\n    }\r\n\r\n    private _addEllipsis(textData: TextMap, ellipsisWidth: number) {\r\n        if(this._textWarp === 'ellipsis') {\r\n            textData.char = '...';\r\n            textData.width = ellipsisWidth;\r\n            this.textMap.push(textData);\r\n        }\r\n    }\r\n\r\n    private _setFont(style: string, index: number) {\r\n        const old = this._font[index];\r\n        if(style !== old) {\r\n            this._font[index] = style;\r\n\r\n            this._modifyText = true;\r\n            this.markDirty();\r\n        }\r\n    }\r\n\r\n    private _setTextStyle([key, value]: [string, any]) {\r\n        if(!isFontStyle(key)) {\r\n            const k = key === 'text' ? key : '_' + key;\r\n            if(typeof value === 'number') {\r\n                value *= devicePixelRatio;\r\n            }\r\n\r\n            if(Reflect.get(this, k) !== value) {\r\n                Reflect.set(this, k, value);\r\n\r\n                if(canModifyTextMap(key)) {\r\n                    this._modifyText = true;\r\n                }\r\n\r\n                this.markDirty();\r\n            }\r\n        } else {\r\n            (<any>this)[key] = value;\r\n        }\r\n    }\r\n\r\n    private _adjustX(last: TextMap, data: TextMap) {\r\n        const more = this.width - last.x - last.width;\r\n        if(more > 0 && data.y === last.y) {\r\n            if(this._textAlign === 'center') {\r\n                return data.x + more / 2;\r\n            }\r\n\r\n            if(this._textAlign === 'right') {\r\n                return data.x + more;\r\n            }\r\n        }\r\n\r\n        return data.x;\r\n    }\r\n\r\n    private _adjustY(last: TextMap, data: TextMap) {\r\n        const more = this.height - last.y - last.height;\r\n        if(more > 0) {\r\n            if(this._verticalAlign === 'middle') {\r\n                return data.y + more / 2;\r\n            }\r\n\r\n            if(this._verticalAlign === 'bottom') {\r\n                return data.y + more;\r\n            }\r\n        }\r\n\r\n        return data.y;\r\n    }\r\n}","/**\r\n * 动画\r\n */\r\n\r\nimport { parseColor, stringify } from \"../tool/color\";\r\nimport { isImg } from \"../tool/util\";\r\nimport { Canvas2DElement } from \"../node/element\";\r\nimport { getEasing } from \"./easing\";\r\nimport { Canvas2DImage } from \"../node/image\";\r\n\r\n// =========================================================\r\ninterface AnimationAttr {\r\n    [key: string]: string | number | number[];\r\n}\r\n\r\ninterface AnimationFrame {\r\n    background?: string;\r\n    color?: string;\r\n\r\n    opacity?: number;\r\n\r\n    width?: number | string;\r\n    height?: number | string;\r\n\r\n    rotation?: number;\r\n\r\n    scaleX?: number;\r\n    scaleY?: number;\r\n    scale?: number | number[];\r\n\r\n    left?: number | string;\r\n    right?: number | string;\r\n    top?: number | string;\r\n    bottom?: number | string;\r\n\r\n    cellId?: number;\r\n}\r\n\r\ninterface Msg {\r\n    animation: Canvas2DAnimation,\r\n    isEnd: boolean,\r\n    attrs: Map<string | number, AnimationAttr>\r\n}\r\n\r\n// ===============================================================\r\nconst animationKey = [\r\n    'width', 'height', 'scaleX', 'scaleY', 'rotation', 'left','right',\r\n    'top', 'bottom', 'opacity', 'color', 'background', 'cellId'\r\n];\r\n\r\n// =============================worker\r\nconst worker:Worker = Reflect.construct(require('./play.worker'), []);\r\nworker.addEventListener('message', (event: MessageEvent) => {\r\n    const id: number = event.data.animation.id;\r\n    const animation = animations.get(id);\r\n    if(animation) {\r\n        animation.message(event.data);\r\n    }\r\n})\r\nworker.addEventListener('error', (e: any) => {\r\n    console.error(e);\r\n    worker.terminate();\r\n});\r\n// ================================\r\n\r\nconst animations:Map<number, Canvas2DAnimation> = new Map(); // 所有动画对象\r\n// ========================================================================\r\nexport class Canvas2DAnimation {\r\n    el: Map<Canvas2DElement, AnimationAttr> = new Map();\r\n    id: number = createAnimationId();\r\n\r\n    private _endCall: Set<Function> = new Set();\r\n\r\n    private _startTime: number = 0;\r\n    private _pauseTime: number = 0;\r\n    private _prevTime: number = 0;\r\n    private _isStart: boolean = false;\r\n    private _isPause: boolean = false;\r\n    private _timer?: number;\r\n\r\n    // ===================================可添加动画的属性\r\n    private width: AnimationAttr = {};\r\n    private height: AnimationAttr = {};\r\n    private scaleX: AnimationAttr = {};\r\n    private scaleY: AnimationAttr = {};\r\n    private rotation: AnimationAttr = {};\r\n    private left: AnimationAttr = {};\r\n    private right: AnimationAttr = {};\r\n    private top: AnimationAttr = {};\r\n    private bottom: AnimationAttr = {};\r\n    private opacity: AnimationAttr = {};\r\n    private color: AnimationAttr = {};\r\n    private background: AnimationAttr = {};\r\n    private cellId: AnimationAttr = {};\r\n\r\n    private errKey: Set<string> = new Set();\r\n\r\n    constructor(\r\n        public time: number = 0,\r\n        public count: number = 1,\r\n        public delay: number = 0,\r\n        public easing: string = 'linear'\r\n    ) {\r\n        animations.set(this.id, this);\r\n    }\r\n\r\n    addFrame(frame: number | string, value: AnimationFrame, reWrite: boolean = true) {\r\n        this.errKey.clear();\r\n\r\n        frame = this._parseFrame(frame);\r\n        if(Reflect.has(value, 'scale')) {\r\n            const scale = Array.isArray(value.scale) ? value.scale : [value.scale, value.scale];\r\n            value.scaleX = scale[0];\r\n            value.scaleY = scale[1];\r\n        }\r\n\r\n        animationKey.forEach(k => {\r\n            let attr: any = Reflect.get(value, k);\r\n            const thisAttr = Reflect.get(this, k);\r\n            if(attr !== '' && (reWrite || !Reflect.has(thisAttr, frame))) {\r\n                if(typeof attr === 'number' || typeof attr === 'string') {\r\n                    if(k === 'color' || k === 'background') {\r\n                        attr = parseColor(attr);\r\n                    }\r\n\r\n                    Reflect.set(thisAttr, frame, attr);\r\n                } else if(attr != null){\r\n                    console.warn('只能用number及string类型设置动画');\r\n                }\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    addElement(el: Canvas2DElement) {\r\n        if(!this.el.has(el)) {\r\n            const style = el.style;\r\n            const attr: AnimationAttr = {\r\n                width: style.width,\r\n                height: style.height,\r\n                rotation: style.rotation,\r\n                left: style.left,\r\n                right: style.right,\r\n                top: style.top,\r\n                bottom: style.bottom,\r\n                opacity: style.opacity,\r\n                scaleX: style.scale[0],\r\n                scaleY: style.scale[1],\r\n            };\r\n            if(typeof style.color === 'string') {\r\n                attr.color = parseColor(style.color);\r\n            }\r\n            if(typeof style.background === 'string' && !isImg(style.background)) {\r\n                attr.background = parseColor(style.background);\r\n            }\r\n            if(el instanceof Canvas2DImage) {\r\n                attr.cellId = 0;\r\n            }\r\n            this.el.set(el, attr);\r\n            if(el.animation !== this) {\r\n                el.animation = this;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    addEndCall(fn: Function) {\r\n        this._endCall.add(fn);\r\n\r\n        return this;\r\n    }\r\n    removeEndCall(fn: Function) {\r\n        this._endCall.delete(fn);\r\n\r\n        return this;\r\n    }\r\n    dispose(){\r\n        if(this._timer) {\r\n            cancelAnimationFrame(this._timer);\r\n        }\r\n        this._endCall.clear();\r\n\r\n        this.el.forEach(v => v.animation = null);\r\n        this.el.clear();\r\n\r\n        animations.delete(this.id);\r\n    }\r\n\r\n    start(now: number = Date.now()) {\r\n        if(!this._isStart) {\r\n            this.stop();\r\n\r\n            this._startTime = now + this.delay;\r\n            this._isStart = true;\r\n            this._pauseTime = this._prevTime = 0;\r\n\r\n            this._play();\r\n        }\r\n\r\n        this._isPause = false;\r\n    }\r\n\r\n    pause() {\r\n        this._isPause = true;\r\n    }\r\n\r\n    stop() {\r\n        this._isStart = this._isPause = false;\r\n        if(this._timer) {\r\n            cancelAnimationFrame(this._timer);\r\n        }\r\n    }\r\n\r\n    notify() {\r\n        this._endCall.forEach(fn => fn());\r\n    }\r\n\r\n    message(msg: Msg) {\r\n        Object.assign(this, msg.animation);\r\n\r\n        this.el.forEach((v, el) => {\r\n            const attr = msg.attrs.get(el.id);\r\n            if(attr) {\r\n                el.attr(attr);\r\n            }\r\n        });\r\n\r\n        if(msg.isEnd) {\r\n            this._end();\r\n        }\r\n    }\r\n\r\n    private _end() {\r\n        this.stop();\r\n        this.notify();\r\n\r\n        if(--this.count > 0) {\r\n            this.start();\r\n        }\r\n    }\r\n\r\n    private _play() {\r\n        if(this._isStart && this.el.size) {\r\n            const now = Date.now();\r\n\r\n            if(now >= this._startTime) {\r\n                worker.postMessage(this._createMsg(now));\r\n            }\r\n\r\n            this._timer = requestAnimationFrame(() => this._play());\r\n        }\r\n    }\r\n\r\n    private _parseFrame(frame: number | string) {\r\n        let res: number;\r\n        if(typeof frame === 'string') {\r\n            res = parseFloat(frame) || 0;\r\n            if(frame.endsWith('%')) {\r\n                res /= 100;\r\n            }\r\n        } else {\r\n            res = frame;\r\n        }\r\n\r\n        return Math.max(0, Math.min(res, 1));\r\n    }\r\n\r\n    private _createMsg(now: number) {\r\n        const animation:any = {...this};\r\n        animation.el = new Map();\r\n        delete animation._endCall;\r\n        this.el.forEach((attr, el) => animation.el.set(el.id, attr));\r\n\r\n        return {\r\n            animation: animation,\r\n            now: now\r\n        }\r\n    }\r\n}\r\n\r\n// ================================================\r\nlet id: number = 1000;\r\nfunction  createAnimationId() {\r\n    return id++;\r\n}","/**\r\n * 路径\r\n */\r\n\r\nimport { Vector2 } from \"../lib/vector\";\r\nimport * as bbox from '../lib/bbox';\r\nimport { BoundingRect } from \"./bounding_rect\";\r\nimport { ellipse } from \"../tool/paint\";\r\n\r\n// =====================================\r\nenum CMD {\r\n    M = 1, // moveTo\r\n    L = 2, // lineTo\r\n    C = 3, // 三阶贝塞尔\r\n    Q = 4, // 二阶贝塞尔\r\n    A = 5, // arc\r\n    Z = 6, // close\r\n    R = 7 // rect\r\n}\r\n\r\nexport class Path {\r\n    static CMD = CMD;\r\n\r\n    lineDash: number[] = [];\r\n\r\n    private data?: Float32Array;\r\n    private _len: number = 0;\r\n\r\n    private _ctx?: CanvasRenderingContext2D;\r\n\r\n    get context() {\r\n        return this._ctx;\r\n    }\r\n\r\n    get len(){\r\n        return this._len;\r\n    }\r\n\r\n    beginPath(ctx: CanvasRenderingContext2D){\r\n        this._ctx = ctx;\r\n        this._len = 0;\r\n\r\n        if(ctx){\r\n            ctx.beginPath();\r\n            ctx.setLineDash(this.lineDash);\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    moveTo (x: number, y: number) {\r\n        this.addData(CMD.M, x, y);\r\n        this._ctx && this._ctx.moveTo(x, y);\r\n\r\n        return this;\r\n    }\r\n\r\n    lineTo(x: number, y: number) {\r\n        this.addData(CMD.L, x, y);\r\n        this._ctx && this._ctx.lineTo(x, y);\r\n\r\n        return this;\r\n    }\r\n\r\n    // 三阶贝塞尔曲线\r\n    bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x3: number, y3: number) {\r\n        this.addData(CMD.C, x1, y1, x2, y2, x3, y3);\r\n\r\n        this._ctx && this._ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\r\n\r\n        return this;\r\n    }\r\n\r\n    // 二阶贝塞尔曲线\r\n    quadraticCurveTo(x1: number, y1: number, x2: number, y2: number) {\r\n        this.addData(CMD.Q, x1, y1, x2, y2);\r\n\r\n        this._ctx && this._ctx.quadraticCurveTo(x1, y1, x2, y2);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param  anticlockwise // 规定应该逆时针还是顺时针绘图。1 = 顺时针，0 = 逆时针。\r\n     */\r\n    arc (\r\n        c: number[] | number,\r\n        r: number[] | number,\r\n        startAngle: number,\r\n        endAngle: number,\r\n        rotation: number = 0,\r\n        anticlockwise: 0 | 1 = 0\r\n    ) {\r\n        if(!Array.isArray(c)){\r\n            c = [c, c];\r\n        }\r\n        if(!Array.isArray(r)){\r\n            r = [r, r];\r\n        }\r\n\r\n        this.addData(CMD.A, c[0], c[1], r[0], r[1], startAngle, endAngle, rotation, anticlockwise);\r\n\r\n        if(this._ctx){\r\n            ellipse(this._ctx, c[0], c[1], r[0], r[1], startAngle, endAngle, rotation, anticlockwise)\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    rect (x: number, y: number, w: number, h: number) {\r\n        this.addData(CMD.R, x, y, w, h);\r\n        this._ctx && this._ctx.rect(x, y, w, h);\r\n\r\n        return this;\r\n    }\r\n\r\n    closePath() {\r\n        this.addData(CMD.Z);\r\n        this._ctx && this._ctx.closePath();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 直接设置 Path 数据\r\n     */\r\n    setData(data: number[]) {\r\n        const len = this._len = data.length;\r\n\r\n        if(!this.data || this.data.length !== len){\r\n            this.data = new Float32Array(len);\r\n        }\r\n        for(let i=0; i<len; i++){\r\n            this.data[i] = data[i];\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 添加子路径\r\n     */\r\n    appendPath(path: Path | Path[]) {\r\n        if(!Array.isArray(path)) path = [path];\r\n\r\n        const appendSize = path.reduce((a, b) => a + b.len, 0);\r\n        this.data = new Float32Array(this._len + appendSize);\r\n\r\n        path.forEach(append => {\r\n            if(append.data){\r\n                for(let i=0; i<append.data.length; i++){\r\n                    (<Float32Array>this.data)[this._len++] = append.data[i];\r\n                }\r\n            }\r\n        });\r\n\r\n        return this;\r\n    }\r\n\r\n    getBoundingRect() {\r\n        const min = new Vector2(Number.MAX_VALUE);\r\n        const max = new Vector2(-Number.MAX_VALUE);\r\n\r\n        const data: number[] | Float32Array = this.data || [];\r\n\r\n        let xi = 0;\r\n        let yi = 0;\r\n        let x0 = 0;\r\n        let y0 = 0;\r\n\r\n        for(let i = 0; i < this._len;){\r\n            let min1 = new Vector2(Number.MAX_VALUE);\r\n            let max1 = new Vector2(-Number.MAX_VALUE);\r\n\r\n            if (!i) {\r\n                // 如果第一个命令是 L, C, Q\r\n                // 则 previous point 同绘制命令的第一个 point\r\n                //\r\n                // 第一个命令为 Arc 的情况下会在后面特殊处理\r\n                xi = data[i + 1];\r\n                yi = data[i +2];\r\n\r\n                x0 = xi;\r\n                y0 = yi;\r\n            }\r\n\r\n            switch(data[i++]) {\r\n                case CMD.M:\r\n                    min1.x = max1.x = xi = x0 = data[i++];\r\n                    min1.y = max1.y = yi = y0 = data[i++];\r\n                    break;\r\n                case CMD.L:\r\n                    [min1, max1] = bbox.line(xi, yi, data[i], data[i + 1]);\r\n                    xi = data[i++];\r\n                    yi = data[i++];\r\n                    break;\r\n                case CMD.C:\r\n                    [min1, max1] = bbox.cubic(\r\n                        xi, yi, data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1]\r\n                    );\r\n                    xi = data[i++];\r\n                    yi = data[i++];\r\n                    break;\r\n                case CMD.Q:\r\n                    [min1, max1] = bbox.quadratic(xi, yi, data[i++], data[i++], data[i], data[i + 1]);\r\n                    xi = data[i++];\r\n                    yi = data[i++];\r\n                    break;\r\n                case CMD.A:\r\n                    const isStart = i === 1;\r\n\r\n                    const cx = data[i++];\r\n                    const cy = data[i++];\r\n                    const rx = data[i++];\r\n                    const ry = data[i++];\r\n                    const startAngle = data[i++];\r\n                    const endAngle = data[i++];\r\n                    i++;\r\n                    const anticlockwise = 1 - data[i++];\r\n\r\n                    if (isStart) {\r\n                        // 直接使用 arc 命令\r\n                        // 第一个命令起点还未定义\r\n                        x0 = Math.cos(startAngle) * rx + cx;\r\n                        y0 = Math.sin(startAngle) * ry + cy;\r\n                    }\r\n\r\n                    [min1, max1] = bbox.arc(cx, cy, rx, ry, startAngle, endAngle, anticlockwise);\r\n\r\n                    xi = Math.cos(endAngle) * rx + cx;\r\n                    yi = Math.sin(endAngle) * ry + cy;\r\n                    break;\r\n                case CMD.R:\r\n                    x0 = xi = data[i++];\r\n                    y0 = yi = data[i++];\r\n                    [min1, max1] = bbox.line(xi, yi, xi + data[i++], yi + data[i++]);\r\n                    break;\r\n                case CMD.Z:\r\n                    xi = x0;\r\n                    yi = y0;\r\n                    break;\r\n            }\r\n\r\n            min.toMin(min1);\r\n            max.toMax(max1);\r\n        }\r\n\r\n        return new BoundingRect(min.x, min.y, max.x - min.x, max.y - min.y);\r\n    }\r\n\r\n    rebuildPath(ctx: CanvasRenderingContext2D) {\r\n        const data: any[] | Float32Array = this.data || [];\r\n\r\n        for(let i = 0; i < this._len;){\r\n            switch(data[i++]) {\r\n                case CMD.M:\r\n                    ctx.moveTo(data[i++], data[i++]);\r\n                    break;\r\n                case CMD.L:\r\n                    ctx.lineTo(data[i++], data[i++]);\r\n                    break;\r\n                case CMD.C:\r\n                    ctx.bezierCurveTo(data[i++], data[i++], data[i++], data[i++], data[i++], data[i++]);\r\n                    break;\r\n                case CMD.Q:\r\n                    ctx.quadraticCurveTo(data[i++], data[i++], data[i++], data[i++]);\r\n                    break;\r\n                case CMD.A:\r\n                    ellipse(\r\n                        ctx,\r\n                        data[i++], data[i++], // 圆心\r\n                        data[i++], data[i++], // 半轴长\r\n                        data[i++], data[i++], // 起始及结束角\r\n                        data[i++], // 旋转\r\n                        data[i++]\r\n                    );\r\n                    break;\r\n                case CMD.R:\r\n                    ctx.rect(data[i++], data[i++], data[i++], data[i++]);\r\n                    break;\r\n                case CMD.Z:\r\n                    ctx.closePath();\r\n                    break;\r\n                default:\r\n                    console.error('data数据错误。未找到对应的绘图命令: ' + data[i - 1]);\r\n                    return;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 填充 Path 数据。\r\n     * 尽量复用而不申明新的数组。大部分图形重绘的指令数据长度都是不变的。\r\n     */\r\n    private addData(...arg: number[]) {\r\n        let data: number[] | Float32Array | void = this.data;\r\n\r\n        if(!data || this._len + arg.length > data.length){\r\n            data = this._expandData();\r\n        }\r\n        arg.forEach(v => (<number[] | Float32Array>data)[this._len++] = v);\r\n        this.toStatic(data);\r\n\r\n        return this;\r\n    }\r\n\r\n    private _expandData() {\r\n        const newData = [];\r\n\r\n        if(this.data){\r\n            for(let i = 0; i < this._len; i++){\r\n                newData[i] = this.data[i];\r\n            }\r\n        }\r\n\r\n        return newData;\r\n    }\r\n\r\n    private toStatic(data: number[] | Float32Array) {\r\n        if(Array.isArray(data)){\r\n            data.length = this._len;\r\n            this.data = new Float32Array(data);\r\n        }\r\n    }\r\n}","/**\r\n * 堆栈式容器\r\n * 垂直排列时-子元素top/bottom为其上下间隙\r\n * 横向排列时-子元素left/right为其左右间隙\r\n */\r\nimport { Container } from \"./container\";\r\nimport { parseSize } from \"../core/dom\";\r\nimport { Canvas2DElement } from \"./element\";\r\n\r\nexport class Stack extends Container {\r\n    readonly type: string = 'stack';\r\n\r\n    private _isVertical: boolean = true; // 是否是垂直排列\r\n\r\n    constructor(id: number | string, isStatic?: boolean) {\r\n        super(id, isStatic);\r\n\r\n        this.style.width = this.style.height = 0;\r\n    }\r\n\r\n    get isVertical() {\r\n        return this._isVertical;\r\n    }\r\n\r\n    set isVertical(isVertical: boolean) {\r\n        if(isVertical !== this._isVertical) {\r\n            this._isVertical = isVertical;\r\n            this.needUpdate = true;\r\n        }\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        super.remove(el, dispose);\r\n        if(!(this.style.width && this.style.height)) {\r\n            this.needUpdate = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        super.add(el);\r\n        if(!(this.style.width && this.style.height)) {\r\n            this.needUpdate = true;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    async calcSize() {\r\n        super.calcSize();\r\n\r\n        let sizeKey: 'height' | 'width' = 'height';\r\n        let otherSizeKey: 'height' | 'width' = 'width'\r\n        let positionKey: 'left' | 'top' = 'top';\r\n        if(!this._isVertical) {\r\n            sizeKey = 'width';\r\n            positionKey = 'left';\r\n            otherSizeKey = 'height';\r\n        }\r\n        const oldSize = this[sizeKey];\r\n        this[sizeKey] = this.getParentSize(sizeKey);\r\n\r\n        const [size, max] = await this._calcSize(sizeKey, positionKey, otherSizeKey);\r\n\r\n        this[sizeKey] = oldSize || size + this.style.border * 2;\r\n        this[otherSizeKey] = this[otherSizeKey] || max + this.style.border * 2;\r\n    }\r\n\r\n    private async _calcSize(\r\n        sizeKey: 'height' | 'width',\r\n        positionKey: 'left' | 'top',\r\n        otherSizeKey: 'height' | 'width'\r\n    ) {\r\n        let size: number = 0;\r\n        let max: number = 0;\r\n        const positionOtherKey: 'right' | 'bottom' = positionKey === 'left' ? 'right' : 'bottom';\r\n\r\n        const children = Array.from(this.children).sort((a, b) => a.index - b.index);\r\n        for(const v of children){\r\n            size += parseSize(v.style[positionKey], 0);\r\n            v[positionKey] = size;\r\n\r\n            if(!(v.isStatic && v._cached)) {\r\n                await v.calcSize();\r\n            }\r\n            size += v[sizeKey] + parseSize(v.style[positionOtherKey], 0);\r\n            max = Math.max(max, v[otherSizeKey]);\r\n\r\n            v.isVisible = v[sizeKey] ? v.isVisible : false;\r\n        }\r\n\r\n        return [size, max];\r\n    }\r\n}","/**\r\n * 单向可滚动容器\r\n */\r\nimport { Container } from \"./container\";\r\nimport { Stack } from \"./stack\";\r\nimport { Canvas2DElement } from \"./element\";\r\nimport { IGuiEvent } from \"../core/event\";\r\nimport { addHandler, removeHandler } from \"../core/dom\";\r\nimport { devicePixelRatio as ratio } from \"../config\";\r\n\r\nexport class Scroll extends Container {\r\n    readonly type: string = 'scroll';\r\n\r\n    children: Stack[] = [];\r\n    move: number = 0; // 移动距离, [-this.maxMove, 0]\r\n    more: number = 10; // 回弹效果\r\n    maxMove: number = 0;\r\n\r\n    private _isVertical: boolean = true; // 是否是垂直排列\r\n    private _isDown: boolean = false;\r\n    private _downPoint: number = 0;\r\n\r\n    constructor(id: number | string) {\r\n        super(id);\r\n        super.add(new Stack(`__scroll__${id}`).attr('zIndex', -Number.MAX_VALUE));\r\n\r\n        this.events.on('mousedown', this._downCall);\r\n        this.events.on('mousemove', this._moveCall);\r\n\r\n        this.events.on('touchstart', this._downCall);\r\n        this.events.on('touchmove', this._moveCall);\r\n\r\n        addHandler(document, 'mouseup', this._upCall);\r\n        addHandler(document, 'touchend', this._upCall);\r\n    }\r\n\r\n    get isVertical() {\r\n        return this._isVertical;\r\n    }\r\n\r\n    set isVertical(isVertical: boolean) {\r\n        if(isVertical !== this._isVertical) {\r\n            this._isVertical = isVertical;\r\n            this.move = 0;\r\n            this.needUpdate = true;\r\n            this.children[0].isVertical = isVertical;\r\n        }\r\n    }\r\n\r\n    remove(el: Canvas2DElement, dispose: boolean = true){\r\n        if(!this.children.length) {\r\n            super.add(new Stack(`__scroll__0`).attr('zIndex', -Number.MAX_VALUE));\r\n        }\r\n        this.children[0].remove(el, dispose);\r\n\r\n        return this;\r\n    }\r\n\r\n    add(el: Canvas2DElement){\r\n        if(!this.children.length) {\r\n            super.add(new Stack(`__scroll__0`).attr('zIndex', -Number.MAX_VALUE));\r\n        }\r\n        this.children[0].add(el);\r\n\r\n        return this;\r\n    }\r\n\r\n    dispose(){\r\n        super.dispose();\r\n\r\n        removeHandler(document, 'mouseup', this._upCall);\r\n        removeHandler(document, 'touchend', this._upCall);\r\n    }\r\n\r\n    beforeUpdate() {\r\n        super.beforeUpdate();\r\n\r\n        this.style.clip = true;\r\n\r\n        this.children.length = 1;\r\n        const stack = this.children[0];\r\n        stack[this._isVertical ? 'top' : 'left'] = this.move;\r\n        stack.isVertical = this._isVertical;\r\n        stack.isStatic = this.isStatic = false;\r\n\r\n        this._setBuild(stack);\r\n    }\r\n\r\n    getTarget(ctx: CanvasRenderingContext2D, x: number, y: number): false | Canvas2DElement {\r\n        const target = super.getTarget(ctx, x, y);\r\n\r\n        return target === this.children[0] ? this : target;\r\n    }\r\n\r\n    private _downCall(guiEvent: IGuiEvent) {\r\n        this._isDown = true;\r\n        this._downPoint = this._isVertical ? guiEvent.y : guiEvent.x;\r\n    }\r\n\r\n    private _moveCall(guiEvent: IGuiEvent, event: MouseEvent) {\r\n        if(this._isDown) {\r\n            if(event.preventDefault){\r\n                event.preventDefault();\r\n            }else{\r\n                event.returnValue = false;\r\n            }\r\n\r\n            const now = this._isVertical ? guiEvent.y : guiEvent.x;\r\n            const diff = (now - this._downPoint) / ratio;\r\n            const sizeKey: 'height' | 'width' = this._isVertical ? 'height' : 'width';\r\n            this.maxMove = this.children[0][sizeKey] - this[sizeKey] + this.style.border * 2;\r\n\r\n            if(Math.abs(diff) > 1e-3 && this.maxMove >= 1) {\r\n                this.move += diff;\r\n                this.move = Math.min(this.more, Math.max(this.move, -this.maxMove - this.more));\r\n\r\n                this.children[0].needUpdate = true;\r\n                this.markDirty();\r\n\r\n                this.notifyEvent('scroll', null, guiEvent);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _setBuild(stack: Stack) {\r\n        if(!stack.hasOwnProperty('buildCached')) {\r\n            const sizeKey = this._isVertical ? 'height' : 'width';\r\n            const _this = this;\r\n            stack.buildCached = async function() {\r\n                const invert = this.transform.invert();\r\n                const maxRect = (await this._getMaxRect()).transform(invert);\r\n                if(maxRect[sizeKey[0]] > _this[sizeKey]) {\r\n                    maxRect[this._isVertical ? 'y' : 'x'] = -_this.move;\r\n                    maxRect[sizeKey[0]] = _this[sizeKey];\r\n                }\r\n                this._start.x = -maxRect.x;\r\n                this._start.y = -maxRect.y;\r\n\r\n                const buildCached = Canvas2DElement.prototype.buildCached;\r\n                return buildCached.call(this, maxRect.w, maxRect.h, this._start);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _upCall = () => {\r\n        this._isDown = false;\r\n\r\n        if(this.move > 0 || this.move < -this.maxMove) {\r\n            this.move = Math.min(0, Math.max(this.move, -this.maxMove));\r\n            this.children[0].needUpdate = true;\r\n            this.markDirty();\r\n        }\r\n    }\r\n}","/**\r\n * 贝塞尔曲线相关\r\n */\r\nimport { cached, isZero } from \"../tool/util\";\r\n\r\n// 计算杨辉三角第n行的数\r\nconst YHTriangle = cached((n: number) => {\r\n    n = Math.trunc(n);\r\n    if(n < 0) return [];\r\n\r\n    const mi: number[] = [];\r\n    mi[0] = mi[1] = 1;\r\n    for (let i = 3; i <= n; i++) {\r\n        const t = mi.slice(0, i-1);\r\n\r\n        mi[0] = mi[i - 1] = 1;\r\n        for (let j = 0; j < i - 2; j++) {\r\n            mi[j + 1] = t[j] + t[j + 1];\r\n        }\r\n    }\r\n\r\n    return mi;\r\n})\r\n\r\n/**\r\n * 计算n阶贝塞尔函数的值\r\n * */\r\nexport function bezier(t: number, ...p: number[]){\r\n    const n = p.length - 1;\r\n    const mi = YHTriangle(n + 1);\r\n\r\n    return p.reduce((a, b, i) => a + mi[i] * b * (1 - t) ** (n - i) * t ** i, 0);\r\n}\r\n\r\n/**\r\n * 计算三阶贝塞尔函数在[0, 1]上的非单调极值\r\n */\r\nexport function cubicExtrema(p0: number, p1: number, p2: number, p3: number) {\r\n    const a = 9 * p1 + 3 * p3 - 3 * p0 - 9 * p2;\r\n    const b = 6 * p2 - 12 * p1 + 6 * p0;\r\n    const c = 3 * p1 - 3 * p0;\r\n\r\n    const extremum = [];\r\n    if(isZero(a)){\r\n        if(!isZero(b)){\r\n            const t1 = -c / b;\r\n            if (t1 >= 0 && t1 <= 1) {\r\n                extremum.push(t1);\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        const disc = b * b - 4 * a * c;\r\n        if(!isZero(disc) && disc > 0){\r\n            const discSqrt = Math.sqrt(disc);\r\n            const t1 = (-b + discSqrt) / (2 * a);\r\n            const t2 = (-b - discSqrt) / (2 * a);\r\n\r\n            if (t1 >= 0 && t1 <= 1) {\r\n                extremum.push(t1)\r\n            }\r\n            if (t2 >= 0 && t2 <= 1) {\r\n                extremum.push(t2);\r\n            }\r\n        }\r\n    }\r\n\r\n    return extremum;\r\n}\r\n\r\n/**\r\n * 计算二阶贝塞尔函数在[0, 1]上的极值\r\n */\r\nexport function quadraticExtremum(p0: number, p1: number, p2: number) {\r\n    var divider = p0 + p2 - 2 * p1;\r\n    if (divider === 0) {\r\n        // p1 is center of p0 and p2\r\n        return 0.5;\r\n    }\r\n    else {\r\n        return Math.max(Math.min((p0 - p1) / divider, 1), 0);\r\n    }\r\n}","/**\r\n * 计算各种路径的包围盒\r\n */\r\nimport { Vector2 } from \"./vector\";\r\nimport { cubicExtrema, bezier, quadraticExtremum } from \"./bezier\";\r\n\r\n/**\r\n * 直线\r\n */\r\nexport function line(x1: number, y1: number, x2: number, y2: number){\r\n    const min = Vector2.createMin([x1, x2], [y1, y2]);\r\n    const max = Vector2.createMax([x1, x2], [y1, y2]);\r\n\r\n    return [min, max];\r\n}\r\n\r\n/**\r\n * 四阶贝塞尔曲线\r\n */\r\nexport function cubic(\r\n    x0: number, y0: number,\r\n    x1: number, y1: number,\r\n    x2: number, y2: number,\r\n    x3: number, y3: number\r\n){\r\n    const min = Vector2.createMin([x0, x3], [y0, y3]);\r\n    const max = Vector2.createMax([x0, x3], [y0, y3]);\r\n\r\n    cubicExtrema(x0, x1, x2, x3).forEach(t => {\r\n        const x = bezier(t, x0, x1, x2, x3);\r\n        min.x = Math.min(min.x, x);\r\n        max.x = Math.max(max.x, x);\r\n    });\r\n    cubicExtrema(y0, y1, y2, y3).forEach(t => {\r\n        const y = bezier(t, y0, y1, y2, y3);\r\n        min.y = Math.min(min.y, y);\r\n        max.y = Math.max(max.y, y);\r\n    });\r\n\r\n    return [min, max];\r\n}\r\n\r\n/**\r\n * 三阶贝塞尔曲线\r\n */\r\nexport function quadratic(\r\n    x0: number, y0: number,\r\n    x1: number, y1: number,\r\n    x2: number, y2: number\r\n) {\r\n    const x = bezier(quadraticExtremum(x0, x1, x2), x0, x1, x2);\r\n    const y = bezier(quadraticExtremum(y0, y1, y2), y0, y1, y2);\r\n\r\n    return [\r\n        Vector2.createMin([x0, x2, x], [y0, y2, y]),\r\n        Vector2.createMax([x0, x2, x], [y0, y2, y])\r\n    ]\r\n}\r\n\r\n/**\r\n * 弧线\r\n */\r\nexport function arc(\r\n    cx: number, cy: number,\r\n    rx: number, ry: number,\r\n    startAngle: number, endAngle: number,\r\n    anticlockwise: number\r\n){\r\n    const diff = Math.abs(startAngle - endAngle);\r\n    const PI2 = Math.PI * 2;\r\n\r\n    if (diff % PI2 < 1e-4 && diff > 1e-4) {\r\n        // 圆\r\n        return [\r\n            new Vector2(cx - rx, cy - ry),\r\n            new Vector2(cx + rx, cy + ry),\r\n        ];\r\n    }\r\n\r\n    const x = [], y = [];\r\n    x[0] = Math.cos(startAngle) * rx + cx;\r\n    x[1] = Math.cos(endAngle) * rx + cx;\r\n    y[0] = Math.sin(startAngle) * ry + cy;\r\n    y[1] = Math.sin(endAngle) * ry + cy;\r\n\r\n    const min = Vector2.createMin(x, y);\r\n    const max = Vector2.createMax(x, y);\r\n\r\n    // to [0, Math.PI * 2]\r\n    startAngle = startAngle % PI2;\r\n    if (startAngle < 0) {\r\n        startAngle = startAngle + PI2;\r\n    }\r\n    endAngle = endAngle % PI2;\r\n    if (endAngle < 0) {\r\n        endAngle = endAngle + PI2;\r\n    }\r\n\r\n    if (startAngle > endAngle && !anticlockwise) {\r\n        endAngle += PI2;\r\n    }\r\n    else if (startAngle < endAngle && anticlockwise) {\r\n        startAngle += PI2;\r\n    }\r\n    if (anticlockwise) {\r\n        const tmp = endAngle;\r\n        endAngle = startAngle;\r\n        startAngle = tmp;\r\n    }\r\n\r\n    for (let angle = 0; angle < endAngle; angle += Math.PI / 2) {\r\n        if (angle > startAngle) {\r\n            const v = new Vector2(Math.cos(angle) * rx + cx, Math.sin(angle) * ry + cy);\r\n\r\n            min.toMin(v);\r\n            max.toMax(v);\r\n        }\r\n    }\r\n\r\n    return [min, max];\r\n}","/**\r\n * 路径\r\n */\r\n\r\nimport { Path as SuperPath } from \"../core/path\";\r\nimport { Canvas2DElement } from \"./element\";\r\n\r\nexport class Path extends Canvas2DElement {\r\n    private _path = new SuperPath();\r\n\r\n    moveTo (x: number, y: number) {\r\n        this._path.moveTo(x, y);\r\n\r\n        return this;\r\n    }\r\n\r\n    lineTo(x: number, y: number) {\r\n        this._path.lineTo(x, y);\r\n\r\n        return this;\r\n    }\r\n\r\n    // 三阶贝塞尔曲线\r\n    bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x3: number, y3: number) {\r\n        this._path.bezierCurveTo(x1, y1, x2, y2, x3, y3);\r\n\r\n        return this;\r\n    }\r\n\r\n    // 二阶贝塞尔曲线\r\n    quadraticCurveTo(x1: number, y1: number, x2: number, y2: number) {\r\n        this._path.quadraticCurveTo(x1, y1, x2, y2);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param  anticlockwise // 规定应该逆时针还是顺时针绘图。1 = 顺时针，0 = 逆时针。\r\n     */\r\n    arc (\r\n        c: number[] | number,\r\n        r: number[] | number,\r\n        startAngle: number,\r\n        endAngle: number,\r\n        rotation: number = 0,\r\n        anticlockwise: 0 | 1 = 0\r\n    ) {\r\n        this._path.arc(c, r, startAngle, endAngle, rotation, anticlockwise);\r\n\r\n        return this;\r\n    }\r\n\r\n    rectPath (x: number, y: number, w: number, h: number) {\r\n        this._path.rect(x, y, w, h);\r\n\r\n        return this;\r\n    }\r\n\r\n    closePath() {\r\n        this._path.closePath();\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 直接设置 Path 数据\r\n     */\r\n    setData(data: number[]) {\r\n        this._path.setData(data);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 添加子路径\r\n     */\r\n    appendPath(path: SuperPath | SuperPath[]) {\r\n        this._path.appendPath(path);\r\n\r\n        return this;\r\n    }\r\n\r\n    async build(ctx: CanvasRenderingContext2D) {\r\n        if(!this._path.len) {\r\n            return;\r\n        }\r\n\r\n        this.buildPath(ctx);\r\n        await this.style.build(ctx, this.width, this.height);\r\n\r\n        if(this.style.background){\r\n            ctx.fill();\r\n        }\r\n\r\n        ctx.stroke();\r\n    }\r\n\r\n    async buildCached() {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = this.getParentSize('width');\r\n        canvas.height = this.getParentSize('height');\r\n\r\n        const cachedCtx = canvas.getContext('2d');\r\n        await this.build(cachedCtx);\r\n\r\n        return canvas;\r\n    }\r\n\r\n    getBoundingRect() {\r\n        if(this._needUpdate) {\r\n            this.update();\r\n            this.rect.transform(this.transform);\r\n            this._needUpdate = false;\r\n        }\r\n\r\n        return Promise.resolve(this.rect);\r\n    };\r\n\r\n    beforeUpdate() {\r\n        super.beforeUpdate();\r\n        this.style.border = this.style.border || 1;\r\n    }\r\n\r\n    calcSize(){\r\n        super.calcSize();\r\n\r\n        const rect = this._path.getBoundingRect();\r\n        this.width = rect.w;\r\n        this.height = rect.h;\r\n\r\n        rect.w += this.style.border;\r\n        rect.h += this.style.border;\r\n        this.rect = rect;\r\n    }\r\n\r\n    updateTransform() {\r\n        this.transform.toUnit();\r\n\r\n        if(this.parent) {\r\n            this.transform.transform(this.parent.transform);\r\n        }\r\n    }\r\n\r\n    protected buildPath(ctx: CanvasRenderingContext2D) {\r\n        ctx.beginPath();\r\n        this._path.rebuildPath(ctx);\r\n    }\r\n}","\r\nexport { Layer } from \"./layer\";\r\nexport { Engine } from \"./engine\";\r\nexport { Canvas2DElement } from \"./node/element\";\r\nexport { Container } from \"./node/container\";\r\nexport { Canvas2DImage } from \"./node/image\";\r\nexport { TextBlock } from \"./node/text\";\r\nexport { Canvas2DAnimation } from './animation/animation';\r\nexport { Stack } from \"./node/stack\";\r\nexport { Scroll } from \"./node/scroll\";\r\nexport { Path as PathElement } from \"./node/path\";\r\nexport { Path } from './core/path';\r\nexport { devicePixelRatio } from './config';"],"sourceRoot":""}